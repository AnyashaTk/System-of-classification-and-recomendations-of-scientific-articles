0
"Draft version January 5, 2021
Typeset using LATEX twocolumn style in AASTeX63"
"Two Year Cosmology Large Angular Scale Surveyor (CLASS) Observations: Long Timescale Stability
Achieved with a Front-End Variable-delay Polarization Modulator at 40 GHz"
"Kathleen Harrington ,1, 2, 3 Rahul Datta ,3 Keisuke Osumi ,3 Aamir Ali ,4, 3 John W. Appel ,3"
"Charles L. Bennett ,3 Michael K. Brewer,3 Ricardo Bustos ,5 Manwei Chan ,3 David T. Chuss ,6"
"Joseph Cleary,3 Jullianna Denes Couto ,3 Sumit Dahal (s� Emt dAhAl) ,
7, 3 Rolando Dünner,8"
"Joseph R. Eimer ,3 Thomas Essinger-Hileman ,7 Johannes Hubmayr ,9 Francisco Raul Espinoza Inostroza,5"
"Jeffrey Iuliano ,3 John Karakla,3 Yunyang Li (李云炀) ,3 Tobias A. Marriage ,3 Nathan J. Miller,3, 7"
"Carolina Núñez ,3 Ivan L. Padilla ,3 Lucas Parker ,10, 3 Matthew A. Petroff ,3"
"Bastian Pradenas Márquez ,3, 11 Rodrigo Reeves ,12 Pedro Fluxá Rojas ,13, 8 Karwan Rostem ,7"
"Deniz Augusto Nunes Valle ,3 Duncan J. Watts ,14, 3 Janet L. Weiland ,3 Edward J. Wollack 7"
"And Zhilei Xu (徐智磊) 15, 16, 3"
CLASS Collaboration
"1Department of Astronomy and Astrophysics, University of Chicago, 5640 South Ellis Avenue, Chicago, IL 60637, USA
2Department of Physics, University of Michigan, 450 Church St, Ann Arbor, MI, 48109, USA"
"3Department of Physics and Astronomy, Johns Hopkins University, 3701 San Martin Drive, Baltimore, MD 21218, USA
4Department of Physics, University Of California, Berkeley, CA 94720, USA"
"5Departamento de Ingenieŕıa Eléctrica, Universidad Católica de la Sant́ısima Concepción, Alonso de Ribera 2850, Concepción, Chile
6Department of Physics, Villanova University, 800 Lancaster Avenue, Villanova, PA 19085, USA"
"7Goddard Space Flight Center, 8800 Greenbelt Road, Greenbelt, MD 20771, USA
8Instituto de Astrof́ısica and Centro de Astro-Ingenieŕıa, Facultad de F́ısica, Pontificia Universidad Católica de Chile, Av. Vicuña"
"Mackenna 4860, 7820436 Macul, Santiago, Chile
9Quantum Sensors Group, National Institute of Standards and Technology, 325 Broadway, Boulder, CO 80305, USA"
"10Space and Remote Sensing, MS B244, Los Alamos National Laboratory, Los Alamos, NM 87544, USA
11Departamento de F́ısica, FCFM, Universidad de Chile, Blanco Encalada 2008, Santiago, Chile"
"12CePIA, Departamento de Astronomia, Universidad de Concepcion, Concepcion, Chile
13Instituto de Astrof́ısica, Facultad de F́ısica, Pontificia Universidad Católica de Chile, Avenida Vicuña Mackenna 4860, 7820436, Chile"
"14Institute of Theoretical Astrophysics, University of Oslo, Blindern, Oslo, Norway
15MIT Kavli Institute, Massachusetts Institute of Technology, Cambridge, Massachusetts 02139, USA"
"16Department of Physics and Astronomy, University of Pennsylvania, 209 South 33rd Street, Philadelphia, PA 19104, USA"
ABSTRACT
"The Cosmology Large Angular Scale Surveyor (CLASS) is a four-telescope array observing the
largest angular scales (2 . ` . 200) of the cosmic microwave background (CMB) polarization. These
scales encode information about reionization and inflation during the early universe. The instrument
stability necessary to observe these angular scales from the ground is achieved through the use of
a variable-delay polarization modulator (VPM) as the first optical element in each of the CLASS
telescopes. Here we develop a demodulation scheme used to extract the polarization timestreams from
the CLASS data and apply this method to selected data from the first two years of observations by
the 40 GHz CLASS telescope. These timestreams are used to measure the 1/f noise and temperature-
to-polarization (T → P ) leakage present in the CLASS data. We find a median knee frequency for the
pair-differenced demodulated linear polarization of 15.12 mHz and a T → P leakage of < 3.8 × 10−4
(95% confidence) across the focal plane. We examine the sources of 1/f noise present in the data and
find the component of 1/f due to atmospheric precipitable water vapor (PWV) has an amplitude of
203 ± 12 µKRJ"
"√
s for 1 mm of PWV when evaluated at 10 mHz; accounting for ∼ 32% of the 1/f"
noise in the central pixels of the focal plane. The low level of T → P leakage and 1/f noise achieved
Corresponding author: Kathleen Harrington
katieharrington@uchicago.edu
"http://orcid.org/0000-0003-1248-9563
http://orcid.org/0000-0003-3853-8757
http://orcid.org/0000-0003-2838-1880
http://orcid.org/0000-0001-7941-9602
http://orcid.org/0000-0002-8412-630X
http://orcid.org/0000-0001-8839-7206
http://orcid.org/0000-0001-8468-9391
http://orcid.org/0000-0003-1127-0965
http://orcid.org/0000-0003-0016-0533
http://orcid.org/0000-0002-0552-3754
http://orcid.org/0000-0002-1708-5464
http://orcid.org/0000-0001-6976-180X
http://orcid.org/0000-0002-4782-3851
http://orcid.org/0000-0002-2781-9302
http://orcid.org/0000-0001-7466-0317
http://orcid.org/0000-0002-4820-1122
http://orcid.org/0000-0003-4496-6520
http://orcid.org/0000-0002-5247-2523
http://orcid.org/0000-0002-0024-2662
http://orcid.org/0000-0002-8224-859X
http://orcid.org/0000-0002-4436-4215
http://orcid.org/0000-0001-5167-7159 
http://orcid.org/0000-0001-5704-271X
http://orcid.org/0000-0002-2061-0063
http://orcid.org/0000-0003-4189-0700
http://orcid.org/0000-0003-3487-2811
http://orcid.org/0000-0002-5437-6121
http://orcid.org/0000-0003-3017-3474
http://orcid.org/0000-0002-7567-4451
http://orcid.org/0000-0001-5112-2567
mailto: katieharrington@uchicago.edu"
"
2 Harrington et al."
"through the use of a front-end polarization modulator enables the observation of the largest scales of
the CMB polarization from the ground by the CLASS telescopes."
"Keywords: Astronomical instrumentation (799); Polarimeters (1127); Cosmic microwave background
radiation (322); Early Universe (435); Observational Cosmology (1146);"
1. INTRODUCTION
"Observations of the cosmic microwave background
(CMB) have revolutionized our understanding of the
universe and established ΛCDM as the standard model
of cosmology (Bennett et al. 2003; Spergel et al. 2003;
Bennett et al. 2013). Much of the cosmological infor-
mation in the CMB is encoded in its angular power
spectrum, which describes the amplitude of the CMB
anisotropy as a function of angular scale or multi-
pole moment, ` (Peebles & Yu 1970; Doroshkevich
et al. 1978). While the large scale CMB temperature
anisotropy has been measured to below the cosmic vari-
ance limit by the space satellites WMAP (Hinshaw et al.
2013) and Planck (Planck Collaboration I 2019), mea-
surements of the polarization anisotropy on the same
scales have yet to reach this limit."
"The largest angular scales of the CMB polarization
contain a wealth of information from the early universe.
The amplitude of the E-modes on largest scales (` . 20)
depends on the optical depth to reionization, τ (Page
et al. 2007; Planck Collaboration VI 2019). The shape
of the largest scale E-modes depends on the specific
reionization history, such that the free electron frac-
tion over cosmic time can be constrained using high
signal-to-noise large-scale E-mode measurements (Hu &
Holder 2003; Heinrich & Hu 2018; Watts et al. 2020).
Additionally, constraining specific inflationary models
using large-scale B-mode measurements requires excel-
lent knowledge of the reionization history (Obied et al.
2018). Observing the large scale E-modes requires mea-
suring angular correlations on large fractions of sky to
better than ∼ 200 nK."
"The large angular scale B-modes are expected to have
an amplitude proportional to the tensor-to-scalar ratio
r. A non-zero tensor-to-scalar ratio would indicate the
presence of super-horizon gravitational waves predicted
to have been produced during an inflationary expansion
phase in the early universe (Kamionkowski et al. 1997;
Seljak & Zaldarriaga 1997). The strongest constraint
to date on the tensor-to-scalar ratio from CMB B-mode
and temperature measurements is r < 0.06 at 95% con-
fidence (Keck Array et al. 2018). For r = 0.01, detecting
the large angular scale B-modes requires an angular cor-
relation measurement at the level of ∼ 30 nK."
"Observations of the largest angular scales are limited
in part by scan strategy and the stability of the instru-
ment. Mapping the lowest multipole moments requires
a scan strategy that covers large angles (θ ∼ 2π/`) while
the telescope noise remains sufficiently stationary. Noise
on long timescales generally has a 1/f spectrum with a"
"knee frequency, where the 1/f noise equals the white
noise, that parameterizes the rate of change of the in-
strument noise. Temperature drifts in the atmosphere
and instrument are the dominant 1/f noise sources for
intensity observations. These fluctuations are converted
into polarization due to temperature to polarization
(T → P ) leakage resulting from non-idealities in the
instrument. While T → P leakage in polarization op-
timized instruments is usually small, . 1% (Essinger-
Hileman et al. 2016), it can still be a dominant effect
when integrating down to the sensitivity level necessary
to observe the polarization of the CMB. Additionally,
non-optical sources of 1/f from the cryogenics, detec-
tors, and readout system primarily affect the intensity
signal but can leak into polarization depending on the
exact source and analysis method."
"Mapping the largest scales on the sky requires a
method of minimizing the effects of T → P leakage and
1/f more broadly. Space satellites are able to scan the
sky very quickly, with fscan ∼ 20 mHz (∼ 1 RPM), and
are unaffected by atmosphere. When the scan frequency
is below or close to the 1/f knee frequency, destriping
methods such as MADAM (Keihänen et al. 2010) can be
used to filter out the long timescale fluctuations while
retaining most of the sky signal. If the scan frequency is
significantly slower than the knee frequency, the signal
from large angular scale CMB fluctuations will be over-
whelmed by the 1/f noise. In that regime, filtering out
the noise without also filtering out the sky signal is not
feasible (Poletti et al. 2017)."
"Ground-based CMB observations are usually executed
in a regime such that the scan frequency with respect
to the largest angular scales is much lower than the 1/f
knee frequency. Diurnal temperature variations and 1/f
noise from the atmosphere make the ground observa-
tion environment inherently less stable than space ob-
servations. For these and other reasons, ground-based
CMB surveys have usually restricted their observations
to smaller fractions of sky and/or filtered out the longer
timescale modes needed to map the largest angular
scales."
"Several ground-based instruments have been experi-
menting with polarization modulation to increase long-
time-scale stability and reduce T → P leakage. This
has been particularly important in the Chilean Atacama
Desert, where large sky fractions are accessible but the
atmosphere is less stable than at the South Pole. QUIET
(QUIET Collaboration et al. 2011) used phase modula-
tion with coherent detection techniques to reduce the
1/f noise in their timestreams. ABS (Kusaka et al."
"http://astrothesaurus.org/uat/799
http://astrothesaurus.org/uat/1127
http://astrothesaurus.org/uat/322
http://astrothesaurus.org/uat/322
http://astrothesaurus.org/uat/435
http://astrothesaurus.org/uat/1146"
"
CLASS 40 GHz VPM Demodulation Stability 3"
"2018), Polarbear (Adachi et al. 2020), and ACTPol
(Louis et al. 2017) have all implemented or tested con-
tinuously rotating half waveplate (HWP) modulators.
The HWP modulators have generally increased instru-
ment stability and reduced T → P leakage (Kusaka et al.
2014; Takakura et al. 2017); however, the scan strategies
implemented by these experiments focused only on map-
ping angular fluctuations on degree scales and smaller."
"The Cosmology Large Angular Scale Surveyor
(CLASS) (Essinger-Hileman et al. 2014; Harrington
et al. 2016) is a unique project targeting the largest an-
gular scales (1◦ . θ . 90◦) of the CMB polarization
from the ground. Sited in the Chilean Atacama desert
(Bustos et al. 2014), CLASS observes in four frequency
bands: 40, 90, 150, and 220 GHz. This set of frequency
bands spans the Galactic foreground minimum and op-
erate in spectral windows of high atmospheric transmis-
sion. During the first two years considered in this paper,
CLASS observed continuously, executing constant 45◦"
"elevation scans through 720◦ in azimuth at 1◦ s−1. With
this scan strategy and site location, CLASS observed
nearly 75% of the sky every day. Daily boresight rota-
tions, in 15◦ increments through±45◦, are used to rotate
the polarization sensitivity of the instrument (Essinger-
Hileman et al. 2014)."
"The unique aspect of the CLASS telescope is the use
of a variable-delay polarization modulator (VPM) as the
first optical element seen by radiation coming from the
sky (Chuss et al. 2012; Miller et al. 2016; Harrington
et al. 2018). Sketched in Figure 1, a VPM consists of a
linearly polarizing wire grid positioned in front of and
parallel to a movable mirror. The distance between the
grid and the mirror creates a phase delay between po-
larization states parallel and perpendicular to the wires.
Moving the mirror position with respect to the wire grid
changes this phase delay and modulates one linear po-
larization and circular polarization. For CLASS, this
modulation is rapid, with the mirror moving at 10 Hz.
This encodes the sky polarization signals at frequencies
well above the 1/f knee frequencies of the detectors and
atmosphere. In addition, having the VPM as the first
optical element means the polarization modulation oc-
curs before the effects of instrument polarization from
the later optical elements."
"Here we discuss the demodulation process used to
extract the polarization timestreams from the CLASS
data, present results on the achieved instrument sta-
bility and T → P leakage, and discuss the sources of
1/f noise in the demodulated data. This paper is part
of a series of papers on the first 2 years (Sept 2016 to
March 2018, “Era 1” hereafter) of observations by the
40 GHz CLASS telescope. Other papers in this series
cover the calibration (Appel et al. 2019), beams (Xu
et al. 2020), pipeline (Osumi et al. In preparation), and
results (Eimer et al. In preparation). In addition, this
dataset has been used to put limits on the amplitude
of the cosmological circular polarization (Padilla et al."
Wire Grid
"Movable Mirror
z"
Input Output
Figure 1. A schematic diagram of a variable-delay polar-
ization modulator as implemented for the CLASS telescopes.
A linearly polarizing wire grid is mounted in front of a mov-
able mirror. This creates a phase delay between polarization
states parallel and perpendicular to the direction of the grid
wires. Changing the distance between the wire grid and the
"mirror, z, results in a modulation between one of the linear"
Stokes polarizations and circular polarization.
"2020), and detect atmospheric circular polarization at
40 GHz for the first time (Petroff et al. 2020)."
2. DEMODULATION
"An ideal VPM is one where all surfaces are lossless and
the wavelengths of incident light are much longer than
the wire diameters and pitch. In this regime the phase
difference, δ, between polarization states parallel and
perpendicular to the wires depends on the frequency, ν,
the angle of incidence, θ, and the grid-mirror distance,
z, as"
"δ =
4πν"
"c
z cos θ. (1)"
"The phase delay between orthogonal linear polarization
states creates a mixing between one of the linear Stokes
parameters and circular polarization. In a VPM cen-
tered coordinate system, with Stokes ±Q defined par-
allel and perpendicular to the wire grid and plane of
incidence perpendicular to the wire grid, the single-
frequency Mueller matrix (Hecht 2012) describing the
relation between the input and output Stokes parame-
ters is"
"MVPM(ν, z) ="
"
"
1 0 0 0
0 1 0 0
"0 0 cos δ(ν, z) − sin δ(ν, z)
0 0 sin δ(ν, z) cos δ(ν, z)"
"
 . (2)"
4 Harrington et al.
"The frequency-integrated, VPM-centered Mueller ma-
trix can be calculated by integrating each element over
the bandpass of the detectors and optics, B(ν). For
example, the UU element of the matrix is"
(MVPM)UU (z) =
"∫
dν B(ν) cos δ(ν, z). (3)"
"To calculate the modulation observed at a detector,
the VPM-centered Mueller matrix is rotated into the
detector-centered coordinate system that was described
in Section 5 of Xu et al. (2020). Critically, this rotation
is different for every pixel in the focal plane. The VPM
is near the entrance pupil of the CLASS optical design
(Eimer et al. 2012), meaning each detector illuminates
the same area of the VPM, but each pixel has a different
angle and plane of incidence on the VPM.1 From this
coordinate system, the polarization of the detectors is
well defined; all detectors are aligned along Stokes ±U .
A set of modulation functions, SI , SQ, SU , and SV ,
are calculated for each detector to describe the level at
which each incoming Stokes parameter is modulated by
the VPM. The power observed by each detector as a
function of time, t, and grid-mirror distance, z, is"
"d(z, t) = Az(z)TVPM(t) + SI(z)Iin(t)"
+ SQ(z)Qin(t) + SU (z)Uin(t)
+ SV (z)Vin(t).
"Here, the “in” subscripts indicate the Stokes parame-
ters of the light incident on the VPM in the detector
coordinate system, and we have added the VPM tem-
perature TVPM and Az to indicate a VPM synchronous
signal (VSS) that occurs due to emission from the wire
grid and mirror (Miller et al. 2016)."
"For detectors with a non-zero azimuth offset in the
CLASS focal plane, there is a rotation between Stokes
Q/U in the detector coordinate system and the linear
polarization that is modulated by the VPM. For this
reason, SQ and SU are highly covariant, and we define
the linear polarization axes"
"Pin = −Qin sin 2φP + Uin cos 2φP
Xin = Qin cos 2φP + Uin sin 2φP,"
"where φP is the axis of linear polarization that is mod-
ulated for each given detector. For the CLASS 40 GHz
design, |φP | < 3◦ across the focal plane. Implement-
ing this rotation orthogonalizes SQ and SU into SP and
SX , where SP is the modulation of linear polarization
along φP and SX is the sensitivity to the un-modulated
polarization axis."
"For an ideal VPM with zero instrument emissivity,
unpolarized light and the X linear polarization are un-
modulated, meaning Az = 0, SI = 1, and SX is con-"
"1 The different angles and planes of incidence also change the VPM
centered Mueller matrix for each pixel."
"stant. For real VPMs, the emissivity of the VPM,
�VPM, changes as a function of grid-mirror distance
(∆�VPM ∼ 5 × 10−4), due to the differential emissiv-
ity between the wire grid and the mirror. This causes
aspects of SI , SX , and Az to change with grid-mirror
distance; these combine to make up the VSS. The am-
plitude of the VSS is nearly constant, but it does depend
on the temperature of the VPM, which drifts slowly over
time. The portions of SI and SX that change with grid-
mirror distance are expected to have identical shapes.
Since any possible polarized atmospheric signal should
be orders of magnitude below the intensity signal, we
will ignore SX in the rest of this analysis."
"More complete derivations for these modulation func-
tions are discussed in Harrington (2018). Figure 2 shows
the modulation functions for three detectors, two or-
thogonal detectors near the center and one detector on
the top edge of the focal plane. The modulation func-
tions for the different detectors illustrate the effects of
detector angle and incidence on the VPM. Orthogonal
detectors in the same pixel have modulation functions
with opposite signs, and detectors with different eleva-
tion and azimuth offsets have slightly shifted modulation
functions due to the projection geometry onto the VPM
and the different path lengths through the VPM."
"The advantage of a continuous polarization modulator
is that it moves the polarization signal to a frequency
band that is above the 1/f knee of the system. To re-
move a large fraction of the correlated noise in the de-
tector timestreams and to prevent the large, fluctuating
intensity signal from numerically impacting the demod-
ulation process, the first step in demodulation is to pre-
filter the data with a high pass or bandpass filter that
preserves sufficient bandwidth around the modulation
frequency but removes the long timescale drifts in the
data. In practice, the exact shape of this filter does not
impact the demodulated signals as long as the cutoff is
above the 1/f knee frequency and the modulated signals
are preserved."
"Next, we define the modulation timestreams to be
the VPM modulation functions over time. These are
shown in the right plot of Figure 2 and are calculated
using the array of VPM mirror positions that are syn-
chronously sampled with the detector data. These mod-
ulation timestreams are prefiltered identically to the de-
tector data,"
Mi(t) = F {Si [z(t)]} . (6)
"Here, z(t) is the VPM grid-mirror distance as a function
of time, i denotes one of the different modulation func-
tions described above, and F is the prefiltering applied.
As discussed in Harrington et al. (2018), CLASS VPMs
implement a sinusoidal mirror motion where the range
of grid-mirror distances traversed by the VPM is set to
maximize the time spent observing the linear polariza-
tion. Choosing this setting, combined with the effects of"
CLASS 40 GHz VPM Demodulation Stability 5
0 1 2 3 4 5 6
Grid Mirror Distance (mm)
"S
en
si
ti
vi
ty"
"(K
p
er"
"SP
SX
SV"
0.00 0.05 0.10 0.15 0.20 0.25
Time (s)
"1.00 MP
MX
MV"
Figure 2. The left plot shows three example sets of modulation functions for a +45◦ detector near the center of the focal
"plane (solid lines), the −45◦ detector in the same pixel (dashed lines), and a +45◦ detector near the top left edge of the focal
plane (dot dashed lines). The black dashed lines denote the VPM throw for the 40 GHz telescope, the distances traversed by"
"the VPM mirror during operation. The blue lines are SP , the sensitivity to the modulated linear polarization as a function of"
VPM grid-mirror distance. The two orthogonal detectors in the same focal plane have modulation functions that have opposite
"signs. The pixel at the top of the focal plane, which has a larger angle of incidence on the VPM, has peaks slightly offset from"
"the central pixels due to the larger path length through the VPM. The orange lines show SX , which is the sensitivity to the"
unmodulated linear polarization. This is approximately zero for detectors with no azimuthal offset in the focal plane but is
"non-zero for detectors with an azimuthal offset due to the projection geometry onto the VPM. The red lines show SV , which is"
"out of phase with SP but has the same characteristics; orthogonal detectors have opposite modulation functions, and detectors"
"at different elevation offsets in the focal plane have different peak locations. The right plot shows the modulation timestreams,"
"M , (Equation 6) for the center +45◦ detector shown also in solid lines in the left plot. These timestreams use the 40 GHz VPM"
throw and modulation frequency (10 Hz) to convert the Stokes sensitivity as a function of grid-mirror distance to time.
"decoherence across the detector bandpass and the nec-
essary pre-filtering of the timestream data, results in
modulation timestreams that contain many harmonics
of the modulation frequency, fmod. Critically, MP and
MV are not orthogonal functions."
"Demodulation of detector timestreams in the context
of partially covariant modulation functions is accom-
plished through an explicit solution to a least-squares
fit,"
"]
= (MTN−1M)−1MTN−1F ~d (7)"
"where ~d is the detector timestream (Equation 4) and P
is the linear polarization modulated by the VPM (Equa-
tion 5). In this fit, N is an estimate of the detector noise
that is assumed to be white and uncorrelated due to the"
"prefiltering of the data. The matrix M has two columns
containing the modulation timestreams for P and V ,"
"

MP (t0) MV (t0)"
"MP (t1) MV (t1)
..."
MP (tN ) MV (tN )
"
 . (8)"
"The contributions from Az and SI are removed be-
cause their amplitudes are several orders of magnitude
smaller than SP and SV , but their functional forms are
similar in shape to SP . Including these terms in the
demodulation would make it difficult to reliably extract
the polarization timestreams. Instead, these effects will
be projected into the P and V timestreams, and any
variations of their contributions will be constrained."
"Using this least-squares fitting setup and assuming the
detector noise is constant over the fit time period, the
demodulated linear (P ) and circular (V ) timestreams
are"
"P = D−1
{∑"
"(MP Fd)
−
∑"
"(MPMV )
∑"
"(MV Fd)}
(9)"
6 Harrington et al.
"V = D−1
{∑"
"(MV Fd)
−
∑"
"(MPMV )
∑"
"(MP Fd)}
(10)"
with determinant term
"D =
∑
M2P"
"∑
M2V − {"
"∑
(MPMV )}2 . (11)"
"The summations in Equations 9, 10, and 11 are for a fi-
nite period of time over which the polarization incident
on the VPM is constant. The summations are replaced
with a low-pass filter to produce a continuous demodu-
lated timestream. This low-pass filter must have a cut-
off frequency that is less than the modulation frequency,
fmod, and greater than the rate of change of the incident
sky signal, which depends on the beam width and scan
speed of the instrument."
"The inverse Fisher matrix, ΣPV = (M
TN−1M)−1,"
"is the covariance matrix between the two parameters.
Tracking this quantity is necessary due to the covari-
ance between the modulation functions and its depen-
dence on the specific VPM positions traversed during
the timestream."
"A 3 × 2 rotation matrix, R(φP ) converts the demod-
ulated timestreams and their associated covariance ma-
trix into the [Q,U, V ] vectors, which are used in the
mapping routine. While the VPM only modulates one of
the linear Stokes parameters with circular polarization,
boresight rotation and sky rotation enables full sampling
of the Stokes parameters on the sky."
3. DATA SELECTION AND PROCESSING
"A study was undertaken to constrain the long time
scale noise properties of the CLASS data before and af-
ter demodulation by examining 2 hour long segments of
data collected throughout Era 1 for the 40 GHz CLASS
telescope. These segments were chosen during times
where the Sun was at least 10◦ below the horizon. This
limited the impact of azimuth-synchronous signals and
isolated time periods where Sun avoidance was unneces-
sary and, thus, the scan frequency was constant. They
are also limited to when the precipitable water vapor
(PWV) in the atmosphere, as measured by APEX2 or
ALMA3, was less than 3 mm. In addition, to prevent
a data glitch or jump repair from biasing the result,
data segments were only used if less than 1% of the
timestreams were flagged by glitch and jump detection
routines."
"Overall, 15,342 two hour timestreams of detector
pairs, representing 2,557 detector days of data, pass"
"2 APEX PWV data was taken from their radiometer website,
https://archive.eso.org/wdb/wdb/asm/meteo apex/form"
"3 ALMA PWV data, used for periods when the APEX radiometer
was not running, was acquired via private correspondence."
"these criteria and are used in this analysis. This is sig-
nificantly less than the total data acquired during the
first era of 40 GHz observations. These selection crite-
ria were chosen to enable a study of the intrinsic stability
achieved by the VPM during this observational period,
making it possible to quantify the benefits and limita-
tions of the front-end VPM polarization modulator with-
out confusion from other confounding systematics. The
scientific analysis for this first era of 40 GHz observa-
tions will not be subject to the restriction of 2 hour
sections of uninterrupted observing or the sun elevation
limit, meaning the analyzed data set will be larger and
a wider selection of potential systematic effects will be
considered."
"In addition to the aforementioned survey data, we also
analyze a small set of stare data, taken when the tele-
scope mount was stationary, from six 2-hour time peri-
ods during the first half of 2019. The stare data contains
the 1/f noise associated with the VPM and the atmo-
sphere, along a single line of sight, while avoiding any
additional effects from mount motion or scan pattern.
Many parts of the telescope structure were upgraded
between Era 1 and the 2019 stare data, primarily due to
the installation of the 90 GHz telescope. A second set
of mirrors and receiver were installed on the mount, and
the front-end forebaffle was expanded to serve both tele-
scopes. In addition, the wire grid on the 40 GHz VPM
was replaced with one with an improved copper finish
on the wires (Harrington et al. 2018), although this re-
placement does not appear to have significantly influ-
enced the demodulated data compared to Era 1 data.
Using data from the different observational configura-
tion is necessary because no equivalent data are avail-
able from Era 1, where stare observations were shorter
than 2 hours or during sub-par weather."
"The processing for these segments is similar to that
implemented for other CLASS analyses. Glitches and
jumps in the data due to transient detector effects are
repaired by fitting a quadratic function to each side of
the discontinuity, aligning the two functions, and inter-
polating in the cut region. For this study, a model for
the VSS and a noise estimate are added to the cut region
to smoothly join the two regions and enable FFT-based
periodogram estimation of the power spectral density of
the timestream. Next, the Butterworth filter applied to
the data by the warm readout electronics is deconvolved."
"As first described in Appel et al. (2019), the unique
oscillatory nature of the VPM enables one to utilize the
VSS to measure the time constants associated with the
detector response. For computational speed and robust-
ness, each segment is split into 10-minute sections. A
single-pole filter model that optimally removes hystere-
sis from the VSS at the mirror turn-around is fit to each
section of data. The median of this data set is then de-
convolved from the entire 2-hour segment. After time
constant deconvolution, the timestreams are converted"
https://archive.eso.org/wdb/wdb/asm/meteo_apex/form
"
CLASS 40 GHz VPM Demodulation Stability 7"
0 1000 2000 3000 4000 5000 6000 7000
Time (s)
"100
T
em"
"p
er
a
tu
re"
"(m
K
)"
10−3 10−2 10−1 100 101
Frequency (Hz)
"2
·s
)"
Intensity Pair Differenced Pair Diff. Demodulated
Figure 3. An example timestream (top) and power spectral density (bottom) for one of the 2-hour segments used in this
"analysis. The intensity, plotted in blue, is the pair-added data from a single pixel. The same data are shown pair-differenced"
in orange and pair-differenced then demodulated in red. The intensity timestream shows long timescale drifts and an azimuth
"synchronous signal. The intensity timestreams show several line features from the instrument, which are described in the"
"text. The pair-differenced data are a measure of how CLASS would do without a modulator, and thus the level at which scan"
modulation is possible for non-modulated small aperture experiments from the Atacama. The pair-differenced data have knee
"frequencies between 0.1–1 Hz. Demodulation increases the stability further, with knee frequencies that are about a factor of 20"
times smaller than pair-differencing alone. The demodulated white noise level is higher than the pair-differenced white noise by
"a factor of about 1/�mod (see Section 4.1), which is the effect of the linear polarization modulation efficiency for the VPM."
"to Rayleigh–Jeans temperature units using the methods
and values described in Appel et al. (2019)."
"The data at this point in the processing will be re-
ferred to as “single detector data” and, assuming Iin is
nearly entirely unpolarized, this timestream takes the
form"
"d± = (1± λP,inst)Iin + (Pin + λP Iin)SP (z)
+ (Vin + λV Iin)SV (z)"
+ TVPMAz(z).
"The ± denotes the difference between orthogonal de-
tector pairs and Az is the VSS, which has amplitudes
∼ 55− 110 mK in single detector data. The λ’s denote
the leakage of intensity into different aspects of the sig-
nal. λP,inst is the temperature to polarization (T → P )
leakage that occurs after the sky signal is modulated by
the VPM. λP and λV are the T → P leakages modu-
lated by the VPM into linear and circular polarization,
respectively. The first term in Equation 12 is the only
term that does not depend on the VPM position and is"
8 Harrington et al.
"therefore the only factor outside the 10 Hz VPM mod-
ulation band. Pairs of detectors are co-added to get the
total intensity signal, shown in blue in Figure 3. A 1 Hz
lowpass filter has been applied to all the timestreams
in the top plot of Figure 3 to remove the modulated
components."
"The single detector data are pair-differenced to create
a timestream of the form"
"dpd = λP,instIin + (Pin + λP Iin)SP,pd(z)"
"+ (Vin + λV Iin)SV,pd(z)"
"+ TVPMA±(z),"
"where the Si,pd’s are the modulation functions account-
ing for pair-differencing and A±(z) is the difference in
the VSS signal between the two orthogonal detectors.
A±(z) has amplitudes ranging from ∼ 12 − 55 mK de-
pending on position in the focal plane. An example of a
pair-differenced timestream is shown in orange in the top
plot of Figure 3. Since polarization incident on the VPM
is nearly entirely modulated, outside the 10 Hz modula-
tion band the pair-differenced data are dominated by the
instrument leakage of temperature into polarization that
occurs after the VPM. The analysis of CLASS 40 GHz
data is based on pair-differenced data because of the
correlated noise between paired orthogonal detectors re-
ported in Appel et al. (2019)."
"The pair-differenced data are demodulated follow-
ing the process described in Section 2. The resulting
timestreams have the forms"
"P = Pin + λP Iin + 〈SP,pd ·A±〉TVPM (14)"
"and
V = Vin + λV Iin + 〈SV,pd ·A±〉TVPM, (15)"
"where 〈SP,pd · A±〉 and 〈SV,pd · A±〉 represent the pro-
jection of the residual VSS into the linear and circular
polarizations, respectively."
3.1. Temperature to Polarization Leakage
"A measurement of the T → P leakage present in the
system is done by comparing the results of the different
data timestreams described above. All timestreams are
low-passed with a 1 Hz filter and down-sampled to iso-
late the longer time scale modes in the system. Polarized
azimuth synchronous ground pickup or sky signal could
bias estimates of the T → P leakage in the timestreams,
since distinguishing between the two requires much more
than 2 hours of data. An azimuth synchronous tem-
plate was fit to each timestream in each of the four data
sets (single detector, pair-differenced, demodulated lin-
ear, and demodulated circular) and removed from the
data. The template was created using fits to the first 19
terms of a Fourier series, a method chosen to limit the
scope of what was removed to known frequencies since
the azimuth synchronous signal is often below the noise
in the demodulated data. This method will also remove"
"the atmospheric circular polarization, due to Zeeman
splitting of oxygen molecules in Earth’s magnetic field,
which was measured by Petroff et al. (2020)."
"The different T → P leakage terms in Equations 13,
14, and 15 are estimated using template fits to the pair-
added intensity, I, for each set of data. The leakage
terms (λP,inst, λP , and λV ) for each set of timestreams
were calculated as"
"λx =
I · x
I · I , (16)"
"where x is the pair-differenced (dpd), demodulated linear
(P ), or demodulated circular (V ) timestreams. Each in-
dividual measurement of λx is low signal-to-noise given
the small level of T → P leakage expected with a front-
end polarization modulator: the formal statistical errors
are ∼ 0.004 per measurement, while the expected signals
are . 10−4 − 10−5. These measurements are performed
on all 15,342 timestreams to build a probability distri-
bution describing these effects."
3.2. Power Spectrum Fits
"Power spectral densities (PSDs) are calculated for the
timestreams in each of the four data sets described in the
previous section. As with the T → P leakage measure-
ments, a Fourier series fit was used to create an azimuth
synchronous signal template, which was subtracted from
the timestreams before the Fourier transforms were per-
formed. This removed lines in the PSDs at harmonics of
the scan frequency. Examples of these PSDs are shown
in the bottom frame of Figure 3. The PSDs for intensity
show several features, such as the spacing of the teeth
in the azimuth gear at 0.75 Hz and the pulse tube cryo-
cooler frequency at 1.4 Hz. The collection of lines at
5 Hz, 10 Hz, and 15 Hz are due to the VSS signal; the
5 Hz and 15 Hz portions of the VSS signal are due to a
design flaw in the 40 GHz VPM, which was corrected in
the other CLASS VPMs (Harrington et al. 2018). Fig-
ure 3 shows the dramatic drop in low frequency noise
achieved through demodulation."
"With the exception of the few line features in the non-
demodulated data, these PSDs are well defined by a
white noise level, ωn, and a single 1/f term, parame-
terized with a knee frequency and spectral index, that
describes the long timescale noise in the system:"
P (f) = w2n
")α)
. (17)"
"The PSDs of all timestreams were fit to Equation 17
with frequency masks used to remove the noise lines
present in the non-demodulated data. The 1/f knee
frequencies of the demodulated data are very low (.
20 mHz). Even when using 2 hours of data, the ma-
jority of the 1/f section of the spectrum occurs in the
lowest and least sampled frequency bins. Therefore, fits
for the knee frequency and spectral index must account"
CLASS 40 GHz VPM Demodulation Stability 9
0 2 4 6
Input fknee (mHz)
"F
it
f
k
n
e
e
(m"
"10 15 20
Fit fknee (mHz)"
Figure 4. The results of running the PSD analysis on syn-
thetic timestreams with known 1/f behavior. The left plot
shows the median fit knee frequencies as a function of input
knee frequency. The shaded area denotes the region that
contains 68% of the fits. The median fit knee frequencies
"are biased at the lowest frequencies due to the windowing,"
"assumption of 1/f behavior, and the low levels of statisti-"
cal sampling of the lowest frequency bins in a PSD. The red
dot-dashed line shows a hyperbolic function fit to fit knee
frequencies. This function is used to de-bias the knee fre-
quencies in the datasets that contain a significant number of
low knee frequencies. The right plot contains a histogram
of the fit knee frequencies for timestreams with a known
15 mHz knee frequency. This indicates that for fits around
"15 mHz, individual measurements have uncertainties (68%"
confidence) of ∼ 2 mHz.
"for the lower sampling and higher variance in these bins.
The data were binned in frequency space, and the model
was fit in log-space via the algorithm presented by Pa-
padakis & Lawrence (1993); this method accounts for
the sampling difference in the lower frequencies."
"Simulated timestreams were used to test for bias in
the fitting procedure and to estimate the uncertainty
in the resulting fit parameters. First, timestreams were
simulated with a spectral index of −1.5 and range of
values for 1/f knee frequencies, with 1000 timestreams
at each input value. The synthetic data were then run
through the same analysis and fitting procedure as for
the real data. The fit knee frequencies are shown in
Figure 4. The solid lines and shaded bands show the
median and 68% range of the distribution at each fre-
quency respectively. The median and percentile bands
are used because the fit distributions are non-Gaussian.
Inputting white noise (“fknee = 0 mHz”) results in an
output knee frequency of 1.39+0.72−0.22 mHz, indicating the
level at which the windowing and assumption of a knee
frequency bias the fit. For a 3 mHz input knee frequency
the fit knee is 3.47+0.97−1.01 mHz and for a 5 mHz input knee
frequency the fit knee is 5.30+1.31−1.16 mHz, indicating the
bias is significantly less around these values. For the
demodulated linear data set, fit knee frequencies below"
"these values represent less than 1.3 and 4.0% of the data,
respectively. For the values most common in the demod-
ulated linear data set, 7 . fknee . 20 mHz, the average
bias is ∼ 1%."
"The bias is more significant in the demodulated cir-
cular and stare data sets, where 47% and 31% of the
fit knee frequencies are below 5 mHz, respectively. For
these datasets, a hyperbolic function of the form ffit =√
f2true +A is fit to the bias curve. The inverse of"
"this function is used to de-bias the circular and stare
datasets; fits with knees below the y-intercept ("
"are assumed to be indistinguishable from white noise
on these timescales. This debiasing results in an almost
10% decrease in the median knee frequencies for circu-
lar polarization. In comparison, this technique would
produce a 1% decrease in the medians of the linear po-
larization knee frequencies."
"The fits to synthetic timestreams can also be used to
estimate the uncertainty for each individual fit to the
data. The 68% widths of the distributions for the range
covering the majority of the demodulated data set are
10 − 20% of the median value. An example of this is
shown in the right plot of Figure 4. An individual fit
with a knee frequency of 15 mHz can be expected to
have ∼ 2 mHz errorbars. The uncertainty on the spec-
tral index increases with decreasing knee frequency; it
generally has 10− 20% errors over the range of interest
for the demodulated linear data. The widths of these
distributions require that many measurements are used
to achieve a robust result for a measurement of the long
timescale noise in the system. Conversely, the uncer-
tainty on the white noise level is well-measured with
only 1% errorbars on the resulting values."
4. RESULTS
"The white noise, 1/f fits, and T → P measurements
for each 2-hour long timestream are compiled into proba-
bility distributions that describe the variation within the
data set and the uncertainty on the individual measure-
ments. For the 1/f fit values, the medians and 68% dis-
tribution widths for each variable and data set are com-
piled in Table 1. These metrics are chosen because many
of these distributions, especially for knee frequency, are
significantly non-Gaussian. The knee frequencies and
white noise distributions are in Figures 5 and 6, respec-
tively. Since each individual T → P measurement is
very low signal-to-noise, we look at the mean for each
pixel, as T → P is not expected to change for a static
optical setup. The absolute value of the per pixel T → P
is what affects mapping and cosmological analyses; 95%
of the pixels have T → P leakages below the level listed"
10 Harrington et al.
"Table 1. The first three rows list median 1/f fit values for each distribution measured in this analysis, where errors"
indicate the 68% widths of these distributions. The distribution widths are due to a combination of the precision of
each measurement and observed variation within the data set. The bottom two rows list the 95% confidence level of the
temperature to polarization leakage across the focal plane. The calculation of these numbers is described in the text.
Demodulated
Single Detector Pair-Differenced Linear Circular
"Knee Frequency 3.29+2.98−1.66 Hz 350
+611
−189 mHz 15.12"
"+21.6
−8.6 mHz 4.9"
"+10.7†
−3.9 mHz"
"Spectral Index −1.53+0.29−0.33 −1.62
+0.30
−0.26 −1.46"
"+0.34
−0.34 −1.44"
"+0.45
−0.55"
"White Noise (µKRJ
√"
"s) 393+172−90 (NET) 231
+25
−18 (NEQ/U) 339"
"+52
−39 (NEQ/U) 712"
"+76
−60 (NEV)"
"T → P |λP,inst| < 8.0× 10−2 |λP| < 3.8× 10−4"
T → V |λV| < 9.1× 10−4
"Note—All noise levels listed in this table are scaled to be “per detector,” meaning a factor of
√
Ndet is used to calculate the"
"noise level of the array for each measurement. Section 4.1 explains the expected differences between these values.
†The circular knee frequencies have been de-biased following the method in Section 3.2."
"in Table 1. This excludes two poorly behaving pixels on
the edge of the focal plane.4"
"While the main focus of this analysis is the demodu-
lated data, the single detector data and pair-differenced
data are also used to analyze the stability of the instru-
ment and atmosphere for small aperture telescopes oper-
ating at 40 GHz in the Atacama desert. Figure 5 shows
the probability distributions for the knee frequencies of
all four data sets in this analysis. The telescope scan
strategy is used to convert the temporal based knee fre-
quencies to the angular scales (multipole moments) cov-
ered by the telescope during that time. This conversion
does not account for all aspects necessary to produce
maps with sensitivity to a particular multipole moment
of the CMB, but can be used as a reference for the sta-
bility level in the data. If 1/f knee frequencies are not
sufficiently close to a targeted ` range, then the filtering
required to map the dataset will also significantly reduce
the sensitivity to that range. The exact requirements for
knee frequency with respect to targeted ` range depend
on the exact mapping technique."
"The single detector knee frequencies in Figure 5 illus-
trate why it is difficult to make CMB temperature maps
of the larger angular scales (` . 50) from the ground.
Variations in atmospheric emission and instrument sta-
bility create 1/f noise that is much higher than the level
required to observe the lowest multiple moments. The
single detector data determine a starting point for in-
strument stability, but the CLASS analysis has focused
on pair-differenced data because of the pixel-correlated"
"4 These pixels, compared to the rest of the focal plane, each have
less than 1/3 the number of segments passing data quality cuts
and will not be included in the larger CLASS 40 GHz analysis."
"noise in the focal plane (Appel et al. 2019) and a better
understanding of the pair-differenced polarized beams
(Xu et al. 2020). Pair subtraction removes the first-
order effects of many unpolarized sources of 1/f . Un-
polarized atmospheric emission, telescope temperature
changes, and readout-column synchronous systematics
are all significantly reduced by pair subtraction."
"The pair-differenced data are a measure of how
CLASS would do without a modulator, and thus the
level at which scan modulation is possible for non-
modulated small aperture experiments from the Ata-
cama. For CLASS 40 GHz pair-differenced data, 83%
of the timestreams have knee frequencies below 1 Hz,
and the median knee frequency is 346 mHz. Since the
VPM is placed at the front-end of the CLASS telescopes,
the long timescale sections of the pair-differenced data
contain a measurement of the T → P leakage of the in-
strument after the VPM. These effects are unmodulated
and will not affect the demodulated data. All sky and
instrument polarization before the VPM is modulated
up to the modulation frequency and is present in the
demodulated pair-differenced data. The demodulated
pair-differenced data are what CLASS actually achieves
in terms of long term stability."
"The pair-differenced demodulated linear polarization
data, for the entire data set, have a median knee fre-
quency of 15.12 ± 0.15 mHz, where the error is the es-
timated error on the median, found by bootstrapping.
The bootstrap method calculates the standard deviation
of the median values found when re-drawing the sample
1000 times. As will be discussed in Section 5, this knee
frequency depends on a variety of instrumental and ob-
servational parameters such as PWV, boresight angle,
and position in the focal plane. Naively mapping this
knee to ` for the CLASS scan strategy gives `knee ∼ 7,"
CLASS 40 GHz VPM Demodulation Stability 11
10−3 10−2 10−1 100 101
Knee Frequency (Hz)
Demod. Linear
Demod. Circular
Pair Diff. Single Det.
2 10 50 250 1000ℓ =
Figure 5. The knee frequencies fit for the single detec-
"tor, pair-differenced, and pair-differenced demodulated data."
"The pair-differenced data, indicating what CLASS could be"
"expected to achieve without the front-end VPM, have knee"
frequencies about an order of magnitude lower than that
of the single detector data. The pair-differenced demodu-
"lated knee frequencies, indicating the stability level CLASS"
"is achieving, are an order of magnitude smaller than the pair-"
differenced data and two orders of magnitude lower than the
single detector data. The shapes of these distributions are in-
fluenced by the uncertainty in individual fits and by the range
of observing conditions. The multipole moments marked on
the top of the plot match the observation frequency to the
angular scale scanned on the sky for the CLASS scan strat-
"well into the targeted largest angular scales on the sky.
We find the absolute value of the T → P leakage, |λP |,
to be < 3.8 × 10−4 (95% confidence), across the focal
plane. This value is consistent with that measured in
Xu et al. (2020) using beam mapping and is over two
orders of magnitude lower than what is observed in the
pair-differenced data before demodulation, emphasizing
the critical advantage of the CLASS front-end polariza-
tion modulator."
"The knee frequencies of the pair-differenced demod-
ulated circular polarization data are much lower than
for linear polarization. This is primarily due to a lower
theoretical T → V level due to the VPM. The wire grid
and mirror emission signature projects more closely to
the linear modulation functions than the circular. The
observed T → V limit is higher than the T → P limit
due to a higher measurement uncertainty. As discussed
in Section 3.2, ∼ 47% of the circular knee frequencies"
"are low enough to be biased by the 1/f fitting method
and the results in Table 1 are presented after de-biasing."
"An in-depth comparison between the CLASS 40 GHz
T → P and knee frequency measurements to those of
other CMB experiments with polarization modulators
is difficult because of the subtleties involved in com-
paring instruments with different design goals. Every
experiment that has implemented polarization modu-
lation has used a different combination of observation
frequency, scan pattern, beam width, modulator type,
and modulator placement. ABS, which used a front-end
continuously rotating half-wave plate (HWP) (Kusaka
et al. 2014), has the most similar optical design to the
CLASS telescopes. ABS observed at 150 GHz and, moti-
vated by a different targeted ` range, had a significantly
higher scan frequency and observed smaller patches of
sky. Beam maps and variations in the half-wave plate
synchronous signal amplitude versus loading were used
to constrain the ABS T → P leakage to < 7×10−4 (95%
confidence) across the focal plane (Essinger-Hileman
et al. 2016). While the CLASS 40 GHz T → P is mea-
sured at a similar level to ABS, we find knee frequencies
significantly higher than their reported 2.0 mHz (Kusaka
et al. 2014), even after accounting for the difference in
white noise levels. A similar result is found when com-
paring to continuous HWP tests by the Polarbear ex-
periment (Takakura et al. 2017). As will be discussed
in Section 5, we find this dichotomy to be explained by
non-(T → P ) related 1/f noise."
"The knee frequencies for pair-differenced data are an
order of magnitude smaller than those for single detec-
tor data, and demodulating that data leads to another
order of magnitude improvement in the long term sta-
bility of the data. The time required to integrate un-
correlated noise scales with the square of the noise level.
At 1 mHz, pair-differencing reduces this integration time
by a factor of about 60; demodulating reduces the inte-
gration time by another factor of about 110. The stabil-
ity and T → P leakage achieved with a front-end VPM
is critical for CLASS to achieve the scientific objective of
mapping the large angular scale CMB polarization from
the ground. The results presented in Table 1 contain
no post-processing beyond the azimuth-synchronous fit
removal described in Section 3. Thus, these data rep-
resent a starting point in the mapping pipeline, where
the removal of low-order polynomials or other destrip-
ing techniques can be used to further suppress the long
time-scale noise."
4.1. Modulation Efficiency
"The modulation efficiency, �mod, of the system is the
ratio of the demodulated to the pre-demodulation white
noise level.5 For VPMs, as described in Harrington et al."
"5 This was called fmod in Harrington et al. (2018). It is changed
here because we use fmod to describe the modulation frequency."
12 Harrington et al.
200 400 600 800 1000
"White Noise (µKRJ ·
√
s)"
Pair Diff.
Demod. Linear
Demod. Circular
Figure 6. The white noise distributions of the pair-
differenced and demodulated data highlighting the differ-
ence in modulation efficiency between the linear and circu-
lar demodulated data. The sinusoidal VPM throw is set to
maximize sensitivity to the linear polarization. The dashed
lines mark the noise levels predicted from the pair-differenced
data and the theoretical modulation efficiency. The differ-
ence between the solid and dashed lines indicate a slightly
higher than expected noise level for the circular polariza-
"tion timestreams, possibly due to some unknown VPM syn-"
chronous noise source.
"(2018) for linear polarization, the expected modulation
efficiency depends primarily on the mirror throw param-
eters, the bandwidth of the detectors, and the beam
incidence angle on the VPM. Given the detector band-
pass and instrument optical design, the mirror throw
parameters are set to maximize the linear modulation
efficiency."
"Harrington et al. (2018) Equation 4 defines a sim-
pler method of calculating �mod, which only looks at
the modulation function of the parameter in question
(linear or circular polarization, SP or SV ). The more
complete way to calculate the expected modulation effi-
ciency is propagation of uncertainties through Equations
9 and 10. This method, which accounts for the covari-
ance between P and V in the modulation, differs from
the simpler method at sub-percent levels. The more rig-
orous calculation is used for the results discussed here.
Accounting for the actual positions of the VPM mir-
ror during data taking and the spread in modulation
efficiency due to the range of detector incidence on the
VPM, the median modulation efficiency for this data
set is expected to be 0.7001± 0.0002 for linear polariza-
tion and 0.3316 ± 0.0001 for circular polarization. The
uncertainties are the estimated error on the median cal-"
"culated using bootstrapping. The predicted values have
68% distributions widths of about ±0.03 due to the dif-
ference in modulation efficiency across the focal plane
and accounting for the variation in VPM mirror throw
during the timestreams."
"Figure 6 shows histograms of the white noise levels for
the pair-differenced, demodulated linear, and demodu-
lated circular timestreams. All these values are normal-
ized to be per detector instead of per feedhorn (or pixel),
meaning the per feedhorn noise measurements are mul-
tiplied by a factor of"
"√
2 to obtain the per-detector noise"
"figures reported here. The dashed lines denote the distri-
butions predicted based on the pair-differenced data and
the theoretical modulation efficiencies calculated from
the VPM positions for each particular timestream."
"Both the linear and circular polarization timestreams
have slightly higher white noise levels than would be
expected from VPM demodulation alone. The observed
median modulation efficiency for linear polarization is
0.689± 0.001 and for circular polarization it is 0.3247±
0.0003. This difference indicates the presence of a small
level VPM synchronous noise. This is a 1% effect for the
linear polarization timestreams and a 3% effect for the
circular timestreams, small enough to have no significant
impact on the sensitivity of the CLASS instrument."
5. SOURCES OF DEMODULATED 1/f NOISE
"The median demodulated knee frequency for the first
observing era of the 40 GHz CLASS telescope was
15.12 mHz; however, as visible in Figure 5, the distribu-
tion of all knee frequencies for the demodulated data has
a large width. The measured demodulated knee frequen-
cies for each 2-hour segment were compared to various
characteristics of the telescope and site during that time,
such as the PWV, air temperature, wind speed, bore-
sight angle, and mirror temperatures. Here we discuss
the observational characteristics that have the largest
effect on the knee frequencies of the demodulated data."
"Table 2 lists the median knee frequency, spectral in-
dex, and white noise for a large variety of cuts on the de-
modulated linear polarization dataset. One of the data
splits with the largest impact is the position in the fo-
cal plane. Figure 7 shows the median knee frequency
for each pixel in the 40 GHz focal plane during the first
observation era. The eight “edge pixels,” those clos-
est to the orange circle in the figure, have beams that
are closest to the forebaffle at the entrance to the tele-
scope and have a median knee frequency about three
times larger than all the other “central pixels.” Xu
et al. (2020) found these pixels have features in the po-
larized beams consistent with a higher T → P leakage
and, while included in the < 3.8× 10−4 constraint, this
analysis also found higher T → P leakage in those pix-
els. The forebaffle is the part of the telescope before
the VPM, meaning instrumental polarization (T → P
leakage) or a spill, that changes as a function of VPM
position could influence the demodulated timestreams."
CLASS 40 GHz VPM Demodulation Stability 13
Table 2. The median values of the 1/f spectra fit parameters for a variety of different demodulated linear-
"polarization data splits. The first uncertainty is the bootstrapped error on the median, and the bimodal"
"uncertainties indicate the 68% widths for each distribution. Unless otherwise specified, the data use only the"
central pixels as defined in the text. The “epochs” listed are time periods during Era 1 marked by changes
"in the instrument configuration. The Early Epoch was the initial configuration post commissioning, the Stiff"
"Epoch is after stiffening measures were implemented on the telescope mount, and the Black Epoch is after"
absorptive blackening was applied to the forebaffle at the entrance of the telescope.
"Data Split Nsegments Knee Frequency (mHz) Spectral Index White Noise (µKRJ
√"
"All Pixels 15407 15.12± 0.15+21.25−8.5 −1.46± 0.0
+0.34
−0.34 338.33± 0.36"
"+50.54
−38.58"
"Edge Pixels 4264 30.22± 0.35+24.8−14.57 −1.49± 0.01
+0.28
−0.27 357.17± 0.83"
"+56.21
−33.1"
"Central Pixels 11143 11.65± 0.1+13.58−6.03 −1.45± 0.0
+0.35
−0.38 331.11± 0.42"
"+43.55
−38.47"
"PWV < 1.5 mm 8712 10.97± 0.1+12.74−5.68 −1.44± 0.01
+0.37
−0.4 329.62± 0.48"
"+44.33
−39.2"
"PWV > 1.5 mm 2431 14.27± 0.22+16.78−6.93 −1.45± 0.01
+0.3
−0.33 336.97± 0.94"
"+39.86
−36.42"
"Wind speed < 4 m/s 8893 11.26± 0.11+13.11−5.84 −1.46± 0.01
+0.36
−0.4 330.28± 0.48"
"+41.82
−38.02"
"Wind speed > 4 m/s 2250 13.74± 0.26+14.09−7.21 −1.4± 0.01
+0.33
−0.32 334.44± 1.04"
"+52.18
−40.57"
"BS −45.0◦ 1772 9.53± 0.16+10.05−4.58 −1.55± 0.01
+0.34
−0.44 331.05± 1.01"
"+31.15
−33.86"
"BS −30.0◦ 1695 10.01± 0.23+11.1−5.25 −1.56± 0.01
+0.37
−0.44 335.32± 1.02"
"+45.17
−36.0"
"BS −15.0◦ 1439 11.65± 0.3+12.3−6.32 −1.46± 0.01
+0.34
−0.37 332.68± 1.31"
"+38.29
−39.11"
"BS 0.0◦ 1730 12.64± 0.26+14.95−6.96 −1.36± 0.01
+0.33
−0.36 326.46± 1.0"
"+46.2
−38.07"
"BS +15.0◦ 1620 13.32± 0.29+14.25−6.69 −1.38± 0.01
+0.32
−0.32 328.62± 1.1"
"+45.55
−40.52"
"BS +30.0◦ 1485 13.18± 0.32+15.85−6.66 −1.37± 0.01
+0.35
−0.38 329.94± 1.25"
"+51.49
−40.3"
"BS +45.0◦ 1402 12.39± 0.28+16.67−5.76 −1.46± 0.02
+0.43
−0.35 335.11± 1.61"
"+46.7
−42.85"
"Early Epoch 2921 13.82± 0.24+15.31−7.43 −1.38± 0.01
+0.39
−0.37 327.29± 1.13"
"+57.99
−38.85"
"Stiff Epoch 1699 10.98± 0.26+11.5−5.73 −1.45± 0.01
+0.36
−0.32 332.98± 1.2"
"+50.89
−38.12"
"Black Epoch 6523 10.99± 0.12+13.06−5.5 −1.48± 0.01
+0.34
−0.41 331.89± 0.52"
"+37.96
−37.14"
Stare Data: From Second Observational Era
"All 139 7.47± 0.69+15.64†−4.25 −1.74± 0.03
+0.31
−0.35 335.57± 2.31"
"+47.12
−20.6"
"Central Pixels 103 6.95± 0.8+15.29†−4.29 −1.78± 0.04
+0.33
−0.31 329.07± 3.61"
"+42.51
−19.18"
"PWV < 1 mm 50 4.24± 0.92+17.14†−2.86 −1.77± 0.07
+0.41
−0.68 322.39± 3.39"
"+42.47
−13.85"
"PWV > 2 mm 53 8.46± 0.82+12.53†−4.11 −1.79± 0.05
+0.19
−0.19 335.44± 3.0"
"+42.62
−16.24"
"Edge Pixels 36 8.92± 2.56+17.09†−4.52 −1.66± 0.07
+0.25
−0.45 358.84± 11.17"
"+41.07
−24.31"
"PWV < 1 mm 19 8.16± 3.23+29.18†−3.75 −1.52± 0.05
+0.16
−0.23 375.03± 18.6"
"+67.03
−41.29"
"PWV > 2 mm 17 10.03± 3.92+16.28†−5.54 −1.78± 0.14
+0.21
−0.43 358.3± 9.35"
"+38.33
−18.06"
Note— † These numbers have been “debiased” using the method described in Section 3.
"The size and shape of the forebaffle also influences the
level of ground pickup. Any of these effects could cause
increased T → P leakage or 1/f in the demodulated
data."
"Unlike the polarized beams in Xu et al. (2020), the
higher knee frequency effect in the edge pixels was not
changed by the installation of absorptive blackening"
"on the forebaffle surface in July 2017 (denoted as the
“Black” epoch in Table 2). All other analysis in this sec-
tion is presented without measurements from the edge
pixels in order to isolate the investigation of the different
sources of 1/f . The forebaffle encroachment radius was
increased and its shape was made more ovular during
later observing seasons to accommodate two telescopes"
14 Harrington et al.
"−10◦ −5◦ 0◦ 5◦ 10◦
Focal Plane Position"
"K
n
ee"
"F
re
q
u
en
cy"
"(m
H
z)"
Figure 7. The median demodulated knee frequencies per
"pixel in the focal plane. The orange circle denotes the shape,"
"but not the actual radius, of the forebaffle at the entrance"
"to the telescope. Eight pixels, the four left-most and the"
"four right-most, have significantly higher demodulated knee"
frequencies than the more central pixels.
"on the same mount. This change should have reduced
the overall effect of the forebaffle and will affect how pix-
els on opposite sides of the focal plane interact with it.
The stare data set, comprised of data from this second
observational era, shows no statistically significant dif-
ference between the edge and central pixels. This is an
indication that the forebaffle changes improved the per-
formance of the telescope, but more analysis is necessary
to verify this conclusion."
"When the knee frequencies are binned with respect
to wind speed there is a distinct shift in median knee
frequency at about 4.25 m/s. While we could expect the
atmosphere to change faster with higher wind speeds,
and thus increase the atmospheric contribution to the
1/f , this would be a more gradually evolving effect. A
more likely explanation of this shift is an excitation of a
vibrational mode in the telescope structure. The rest of
the analysis in this section is presented with observations
for which the wind speed is less than 4 m/s."
5.1. Red Noise Amplitudes
"The two observational characteristics with a signifi-
cant and interconnected impact on the long term sta-
bility of the demodulated timestreams are PWV and
boresight angle. Quantifying the contributions from
different observational factors requires assuming mul-
tiple sources of 1/f noise exist in the demodulated
timestreams. However, as described in Section 3, the
spectra of individual PSDs are well described by only
one 1/f term. This implies that either the 1/f noise
sources have similar spectral indexes or some contribu-
tions are significantly smaller than others. Either case"
"would make fitting to a more complex noise model dif-
ficult, so we will look at how the fit to a single 1/f
noise source would be affected by the presence of multi-
ple smaller noise sources."
"We will assume each 1/f noise source has the same
α = −1.46 for the entire data set. While not completely
correct, this is a reasonable assumption since the large
majority of 1/f sources have pink spectra with −2 ≤
α ≤ 0 and we do not see large deviations from this when
looking at different subsections of the dataset. We also
note that while knee frequencies are generally defined
with respect to a white noise level, the amplitude of the
1/f portion of the PSD can be referenced to any chosen
pivot frequency. For this part of the analysis we choose"
"f−αp = (10 mHz)
1.46 (18)"
"to convert knee frequency, fk,fit, and white noise, ωn, to
a “red noise amplitude,” ωr,fit, at the pivot frequency.
This noise amplitude is assumed to include various noise
sources ωs(tobs) that vary with time and a baseline noise
term ωr,base that accounts for the other 1/f noise not
explicitly included in the source list:"
"ω2nf
−α
k,fit = ω"
"2
r,fitf"
"= ω2r,basef
−α
p +"
"∑
s∈Sources"
"ω2r,s(tobs)f
−α
p ."
"Specifying the noise sources against the same pivot fre-
quency enables direct comparisons of their amplitudes.
The different sources of 1/f noise add in quadrature."
5.2. PWV Dependence
"Figure 8 shows the median red noise amplitude of the
data when split by boresight angle and PWV6 in the first
seven plots. The blue data points are the median red
noise amplitude in that bin, and the errors are estimated
using bootstrapping. The histograms in the background
show the number of samples in each bin. The square of
the red noise amplitude with respect to PWV is fit to
lines for each boresight angle. The lowest PWV point
for 0◦ boresight is excluded from the fit because its value
and uncertainty are abnormally low, which appears to
be due to timing of when data in that point were taken.
These fits are plotted in Figure 8 and have reduced χ2"
"values between 1.2 and 2.9, indicating the model fairly
represents those data. The slopes and y-intercepts of
these fits are plotted in bottom-middle and bottom-right
plot, respectively, with errors estimated using bootstrap-
ping. The fit values for the slope with PWV are not
significantly different for the different boresight angles
and their weighted average gives a measurement of the"
"6 We note that these PWV values, as measured by the APEX or
ALMA experiments, are the values for PWV at Zenith, while the
CLASS observations are at 45◦ elevation."
CLASS 40 GHz VPM Demodulation Stability 15
"amplitude of the PWV related red noise in the demod-
ulated timestreams,"
"ω2r,pwv = (203± 12)2
("
")
µK2RJ · s. (20)"
"The PWV-scaling can be subtracted, in quadrature,
from the red noise amplitudes of every fit to the de-
modulated timestream PSDs. This results in a ∼ 32%
reduction in median red noise across the data set."
"PWV tracks the amount of water vapor suspended in
the atmosphere. Increasing PWV increases the overall
thermal emission from the atmosphere and a relation
between the amplitude of turbulence-sourced 1/f noise
and PWV has been observed by large-aperture experi-
ments (Lay & Halverson 2000; Dünner et al. 2013). As
discussed in Appendix A, the CLASS 40 GHz single-
detector timestreams do not observe the same 1/f spec-
trum as the large-aperture experiments, but it is not
surprising that an atmospheric signal is observed in the
demodulated data."
"Following Equation 14, there are three mechanisms
for how large-scale atmospheric fluctuations could en-
ter into the demodulated timestreams. First, we could
be observing an actual large-scale polarized signal from
the atmosphere (Pin 6= 0). CLASS has observed this in
V , where the signal is due to Zeeman splitting of oxy-
gen lines in the Earth’s magnetic field (Petroff et al.
2020); however the Zeeman effect produces negligible
linear polarization and other sources of polarized molec-
ular emission are not coherent on atmospheric length
scales (Hanany & Rosenkranz 2003)."
"Takakura et al. (2019) recently found evidence for po-
larized ice clouds in the upper atmosphere, where the
polarization is almost entirely aligned along Stokes Q
in horizontal coordinates. The signal from these clouds
can be quite significant (≥ 200 mK) at 150 GHz. How-
ever, scaling to 40 GHz and accounting for the CLASS
beam size implies the signal from these clouds would
be less than 1 mK for even the largest clouds. This
level of signal is small enough to not be flagged in the
data timestreams and could influence the 1/f spectrum
when observing Stokes Q. If the polarized ice clouds
were influencing the 1/f spectrum of the demodulated
pair-differenced timestreams, the effect would be sym-
metric with boresight and the highest red noise ampli-
tudes would be at ±45◦ boresight angle, where instru-
ment U is aligned with horizontal Q. The pattern ob-
served with boresight, shown in the bottom right plot
of Figure 8, does not reflect what would be expected if
polarized clouds were influencing the 1/f portion of the
timestream PSDs."
"Another unlikely mechanism is that we are observ-
ing atmospheric temperature fluctuations occurring at
the VPM frequency. Effectively, anything with func-
tional form A where 〈SP · A〉 6= 0 could leak into the
demodulation. This is very unlikely to happen for atmo-
spheric fluctuations. They would be suppressed by pair-"
"differencing and, given the 1.6◦ FWHM of the beam and
the 1◦/s scan frequency, atmospheric fluctuations should
not be visible above ∼ 400 mHz; much lower than the
10 Hz modulation frequency."
"The last and most likely scenario is that large-scale at-
mospheric temperature variations could be leaking into
the data through T → P leakage (λP 6= 0). The level of
T → P leakage required to have the effect of Equation 20
on the demodulated data is difficult to estimate because
we do not see similar patterns with boresight, PWV, and
red noise amplitude for our single detector data. In ad-
dition, large-scale atmospheric contributions to the de-
modulated PSDs could be in the form of a stochastic 1/f
spectrum or a set of slowly varying line features at har-
monics of the scan frequency. The residual line features,
after subtraction of a single azimuth template for the
timestream, could bias the 1/f fitting to a higher knee
frequency. The amplitudes of these effects are small; for
this analysis, it is not possible to distinguish between
these large-scale slow varying atmospheric contributions
and slowly varying azimuth synchronous signal. This
will require multi-frequency simultaneous observations
from multiple telescopes and should be possible to test
in the future, with CLASS, using simultaneous observa-
tions from four frequency bands."
5.3. Boresight Dependence
"While unlikely to be sourced by polarized clouds, the
discrepancy between the positive and negative bore-
sights is statistically significant. As shown in the
bottom-right plot of Figure 8, the baseline red noise
(ωr,base) goes from 248±15 µKRJ ·"
"√
s for negative bore-"
"sights to 321 ± 14 µKRJ ·
√"
"s for positive boresights.
Neither range has a statistically significant trend as a
function of boresight. This effect is likely to be caused
by some type of mechanical vibration induced in the
telescope structure. In the CLASS mechanical design,
0◦ boresight is where many beams and joints transition
from being loaded under compression to under tension or
vice versa, meaning a change in the resonance frequen-
cies of the structure could be expected at that point.
The influence of vibrations of either the focal plane or
the optical elements could leak into the demodulated
data. If a vibration induced signal, AV , has a structure
such that 〈SP · AV 〉 varies slowly with time, this will
produce demodulated 1/f ."
"There are other factors which point to slowly vary-
ing vibration amplitudes as the source of the boresight
dependence in the demodulated 1/f knees. First, the
measured T → P leakage does not see an analogous
pattern to the knee frequencies when split by boresight.
In addition, there was a change when additional vibra-
tion suppression measures were implemented in Decem-
ber 2016 (denoted as the “Stiff” epoch in Table 2). The
median baseline red noise for the negative boresights de-
creased by 105± 9 µKRJ ·"
"√
s after these measures were"
implemented while the positive boresights decreased by
16 Harrington et al.
"−45◦ 0◦ +45◦
Boresight"
"P
W
V
R
ed"
"N
o
is
e
F
a
ct
o
r"
"R
J
√
s/
√
m
m
)"
"−45◦ 0◦ +45◦
Boresight"
"B
a
se
li
n
e
R
ed"
"N
o
is
e"
"R
J
√
s)"
0 1 2 3
PWV (mm)
"N
o
is
e
a
t
1
0
m
H
z"
"R
J
√
s)"
Boresight: −45◦
0 1 2 3
PWV (mm)
"N
o
is
e
a
t
1
0
m
H
z"
"R
J
√
s)"
Boresight: −30◦
0 1 2 3
PWV (mm)
"N
o
is
e
a
t
1
0
m
H
z"
"R
J
√
s)"
Boresight: −15◦
0 1 2 3
PWV (mm)
"N
o
is
e
a
t
1
0
m
H
z"
"R
J
√
s)"
Boresight: 0◦
0 1 2 3
PWV (mm)
"N
o
is
e
a
t
1
0
m
H
z"
"R
J
√
s)"
Boresight: 15◦
0 1 2 3
PWV (mm)
"N
o
is
e
a
t
1
0
m
H
z"
"R
J
√
s)"
Boresight: 30◦
0 1 2 3
PWV (mm)
"N
o
is
e
a
t
1
0
m
H
z"
"R
J
√
s)"
Boresight: 45◦
Figure 8. The first seven plots show the median red noise amplitudes at 10 mHz for each boresight angle when binned in
PWV with uncertainties that are bootstrapped-estimated errors on the median. The median is used to prevent long tails in the
distributions from significantly influencing the results. The lighter blue bars indicate the relative number of measurements in
each bin. The orange lines are fits to the square of the red noise amplitude vs PWV for each boresight. The bottom middle
(right) plot shows the slope (y-intercept) of the fits. The errors on the fit parameters come from bootstrapping the data used
for each fit.
CLASS 40 GHz VPM Demodulation Stability 17
"50 ± 13 µKRJ ·
√"
"s. Conversely, the baseline red noise
levels per boresight differ by less than 1σ before and af-
ter absorptive blackening was applied to the forebaffle."
"It is clear there are residual boresight dependent,
VPM synchronous vibrations that are affecting the long-
term stability of the demodulated data during the first
observing era for the CLASS 40 GHz telescope. During
this observing time, there was only one telescope on the
telescope mount that was designed to hold two. Coun-
terweights were installed on the opposite side, to par-
tially replicate the weight of the uninstalled telescope.
It is possible an uneven mass distribution contributed
to these boresight dependent vibrations. Since the first
observing era, the second telescope has been installed on
that mount, and a third telescope was installed on a sec-
ond mount. Preliminary analysis of Era 2 data does not
show the same discontinuity with boresight, suggesting
the evening out of the weight distribution or one of the
other upgrades remidied this discontinuity."
"The offset at positive boresights is subtracted, in
quadrature, from the red noise amplitudes of every fit.
The reduced red noise amplitudes are then scaled back
to a knee frequency using the white noise level of the
timestream. Adjusting for the positive boresight vibra-
tional offset reduces the knee frequency of the central
pixels from 11.65±0.1 to 10.4±0.2 mHz, corresponding
to a 15% reduction in the red noise amplitude."
5.4. Comparison with Stare Data
"A similar 1/f noise analysis was performed on the
six stare observations during the second observing era
for the 40 GHz telescope. These data, taken while the
mount was not scanning, were used to get an estimate of
the baseline level of 1/f possible with a front-end VPM.
The data are processed identically as the scanning data
and the fits to the PSDs are also listed at the bottom of
Table 2. The spectral indexes of these data are steeper
than those of the scanning data, possibly indicating the
1/f noise for stare data is dominated by a source differ-
ent than what dominates the scanning data."
"The median knee frequency for stare data from the
central detectors with PWV < 1 mm is 4.24±0.92 mHz.
This level of 1/f noise includes any variation in demod-
ulated data due to the stability of the VPM alone and
would also detect any fluctuations due to instabilities in
the readout system if they were a dominating factor of
the residual 1/f . The estimated knee frequency of the
scanning data-set when both the effects of PWV and
boresight are removed is 7.5±2.0 mHz; about 2σ higher
than the stare 1/f knee frequency."
"Since intrinsic variability of the VPM does not account
for the residual 1/f noise, once the boresight offset and
PWV variation are removed, we are left to conclude the
residual 1/f noise is due to something associated with
scanning."
6. CONCLUSIONS
"In this paper we have examined the long time-scale
stability of the data from the 40 GHz CLASS telescope
using a front-end variable-delay polarization modulator
and found a substantial decrease in temperature to po-
larization leakage and knee frequencies between the pair-
differenced and demodulated timestreams. This will en-
able CLASS to observe the largest-angular scales of the
CMB polarization from the ground."
"We have presented a demodulation scheme that ac-
counts for the covariance between the modulated linear
and circular polarizations through a continuous least-
squares fitting approach and outputs timestreams of the
linear and circular polarization incident on the VPM as
well as their associated covariances."
"The demodulation process was applied to a selec-
tion of data taken by the 40 GHz CLASS telescope
during its first observational era from September 2016
to March 2018. The “raw” single detector, pair-
differenced, and pair-differenced demodulated data are
fit to 1/f spectra and the T → P leakage is estimated
through template fitting to the various timestreams. We
find the T → P leakage in the demodulated data is
< 3.8 × 10−4 (95% confidence) across the focal plane.
The median knee frequencies of the linear demodulated
data is 15.1 mHz, corresponding to a factor of 110 re-
duction in integration time at 1 mHz compared to pair-
differencing but higher than would be expected from
the T → P alone. The modulation efficiency, the ratio
of white noise in the demodulated data to white noise
of the data before demodulation, is found to be in good
agreement with the theoretical prediction."
"Lastly, we examine the demodulated linear
timestreams to constrain possible sources of the 1/f
noise in these data. We find the pixels closest to the
forebaffle at the edge of the focal plane have significantly
higher 1/f knees and that all knee frequencies increase
for wind speeds above 4.25 m/s. The more central pixels
have median knee frequency of 11.65 ± 0.1 mHz. This
1/f behavior further depends on PWV and the bore-
sight angle of the observation. The PWV dependence,
due to T → P leakages, accounts for about 32% of the
red noise in the CLASS 40 GHz data. We can expect
this fraction to be higher for the higher observing fre-
quencies where the atmospheric signal is brighter. A
boresight dependent effect, likely due to mount vibra-
tions, accounts for about 15% of the 1/f noise. The is a
remaining sources of 1/f noise that is likely associated
with the instrument scanning motion because the stare
data PSDs are found to have less 1/f noise than the
scanning PSDs."
"The 1/f behavior studied in this analysis presents the
status of the data with no post-processing beyond the
removal of an azimuth-synchronous fit. With the pres-
ence of a front-end VPM, the CLASS 40 GHz telescope
has achieved a level of 1/f noise that, using the tele-
scope scan strategy, brings the projected knee in mul-
tipole space well into the largest angular scales on the"
18 Harrington et al.
"sky (` . 10). This result is in agreement with the white
noise levels observed in preliminary maps of the 40 GHz
CLASS data. This would not be possible without the
substantial reduction of 1/f noise due to the VPM. In
future work, we will be expanding this analysis to in-
clude simultaneous multi-frequency observations to fur-
ther constrain the sources of 1/f noise in the CLASS
data."
ACKNOWLEDGMENTS
"We acknowledge the National Science Foundation Di-
vision of Astronomical Sciences for their support of
CLASS under grant Nos. 0959349, 1429236, 1636634,
1654494, and 2034400. We thank Johns Hopkins Uni-
versity President R. Daniels and Dean J. Toscano for
their steadfast support of CLASS. The CLASS project
employs detector technology developed in collaboration
between JHU and Goddard Space Flight Center un-
der several previous and ongoing NASA grants. De-
tector development work at JHU was funded by NASA
grant No. NNX14AB76A. K. Harrington was supported
by NASA Space Technology Research Fellowship grant
No. NX14AM49H and by the U.S. Department of
Energy, Office of Science, under Award Number DE-
SC0015799 for parts of this work. Zhilei Xu is sup-
ported by the Gordon and Betty Moore Foundation."
"R.D. and R.R. thanks CONICYT for grant BASAL
CATA AFB-170002. R.R. acknowledges support from
ANID-FONDECYT through grant 1181620. We thank
scientists from NIST for their contributions to the detec-
tor and readout systems, including Johannes Hubmayr,
Gene Hilton, and Carl Reintsema. We acknowledge sci-
entific and engineering contributions from Max Abitbol,
Fletcher Boone, David Carcamo, Saianeesh Haridas,
Connor Henley, Lindsay Lowry, Isu Ravi, Gary Rhodes,
Daniel Swartz, Bingjie Wang, Qinan Wang, Tiffany Wei,
and Zi’ang Yan. We thank William Deysher, Maŕıa
José Amaral, and Chantal Boisvert for logistical sup-
port. We acknowledge productive collaboration with
Dean Carpenter and the JHU Physical Sciences Ma-
chine Shop team. We further acknowledge the very gen-
erous support of Jim and Heather Murren (JHU A&S
’88), Matthew Polk (JHU A&S Physics BS ’71), David
Nicholson, and Michael Bloomberg (JHU Engineering
’64). CLASS is located in the Parque Astronómico Ata-
cama in northern Chile under the auspices of the Agen-
cia Nacional de Investigación y Desarrollo (ANID)."
"Software: IPython (Pérez & Granger 2007), numpy
(van der Walt et al. 2011), scipy (Virtanen et al.
2019), matplotlib (Hunter 2007), PyEphem (Rhodes
2011), moby2 (https://github.com/ACTCollaboration/
moby2),"
APPENDIX
A. SOURCES OF INTENSITY 1/f NOISE
"The single detector data and PSDs contain the atmo-
spheric temperature information and any other intensity
related signals. The atmosphere is normally the largest
temperature source continuously observed by a ground-
based CMB telescope. Any T → P leakage will con-
vert atmospheric temperature into polarization, and the
single detector data are one mechanism of calibrating
the level of atmospheric signal observed by the CLASS
40 GHz telescope. This calibration is necessary because
the CLASS 40 GHz beam, bandpass, and scan strategy
are unique among operating Atacama telescopes."
"The observed atmospheric signal is comprised of a
bulk airmass with a temperature that varies smoothly
with a direction and time as well as small-scale turbu-
lence modes. Atmospheric turbulence and the theoret-
ical models describing it have been well characterized
from the CLASS Atacama site (Church 1995; Lay &
Halverson 2000; Dünner et al. 2013; Errard et al. 2015)."
"One of the signatures of atmospheric turbulence is the
spectral index of the fα power law in the data PSD. For
Kolmogorov turbulence, this index ranges from −8/3
to −11/3 depending on the size scale of the turbulence
modes (Lay & Halverson 2000). This power law index
and its variation with precipitable water vapor (PWV)
have been observed from the Atacama by ACT (Dünner"
"et al. 2013) and from the South Pole by ACBAR (Buss-
mann et al. 2005). From Table 1, the median spectral
index observed at 40 GHz by the CLASS telescope is
much shallower than the values predicted from turbu-
lent motion in the atmosphere."
"Errard et al. (2015) used Polarbear data to cal-
ibrate a model of turbulence for the Atacama and
found the injection scale of the turbulent modes to be
∼ 200 − 500 m in size. Depending on the height where
the turbulent modes are injected, this injection scale cor-
responds to an angular scale of 14◦−0.3◦ for the largest
turbulent features. The 40 GHz CLASS beams have a
full-width half max (FWHM) of ∼ 1.6◦ (Xu et al. 2020),
meaning the 1/f power law observed by larger-aperture
telescopes in the Atacama should not be expected for
the CLASS 40 GHz telescope because the beams smooth
over the majority of the turbulent modes in the atmo-
sphere."
"Figure 9 shows plots of the spectral index distributions
(left) and median spectral index (right) fit for each de-
tector in the 40 GHz focal plane. The shaded regions
in the right plot denote the assigned multiplexing col-
umn. An important feature in the right plot is that
many of the closest pixel-pairs have significantly dif-
ferent median spectral indexes (e.g. the center of the
bottom two rows). If the primary source of these long-"
"https://github.com/ACTCollaboration/moby2
https://github.com/ACTCollaboration/moby2"
"
CLASS 40 GHz VPM Demodulation Stability 19"
"−3.0 −2.5 −2.0 −1.5 −1.0 −0.5 0.0
Single Det. Spectral Index"
"−10◦ −5◦ 0◦ 5◦ 10◦
Focal Plane Position"
C2C3C4C5
"S
in
g
le
D
et
.
S
p
ec
tr
a
l
In
d
ex"
Figure 9. (Left) Histograms of the single detector spectral index distributions broken out per detector and grouped by
readout column. (Right) The median single detector spectral indexes in the CLASS 40 GHz focal plane. Each half circle in
this plot represents one of the detectors. The gray-scale half circles are shaded by the median single detector spectral index
value. The shaded outer regions label the readout column assigned to each detector in the time-division multiplexing scheme.
If atmospheric turbulence was the dominant source of 1/f noise we would expect the spectral index to be consistent across the
"focal plane. Larger scale atmospheric fluctuations would depend on airmass and elevation on the sky, meaning detectors with"
the same elevation offset in the focal plane would have the same spectral index. Although boresight rotations move the elevation
"offset to different elevations on the sky and this plot shows the median for all boresights, the observed pattern persists when"
"the data are split by boresight. Instead, detectors with the same elevation offset but different readout column placement show"
different 1/f spectral indexes. This points to readout effects being a larger contributor to 1/f than the atmosphere for single
detector data on the 2-hour timescales examined here. The stability of pair-differenced and pair-differenced demodulated data
does not show a similar dependence on readout column.
"timescale fluctuations was atmospheric, we would ex-
pect detectors next to each other to see the same at-
mosphere as the telescope scans at a constant elevation.
The significant difference in spectral index between some
nearest-neighbor pixels points to a source different than
the atmosphere."
"A possible alternative source for the single-detector
data long-timescale 1/f noise is the electronics in the
focal plane and multiplexing readout system. Volt-
age fluctuations across the detector bias lines were ob-
served to create correlated noise between detectors in
the same readout column in dark detector testing for
the 40 GHz CLASS focal plane. These voltage fluc-
tuations would be expected to occur on all timescales.
The nearest-neighbor pixel pairs with the most differ-
ent spectral indexes are on multiplexing column bound-
aries and in-focal-plane-wiring, while the spectral in-
dexes within columns are generally uniform. Since the
atmospheric turbulent spectrum is expected to plateau"
"at larger angular scales, and thus lower temporal fre-
quencies, it appears the single detector 1/f is dominated
by the fluctuations in the readout system."
"The column correlated noise is most easily removed
from the data by pair-differencing, since every detec-
tor is on the same column as its pixel pair. For this
reason, 40 GHz CLASS analysis, including the demodu-
lated data in this paper, is done with pair-differenced
data. However, the dominance of readout noise at
long timescales will affect any measurements of intensity
that requires pair-adding data. In particular, compar-
ing the knee frequencies of single detector data to pair-
differenced and/or demodulated data does not produce
a reliable estimate of temperature to polarization leak-
age. A similar search of readout-induced 1/f was done
for the demodulated data and no column-correlated ef-
fects could be found. This indicates that readout may
be a dominant source of 1/f noise for single-detector
data but not for pair-differenced demodulated data."
REFERENCES
"Adachi, S., Aguilar Faúndez, M. A. O., Arnold, K., et al."
"2020, arXiv e-prints, arXiv:2005.06168"
"Appel, J. W., Xu, Z., Padilla, I. L., et al. 2019, ApJ, 876,"
126. https://doi.org/10.3847%2F1538-4357%2Fab1652
https://doi.org/10.3847%2F1538-4357%2Fab1652
"
20 Harrington et al."
"Bennett, C. L., Halpern, M., Hinshaw, G., et al. 2003,"
"ApJS, 148, 1"
"Bennett, C. L., Larson, D., Weiland, J. L., et al. 2013,"
"ApJS, 208, 20"
"Bussmann, R. S., Holzapfel, W. L., & Kuo, C. L. 2005,"
"ApJ, 622, 1343"
"Bustos, R., Rubio, M., Otárola, A., & Nagar, N. 2014,"
"Publications of the Astronomical Society of the Pacific,"
"126, 1126"
"Church, S. E. 1995, Monthly Notices of the Royal"
"Astronomical Society, 272, 551."
https://doi.org/10.1093/mnras/272.3.551
"Chuss, D. T., Wollack, E. J., Henry, R., et al. 2012, ApOpt,"
"51, 197"
"Doroshkevich, A. G., Zel’dovich, Y. B., & Syunyaev, R. A."
"1978, Soviet Ast., 22, 523"
"Dünner, R., Hasselfield, M., Marriage, T. A., et al. 2013,"
"ApJ, 762, 10"
"Eimer, J. R., Bennett, C. L., Chuss, D. T., et al. 2012, in"
Society of Photo-Optical Instrumentation Engineers
"(SPIE) Conference Series, Vol. 8452, Society of"
Photo-Optical Instrumentation Engineers (SPIE)
Conference Series
"Errard, J., Ade, P. A. R., Akiba, Y., et al. 2015, ApJ, 809,"
"Essinger-Hileman, T., Ali, A., Amiri, M., et al. 2014, in"
"SPIE, Vol. 915354, Millimeter, Submillimeter, and"
Far-Infrared Detectors and Instrumentation for
Astronomy VII
"Essinger-Hileman, T., Kusaka, A., Appel, J. W., et al."
"2016, Review of Scientific Instruments, 87, 094503"
"Hanany, S., & Rosenkranz, P. 2003, NewAR, 47, 1159"
"Harrington, K., Marriage, T., Ali, A., et al. 2016, in"
"Proc. SPIE, Vol. 9914, Millimeter, Submillimeter, and"
Far-Infrared Detectors and Instrumentation for
"Astronomy VIII, 99141K"
"Harrington, K., Eimer, J., Chuss, D. T., et al. 2018, in"
Society of Photo-Optical Instrumentation Engineers
"(SPIE) Conference Series, Vol. 10708, Society of"
Photo-Optical Instrumentation Engineers (SPIE)
"Conference Series, 107082M"
"Harrington, K. M. 2018, PhD thesis, Johns Hopkins"
University
"Hecht, E. 2012, Optics (Pearson)"
"Heinrich, C., & Hu, W. 2018, PhRvD, 98, 063514"
"Hinshaw, G., Larson, D., Komatsu, E., et al. 2013, ApJS,"
"208, 19"
"Hu, W., & Holder, G. P. 2003, PhRvD, 68, 023001"
"Hunter, J. D. 2007, CSE, 9, 90"
"Kamionkowski, M., Kosowsky, A., & Stebbins, A. 1997,"
"PhRvD, 55, 7368"
"Keck Array, BICEP2 Collaborations, :, et al. 2018, ArXiv"
"e-prints, arXiv:1810.05216"
"Keihänen, E., Keskitalo, R., Kurki-Suonio, H., Poutanen,"
"T., & Sirviö, A. S. 2010, A&A, 510, A57"
"Kusaka, A., Essinger-Hileman, T., Appel, J. W., et al."
"2014, Review of Scientific Instruments, 85, 024501"
"Kusaka, A., Appel, J., Essinger-Hileman, T., et al. 2018,"
"JCAP, 9, 005"
"Lay, O. P., & Halverson, N. W. 2000, ApJ, 543, 787"
"Louis, T., Grace, E., Hasselfield, M., et al. 2017, Journal of"
"Cosmology and Astro-Particle Physics, 2017, 031"
"Miller, N. J., Chuss, D. T., Marriage, T. A., et al. 2016,"
"ApJ, 818, 151"
"Obied, G., Dvorkin, C., Heinrich, C., Hu, W., & Miranda,"
"V. 2018, PhRvD, 98, 043518"
"Padilla, I. L., Eimer, J. R., Li, Y., et al. 2020, ApJ, 889, 105"
"Page, L., Hinshaw, G., Komatsu, E., et al. 2007, ApJS, 170,"
"Papadakis, I. E., & Lawrence, A. 1993, MNRAS, 261, 612"
"Peebles, P. J. E., & Yu, J. T. 1970, ApJ, 162, 815"
"Pérez, F., & Granger, B. E. 2007, CSE, 9, 21."
http://ipython.org
"Petroff, M. A., Eimer, J. R., Harrington, K., et al. 2020,"
"ApJ, 889, 120"
"Planck Collaboration I. 2019, A&A, in press,"
arXiv:1807.06205
"Planck Collaboration VI. 2019, A&A, in press,"
arXiv:1807.06209
"Poletti, D., Fabbian, G., Le Jeune, M., et al. 2017, A&A,"
"600, A60"
"QUIET Collaboration, Bischoff, C., Brizius, A., et al. 2011,"
"ApJ, 741, 111"
"Rhodes, B. C. 2011, PyEphem: Astronomical Ephemeris for"
"Python, Astrophysics Source Code Library, vv3.7.6.0, , ,"
ascl:1112.014
"Seljak, U., & Zaldarriaga, M. 1997, PhRvL, 78, 2054"
"Spergel, D. N., Verde, L., Peiris, H. V., et al. 2003, ApJS,"
"148, 175"
"Takakura, S., Aguilar, M., Akiba, Y., et al. 2017, JCAP,"
"2017, 008"
"Takakura, S., Aguilar-Faúndez, M. A. O., Akiba, Y., et al."
"2019, ApJ, 870, 102"
"van der Walt, S., Colbert, S. C., & Varoquaux, G. 2011,"
"CSE, 13, 22. https://doi.org/10.1109%2Fmcse.2011.37"
"Virtanen, P., Gommers, R., Oliphant, T. E., et al. 2019,"
"arXiv e-prints, arXiv:1907.10121"
"Watts, D. J., Addison, G. E., Bennett, C. L., & Weiland ,"
"J. L. 2020, ApJ, 889, 130"
"https://doi.org/10.1093/mnras/272.3.551
http://ipython.org
https://doi.org/10.1109%2Fmcse.2011.37"
"
CLASS 40 GHz VPM Demodulation Stability 21"
"Xu, Z., Brewer, M. K., Rojas, P. F., et al. 2020, ApJ, 891,"
"
	1 Introduction
	2 Demodulation
	3 Data Selection and Processing
	3.1 Temperature to Polarization Leakage
	3.2 Power Spectrum Fits"
"	4 Results
	4.1  Modulation Efficiency"
"	5 Sources of Demodulated 1/f Noise
	5.1 Red Noise Amplitudes
	5.2 PWV Dependence
	5.3 Boresight Dependence
	5.4 Comparison with Stare Data"
"	6 Conclusions
	A  Sources of Intensity 1/f Noise"
