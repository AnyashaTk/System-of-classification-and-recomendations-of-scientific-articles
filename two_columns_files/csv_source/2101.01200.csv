text,space_num
                                        Modeling compact binary signals and instrumental glitches in gravitational wave data,40.0
"                                                Katerina Chatziioannou,1, 2, 3 Neil J. Cornish,4 Marcella Wijngaarden,3, 5 and Tyson B. Littenberg6",48.0
                                                      1,54.0
"                                                        Department of Physics, California Institute of Technology, Pasadena, California 91125, USA",56.0
                                                             2,61.0
"                                                               LIGO Laboratory, California Institute of Technology, Pasadena, CA 91125, USA",63.0
                                                   3,51.0
"                                                     Center for Computational Astrophysics, Flatiron Institute, 162 5th Ave, New York, NY 10010, USA",53.0
                                              4,46.0
"                                                eXtreme Gravity Institute, Department of Physics, Montana State University, Bozeman, Montana 59717, USA",48.0
                                              5,46.0
"                                                Mathematical Sciences and STAG Research Centre, University of Southampton, SO17 1BJ, Southampton, UK",48.0
                                                                    6,68.0
"                                                                      NASA Marshall Space Flight Center, Huntsville, AL 35812, USA",70.0
"                                                                                         (Dated: February 9, 2021)",89.0
"                                                        Transient non-Gaussian noise in gravitational wave detectors, commonly referred to as glitches,",56.0
                                                     pose challenges for detection and inference of the astrophysical properties of detected signals when,53.0
                                                     the two are coincident in time. Current analyses aim toward modeling and subtracting the glitches,53.0
"                                                     from the data using a flexible, morphology-independent model in terms of sine-Gaussian wavelets",53.0
                                                     before the signal source properties are inferred using templates for the compact binary signal. We,53.0
arXiv:2101.01200v2 [gr-qc] 8 Feb 2021,0.0
                                                     present a new analysis of gravitational wave data that contain both a signal and glitches by simul-,53.0
                                                     taneously modeling the compact binary signal in terms of templates and the instrumental glitches,53.0
                                                     using sine-Gaussian wavelets. The model for the glitches is generic and can thus be applied to a,53.0
                                                     wide range of glitch morphologies without any special tuning. The simultaneous modeling of the,53.0
"                                                     astrophysical signal with templates allows us to efficiently separate the signal from the glitches, as",53.0
                                                     we demonstrate using simulated signals injected around real O2 glitches in the two LIGO detectors.,53.0
"                                                     We show that our new proposed analysis can separate overlapping glitches and signals, estimate",53.0
"                                                     the compact binary parameters, and provide ready-to-use glitch-subtracted data for downstream",53.0
                                                     inference analyses.,53.0
                                                          I.   INTRODUCTION                               choices for estimating the PSD or treating its uncertainty,58.0
"                                                                                                          can result in different functional forms for the likelihood,",106.0
                                                                                                          but they are all based on the assumption of colored Gaus-,106.0
"                                           During the first half of their third observing run (O3a),",43.0
"                                                                                                          sian noise [9, 10].",106.0
                                        the advanced ground based gravitational wave (GW) de-,40.0
                                        tectors LIGO [1] and Virgo [2] observed an astrophysi-               Since instrumental glitches violate the basic assump-,40.0
"                                        cal transient signal about every 5 days of data [3]. The          tions of GW inference, they need to be effectively miti-",40.0
                                        large detection rate increases the chance of observing an         gated before the data are analyzed. One option is to re-,40.0
"                                        event while one of the detectors experiences transient non        move the offending data all together [4, 11–13], which can",40.0
"                                        Gaussian noise, also known as instrumental glitches. In-          be done quickly, allowing for low latency estimation of",40.0
"                                        deed, this scenario has come to pass for one event from           source parameters that enable followup observations [4].",40.0
                                        the second observing run (O2) [4] and 8 events from the           The downside of this approach is that part of the astro-,40.0
                                        first half of the third observing run [3].                        physical signal is lost making it prohibitive for binary,40.0
                                                                                                          black hole (BBH) signals whose duration is comparable,106.0
"                                           Such coincidences are expected to become even more             to the glitch duration. In order to avoid signal, and thus",43.0
"                                        frequent in the coming years. Planned improvements in             information loss, another option is to model the glitch",40.0
"                                        the detectors’ sensitivity will be directly reflected by an       and regress it from the data, leaving behind not only the",40.0
                                        even larger rate of astrophysical discoveries [5]. More-          astrophysical signal but also the Gaussian noise. This,40.0
"                                        over, O3a was characterized by an increase in the rate            approach is the topic of the current study1 .",40.0
"                                        of glitch occurrence in the two LIGO detectors, a trend",40.0
"                                                                                                             The wide variety of glitch morphologies, and even vari-",109.0
                                        that might persist during the fourth observing run (O4),40.0
"                                                                                                          ations within a certain glitch type, make constructing ex-",106.0
                                        as the decreased average detector noise might help reveal,40.0
                                                                                                          act models for glitches challenging [21]. A more flexible,106.0
                                        weaker sources of transient noise. For example the rate of,40.0
"                                                                                                          approach is based on BayesWave [22, 23] which models",106.0
                                        glitches in the LIGO Livingston detector increased from,40.0
                                                                                                          various components of the GW data in a morphology-,106.0
                                        0.2 per minute in O2 to 0.8 per minute in O3a [3].,40.0
                                                                                                          independent way. Non-Gaussian features in the data,106.0
                                           The presence of a non Gaussian noise feature in the            are modeled in terms of sums of sine-Gaussian wavelets,43.0
"                                        data, a glitch, poses challenges for nearly all inference         whose number and parameters are marginalized over with",40.0
                                        analyses. GW inference is based on a model for the de-,40.0
"                                        tector noise, expressed through the likelihood function.",40.0
"                                        In the absence of glitches, detector noise is colored and",40.0
"                                        Gaussian to a very good approximation [6], with a spec-           1   An independent effort to mitigate the effect of broadband and/or",40.0
                                        trum that is described through the noise power spectral               nonstationary detector noise is based on information from auxil-,40.0
                                        density (PSD). The above considerations give rise to a                iary sensors [14–20]. This approach does not remove entire data,40.0
                                        Gaussian likelihood function whose variance is the noise              segments either and thus is not expected to lead to loss of infor-,40.0
"                                        PSD, a choice that is almost ubiquitous [7, 8]. Different             mation.",40.0
avr_spaces,54.19178082191781
                                                                                                                         2,121.0
a suite of Markov Chain Monte Carlo (MCMC) and Re-            models exist for CBCs in terms of solutions to the Ein-,0.0
versible Jump MCMC (RJMCMC) [24] samplers. Coher-             stein field equations that are routinely used both for de-,0.0
ent features (i.e. features that appear in all detectors in a tection and parameter estimation. In this paper we take,0.0
manner consistent with an astrophysical signal originat-      another step toward efficient separation of CBCs and,0.0
ing from a specific sky location) are modeled by a single     glitches by constructing an analysis that simultaneously,0.0
sum of wavelets that is projected onto the detector net-      models the CBC signal in terms of CBC templates and,0.0
work; these features are interpreted as having an astro-      the glitch in terms of sine-Gaussian wavelets. Similar to,0.0
physical origin. Incoherent features are instead modeled      the initial glitch-only analysis and the subsequent sig-,0.0
"by independent sums of wavelets in each GW detector           nal+glitch analysis, we also model and marginalize over",0.0
and are interpreted as instrumental glitches. The PSD         the detector noise PSD. We test our analysis using public,0.0
of the Gaussian noise is also modeled in terms of splines     O2 data that contain common glitch types and simulated,0.0
and Lorentzians using an algorithm sometimes known as         CBC signals. We demonstrate that we can efficiently sep-,0.0
"BayesLine [6, 25]. BayesWave and BayesLine are fully          arate the glitch from the CBC, estimate the CBC param-",0.0
"integrated and we will refer to the combined analysis with    eters, and provide ready-to-use glitch-subtracted data for",0.0
the name BayesWave in this paper.                             downstream inference analyses.,0.0
   Modeling instrumental glitches with BayesWave and             The rest of the paper is organized as follows. In Sec. II,3.0
subtracting them from the data in order to make ready-        we describe the updates to the standard BayesWave algo-,0.0
to-use data for downstream inference has been a stan-         rithm in terms of the CBC analysis. In Sec. III we apply,0.0
"dard step of LIGO/Virgo analyses since O2 [3, 4]. The         our analysis to simulated signal overlapping with known",0.0
GW signal from the first binary neutron star (BNS)            detector glitches from O2 data. In Sec. IV we analyze,0.0
"coalescence detection, GW170817, overlapped with a            a selection of detected signals, namely GW170817 and",0.0
"glitch in the LIGO Livingston detector approximately          GW150914. Finally, in Sec. V we conclude and point to",0.0
1.1s before coalescence [4]. The glitch was modeled with      future work.,0.0
BayesWave’s glitch model in terms of a sum of wavelets,0.0
"and removed from the data, a procedure documented and",0.0
released in [26]. Despite the glitch overlapping with the        II.   GENERAL ALGORITHM DESCRIPTION,0.0
"actual astrophysical signal, the subtraction process was",0.0
robust against inadvertently removing the signal together        The combined BayesWave algorithm is presented in de-,0.0
with the glitch. The reason is that the specific glitch was   tail in [23] and here we describe only the features relevant,0.0
"short in duration (less than a second) and extended in        to our study. BayesWave simultaneously models signals,",0.0
"frequency, unlike the signal that lasted for about 2 min-     glitches, and Gaussian noise in GW data by means of",0.0
"utes in the detector sensitive band. As such, the sine-       different models. The signal model describes astrophysi-",0.0
Gaussian wavelets that would fit the glitch and the signal    cal signals through a sum of Morlet Gabor wavelets that,0.0
are distinct in terms of their time-frequency features; the   are coherent across the detector network. The number,0.0
wavelets that model the glitch are short and hence do         of wavelets and the parameters of each are marginalized,0.0
"not model the long-lasting BNS signal. This procedure         over, as are the extrinsic parameters that determine how",0.0
was further shown to not introduce biases in the astro-       the signal is projected in each detector. The glitch model,0.0
physical parameter inference of the underlying signal by      describes instrumental glitches with an incoherent sum,0.0
analyzing simulated signals injected on instances of the      of Morlet Gabor wavelets whose number and parameters,0.0
same glitch type in LIGO Livingston data [27].                are again marginalized over. Glitch power in each detec-,0.0
   Motivated by the success of this first attempt at glitch   tor is described by an independent sum of such wavelets.,3.0
mitigation and in preparation for the increased detection     The noise model describes the Gaussian noise PSD with,0.0
"rate of O3, BayesWave was extended to be able to si-          a broadband spline model and sharp Lorentzians. As",0.0
"multaneously model both the signal and the glitch [23].       above, the number of spline points and Lorentzians as",0.0
Both signals and glitches are modeled with a sum of sine-     well as their parameters are marginalized over.,0.0
"Gaussian wavelets, the only difference being that the sig-       In order to sample the multidimensional posterior den-",0.0
"nal is coherent across the detectors in the network, while    sity of all models, BayesWave uses a blocked Gibbs sam-",0.0
the glitch is not. The analysis effectively uses data from    pler that takes turns between sampling each model with,0.0
all detectors available to determine which part of the non    completely independent MCMC or RJMCMC samplers.,0.0
Gaussian data are coherent (and would thus correspond         This includes (i) an RJMCMC that samples the signal,0.0
"to an astrophysical signal), and which part is incoherent     and glitch wavelet parameters, (ii) an MCMC that sam-",0.0
"(and would thus correspond to an instrumental glitch).        ples the signal extrinsic parameters, and (iii) an RJM-",0.0
The combined signal+glitch analysis was applied to one        CMC that samples the splines and Lorentzians for the,0.0
"O3a detection [3], enabling glitch mitigation even for data   noise PSD. Each sampler in turn updates its parame-",0.0
"that contained short-duration BBH signals.                    ters for a predetermined number of iterations, typically",0.0
"   The signal+glitch analysis models compact binary co-       O(102 ), while all other parameters are kept fixed. For ex-",3.0
"alescence (CBC) signals in terms of wavelets, and is thus     ample, the extrinsic sampler updates the extrinsic signal",0.0
"agnostic to the signal morphology. However, accurate          parameters while the wavelet parameters and noise PSD",0.0
avr_spaces,2.1666666666666665
                                                                                                                              3,126.0
are kept constant. Once the predetermined number of                 sampler [30] has been developed for analyzing data from,0.0
"updates has been reached, the extrinsic sampler returns             the future Laser Interferometer Space Antenna. The",0.0
its current parameters and the noise sampler begins up-             CBC sampler is a replica exchange (parallel tempered),0.0
dating the noise model while keeping the wavelet and                Markov Chain Monte Carlo (PTMCMC) algorithm that,0.0
extrinsic parameters fixed. This process of alternating             uses a mixture of proposal distributions. The default,0.0
sampling between different blocks of model parameters               collection of proposals are: Gaussian jumps along eigen-,0.0
"is repeated for O(104 ) iterations.                                 vectors of the Fisher information matrix, scaled by the",0.0
    The construction of the algorithm in terms of a blocked         reciprocal of the square root of the corresponding eigen-,4.0
Gibbs sampler makes adding further models and sam-                  value; differential evolution using a rolling history array,0.0
"plers straightforward. In the current version described             at each temperature, updated every 10 iterations and",0.0
"in [23], the astrophysical signal is modeled with coherent          holding 1000 past samples; and small, Gaussian jumps",0.0
sine-Gaussian wavelets that allow us to describe signals            along each parameter direction. Each chain carries its,0.0
"with a large level of flexibility. We extend BayesWave’s            own Fisher information matrix, which is updated peri-",0.0
"blocked Gibbs sampler by adding one more element,                   odically. The Fisher and differential evolution proposals",0.0
"namely a model of the signal in terms of quasicircular              are effective at exploring parameter correlations, while",0.0
CBC waveforms. In fashion with the existing implemen-               the small jumps prevent the chains from getting stuck in,0.0
"tation, the MCMC that samples the posterior distribu-               regions where the Fisher matrix becomes ill-conditioned.",0.0
tion for the CBC parameters is completely independent                  The CBC sampler is not optimized for blindly find-,0.0
"from the remaining code samplers. The result is a flexi-            ing signals, so it is best to initialize the sampler with",0.0
ble algorithm that can be used with any combination of              a good starting solution for the source parameters such,0.0
"CBC, signal2 , glitch, and noise models for the detector            as the output from a CBC search pipeline, or the in-",0.0
data.                                                               jected parameters for a simulated signal. Alternatively,0.0
    The CBC model is integrated with LALSimulation [28]             the sampler can be initialized using a custom built CBC,4.0
and can operate with any nonprecessing model available              search algorithm from the QuickCBC [29] analysis pipeline,0.0
there3 . The eleven parameters of a spin-aligned quasicir-          that has been incorporated into the BayesWave prepro-,0.0
"cular CBC signal, namely the four intrinsic parameters              cessing steps. The search is broken into two stages, a",0.0
(the two masses and spin magnitudes) and seven extrin-              rapid network-coherent search with analytic maximiza-,0.0
"sic parameters (the time of coalescence, the phase of co-           tion over extrinsic parameters, followed by a fast MCMC",0.0
"alescence, two sky location angles, the polarization angle          over the extrinsic parameters using a likelihood function",0.0
"and the inclination angle the distance), are updated in             that precomputes the waveform inner products [31]. This",0.0
overlapping blocks. Common to both blocks is the phase              procedure returns the starting point for all 11 CBC pa-,0.0
of coalescence since BayesWave’s extrinsic sampler up-              rameters. More details about the initial search step and,0.0
dates the overall phase of the signal as described in [23].         discussion of its robustness against instrumental glitches,0.0
The CBC MCMC sampler updates the four intrinsic pa-                 are presented in [29].,0.0
"rameters, the time of coalescence, the phase of coales-",0.0
"cence, and the distance. The existing extrinsic sampler",0.0
"in BayesWave updates the two sky angles, the polariza-",0.0
"tion angle, the inclination angle, and the phase of co-                          III.   SIMULATED SIGNALS",0.0
alescence while holding all other parameters fixed. We,0.0
use standard priors for all parameters: uniform over the,0.0
                                                                       We test the efficacy of separating CBCs from glitches,71.0
"detector-frame masses and spin magnitudes, uniform in",0.0
                                                                    with our CBC+glitch model by selecting 3 common glitch,68.0
"time and phase, and uniform in luminosity volume.",0.0
"                                                                    types from O2 data [32, 33] that are known to have an",68.0
    The CBC sampler is custom and not based on any,4.0
                                                                    adverse effect on searches for CBCs [3]. We then add sim-,68.0
existing samplers used in LIGO-Virgo parameter estima-,0.0
                                                                    ulated CBC signals consistent with a BBH with detector-,68.0
tion. The CBC sampler is taken from the recently devel-,0.0
                                                                    frame masses of 36M and 29M and vanishing spin at,68.0
oped QuickCBC [29] analysis pipeline. A closely related,0.0
                                                                    different times with respect to the glitch. All simulated,68.0
                                                                    signals have a signal-to-noise (SNR) ratio of 15. We use,68.0
"                                                                    the IMRPhenomD [34, 35] waveform model both for simula-",68.0
 2                                                                  tion and recovery as implemented in LALSimulation [28].,1.0
"   We retain the original model names in BayesWave, hence the",3.0
"   signal model refers to the wavelet signal model, while the CBC   We then analyze the data from the two LIGO detectors",3.0
"   model refers to the model in terms of CBC templates. Both        with our CBC+glitch+noise model, where the coherent",3.0
"   models target astrophysical signals. Since we do not use the     signal is modeled by the CBC template, the glitch is mod-",3.0
"   signal model in the remainder of the paper, we trust that this   eled by incoherent wavelets, and the noise PSD is mod-",3.0
   will not lead to confusion.,3.0
 3                                                                  eled with splines and Lorenzians. Spectrograms for the 3,1.0
   Both the sampling and the jump proposals for the CBC param-,3.0
"   eters are constructed to expect the signal amplitude and phase   glitches are shown in Fig. 1: blip glitch (left), scattered",3.0
"   from the waveform generator. There is therefore no fundamental   light (middle), and blue mountain (right). Further de-",3.0
   limitation to non-precessing signals and we plan to extend our   tails and run settings for each type of glitch are shown in,3.0
   analysis to include the effect of spin-precession in the future. Table I.,3.0
avr_spaces,11.257142857142858
                                                                                                                                                                                                                                                                                                      4,294.0
                                                                          100                                100                                                             30                                                                                              30,74.0
                                                                                                                                                                             25                                                                                              25,173.0
                                                                                Normalized energy                                                                                 Normalized energy                                                                               Normalized energy,80.0
           500                                                            80,11.0
                                                                                                              50,110.0
                                                                                                                                                                             20                                                                                              20,173.0
                                                                                                                                                                                                               100,207.0
  f (Hz)                                                                                            f (Hz)                                                                                            f (Hz),2.0
                                                                          60,74.0
                                                                                                                                                                             15                                                                                              15,173.0
                                                                          40,74.0
           100                                                                                                                                                               10                                                                                              10,11.0
                                                                          20                                                                                                 5                                                                                               5,74.0
            50,12.0
                                                                                                              10                                                                                                10,110.0
                                                                          0                                                                                                  0                                                                                               0,74.0
                 -0.04   0   0.04 0.08 0.12 0.16   0.2   0.24 0.28 0.32                                            0   0.8    1.6   2.4   3.2   4    4.8   5.6   6.4   7.2                                           0   0.8   1.6   2.4   3.2   4   4.8   5.6   6.4   7.2,17.0
                         t (s) from GPS 1168989748                                                                           t (s) from GPS 1172917776                                                                         t (s) from GPS 1165069533,25.0
"FIG. 1. Spectrograms for the three glitches of different types studied here: blip glitch (left), scattered light (middle), blue",0.0
mountain (right). The three types of glitches are characterized by very different time-frequency properties.,0.0
                                                                           Segment Sampling,75.0
                                           Glitch                GPS time (s) Detector         f (Hz) Qmax CBC SNR,43.0
                                                                          length (s) rate (Hz) low,74.0
                                         Blip       1168989748 Hanford         4       2048      16     40   15,41.0
                                    Scattered light 1172917779 Livingston      8       2048       8    160   15,36.0
                                    Blue mountain 1165069536 Hanford          16       2048      16     40   15,36.0
"TABLE I. Settings for the runs of Sec. III. From left to right, columns correspond to the type of glitch, the GPS time, the",0.0
"affected detector, the segment length, the sampling rate, to low frequency cut off, the maximum quality factor of the glitch",0.0
"wavelets, and the SNR of the injected signals.",0.0
"                                 A.       Glitch type 1: Blip                                                                                       frame chirp mass M, while Fig. 4 shows the luminos-",33.0
                                                                                                                                                    ity distance and the cosine of the inclination angle. In,148.0
                                                                                                                                                    all cases the posterior distributions recovered under the,148.0
   Blip glitches are one of the most common glitch types,3.0
                                                                                                                                                    CBC+glitch+noise model are consistent with the in-,148.0
for the two LIGO detectors. They are characterized by,0.0
"                                                                                                                                                    jected parameters, though the marginalized posteriors do",148.0
"short duration, and hence pose a challenge for the de-",0.0
"                                                                                                                                                    not peak at the injected values, as expected from infer-",148.0
tection of high mass BBH signals [36]. Their origin is,0.0
"                                                                                                                                                    ence of signals in Gaussian noise. For reference, we show",148.0
largely unknown. Figures 2-5 show our results for sim-,0.0
                                                                                                                                                    posteriors under the CBC+noise model in orange that,148.0
ulated signals injected at different times with respect to,0.0
                                                                                                                                                    assumes that the data are consisted of just a CBC signal,148.0
a blip glitch in the LIGO Hanford detector during O2.,0.0
"                                                                                                                                                    and Gaussian noise, without any provision for a glitch.",148.0
"Details about the glitch, including its GPS time, and the",0.0
                                                                                                                                                    Since this assumption is violated by the presence of the,148.0
run settings are presented in Table I. A spectrogram of,0.0
"                                                                                                                                                    blip glitch, the resulting posteriors are expected to be",148.0
the data containing the glitch is given on the left panel,0.0
                                                                                                                                                    biased compared to the true parameters and the orange,148.0
"of Fig. 1, where the short duration and large frequency",0.0
                                                                                                                                                    contours in Figs. 3 and 4 quantify this bias. We find that,148.0
extent are shown.,0.0
                                                                                                                                                    the extrinsic parameters that are primarily determined,148.0
   The whitened data and reconstructions for the CBC                                                                                                by the signal amplitude are more biased than the intrin-,3.0
"signal and the glitch are shown in Fig. 2 where we plot the                                                                                         sic ones that are measured through the GW phase, as",0.0
90% credible intervals for each reconstruction in LIGO                                                                                              also discussed in [37].,0.0
Hanford (top) and LIGO Livingston (bottom). The,0.0
glitch is easily visible in LIGO Hanford as a short dura-,0.0
tion ∼ 15σ noise excursion. No glitch power is identified                                                                                              The separation of the CBC signal from the glitch,0.0
"in LIGO Livingston at that time, but the CBC signal is                                                                                              demonstrated in Fig. 2 can be used to produce ready-to-",0.0
"clearly identified. This allows us to separate the corre-                                                                                           use deglitched data for downstream inference analyses, as",0.0
sponding coherent CBC signal in LIGO Hanford from the                                                                                               was done in [3]. An estimate of the glitch reconstruction,0.0
"instrumental glitch, even when the latter overlaps with                                                                                             (the median or a fair draw from the glitch model poste-",0.0
the merger phase of the signal (left panel). The glitch re-                                                                                         rior) is subtracted from the data to produce strain data,0.0
construction is also consistent across the three simulated                                                                                          that contain only the CBC signal and Gaussian noise.,0.0
"signals, suggesting that the glitch model is not fitting any                                                                                        The result of the glitch subtraction is shown in the spec-",0.0
part of the CBC signal.                                                                                                                             trograms of Fig. 5 that show the LIGO Hanford data,0.0
  Source parameters for the simulated CBC are pre-                                                                                                  before (left) and after (middle) the subtraction of a fair,2.0
sented in Figs. 3 and 4 both for the CBC+glitch+noise                                                                                               draw glitch reconstruction for the leftmost injection of,0.0
analysis and a CBC+noise analysis for selected recov-                                                                                               Fig. 2. The left panel includes both the chirping signal,0.0
"ered parameters for the leftmost simulated CBC sig-                                                                                                 and the blip glitch, while only the former is visible in the",0.0
nal together with the injected values with black crosses                                                                                            middle panel. The right panel shows the data after a fair,0.0
or vertical lines as appropriate. Figure 3 shows the                                                                                                draw from both the CBC and the glitch models has been,0.0
"mass ratio q, the effective spin χeff , and the detector                                                                                            subtracted, resulting in residual Gaussian noise only.",0.0
avr_spaces,52.9873417721519
                                                                                                                                                                                                                                        5,232.0
           5                                                                            5                                                                             5,11.0
           0                                                                            0                                                                             0,11.0
σnoise,0.0
          −5                                                                        −5                                                                           −5,10.0
         −10                                                                        −10         Data                                                             −10,9.0
                                                                                                CBC,96.0
         −15        LIGO Hanford                                                    −15                                                                          −15,9.0
                                                                                                Glitch,96.0
           4                                                                            4                                                                             4,11.0
           2                                                                            2                                                                             2,11.0
 σnoise    0                                                                            0                                                                             0,1.0
          −2                                                                        −2                                                                           −2,10.0
                    LIGO Livingston,20.0
          −4                                                                        −4                                                                           −4,10.0
                −0.08     −0.06     −0.04   −0.02       0.00   0.02   0.04   0.06           −0.08   −0.06    −0.04      −0.02    0.00       0.02   0.04   0.06            −0.08   −0.06   −0.04   −0.02   0.00     0.02   0.04   0.06,16.0
                             t (s) from GPS 1168989748.125                                               t (s) from GPS 1168989748.125                                              t (s) from GPS 1168989748.125,29.0
FIG. 2. Credible intervals for the glitch (orange) and the CBC (blue) signal reconstruction for data containing a blip glitch,0.0
in LIGO Hanford and a simulated CBC signal at 3 different times with respect to the glitch (left to right). Shaded regions,0.0
"correspond to 90% credible intervals for the whitened reconstruction, while in grey dashed lines we plot the data whitened with",0.0
a fair draw PSD from our noise model posterior. The top row corresponds to LIGO Hanford and the bottom row corresponds,0.0
to LIGO Livingston.,0.0
                6,16.0
                        CBC+glitch+noise,24.0
                        CBC+noise                                                                                                         1400,24.0
                4,16.0
                2                                                                                                                         1200,16.0
                0,16.0
                                                                                                                                D (Mpc),128.0
                    0.4      0.6      0.8   1.0                                                                                           1000,20.0
               30,15.0
                                                  0.6,50.0
     M (M )    28,5.0
                                                  0.4,50.0
                                                                                                                                           800,139.0
               26                                 0.2                                                                                      600,15.0
               24                               0.0,15.0
                    0.4      0.6      0.8   1.0    24          26     28     30,20.0
           0.4                                  0.4                                                                                        400,11.0
                                                                                    6                                                              CBC+glitch+noise,84.0
           0.2                                    0.2                                                                                              CBC+noise,11.0
χeff       0.0                                    0.0                               4                                                      200,0.0
                                                                                                                                            −1.00 −0.75 −0.50 −0.25                       0.00     0.25          0.50     0.75    1.00,140.0
          −0.2                                −0.2                                  2,10.0
                                                                                                                                                                                      cos(ι),182.0
          −0.4                                −0.4                                  0,10.0
                    0.4      0.6      0.8   1.0   24           26     28     30     −0.4 −0.2 0.0           0.2   0.4,20.0
                                q                              M (M )                               χeff,32.0
                                                                                                                                FIG. 4. Two-dimensional posterior distributions for the lu-,128.0
                                                                                                                                minosity distance and the binary inclination of the simulated,128.0
FIG. 3. One- and two-dimensional posterior distributions for                                                                    signal from the left panel of Fig. 2 injected on top of a LIGO,0.0
"selected source parameters of the simulated signal from the                                                                     Hanford blip glitch. A black cross at (1,1200Mpc) denotes",0.0
left panel of Fig. 2 injected on top of a LIGO Hanford blip                                                                     the true parameters of the injection. Blue (orange) contours,0.0
"glitch. We include the mass ratio q, the effective spin χeff ,                                                                  correspond to the CBC+glitch+noise (CBC+noise) run.",0.0
"and the detector frame chirp mass M posteriors, while black",0.0
crosses or black vertical lines denote the true parameters of,0.0
the injection. Blue (orange) contours and lines correspond to,0.0
the CBC+glitch+noise (CBC+noise) run.                                                                                           power we extend our analysis duration and bandwidth.,0.0
                                                                                                                                The longer duration helps the noise model determine the,128.0
                                                                                                                                low-frequency Gaussian noise PSD and thus separate the,128.0
                                                                                                                                low frequency part of the glitch from Gaussian noise. We,128.0
                          B.        Glitch type 2: Scattered light                                                              also increase the maximum quality factor Qmax of the,26.0
                                                                                                                                wavelets due to the glitch’s long duration.,128.0
  Glitches caused by scattered light in the interferome-                                                                           Figure 6 shows the data and reconstructed CBC and,2.0
"ter became particularly prominent during O3 [3]. Unlike                                                                         glitch models. We zoom in around the CBC signals,",0.0
"the blip glitches studied above, scattered light glitches                                                                       though the glitch extends beyond the time range plotted.",0.0
"have a longer temporal duration of a few seconds and                                                                            In all cases the CBC signal is separated from the glitch,",0.0
are characterized by arches in a time-frequency spectro-                                                                        aided by the presence of a coherent signal in LIGO Han-,0.0
"gram [38, 39], as depicted in the middle panel of Fig. 1.                                                                       ford. The glitch reconstruction is also consistent for all 3",0.0
"We inject simulated signals on an instance of such a glitch                                                                     simulated signals, as expected for runs on the same glitch.",0.0
in LIGO Livingston and analyze the data from both                                                                               The reconstruction exhibits oscillations at around 32Hz,0.0
"LIGO detectors with our CBC+glitch+noise model. De-                                                                             and 16Hz, consistent with expectations from the glitch",0.0
tails of the glitch and the run settings are given in Table I.                                                                  spectrogram. Figure 7 shows posterior distributions for,0.0
Due to the duration of the glitch and its low frequency                                                                         selected source parameters for the left-most injection in,0.0
avr_spaces,32.626666666666665
                                                                                                                                                                                                                                                                                                     6,293.0
                                                                         100                                                                                              100                                                                                              100,73.0
                                                                               Normalized energy                                                                                Normalized energy                                                                                Normalized energy,79.0
                                                                         80                                                                                               80                                                                                               80,73.0
  f (Hz)                                                                                           f (Hz)                                                                                           f (Hz),2.0
                                                                         60                                                                                               60                                                                                               60,73.0
           100                                                                                              100                                                                                              100,11.0
                                                                         40                                                                                               40                                                                                               40,73.0
            50                                                           20                                  50                                                           20                                  50                                                           20,12.0
                                                                         0                                                                                                0                                                                                                0,73.0
             0.8   0.84 0.88 0.92 0.96   1   1.04 1.08 1.12 1.16   1.2                                        0.8   0.84 0.88 0.92 0.96   1   1.04 1.08 1.12 1.16   1.2                                        0.8   0.84 0.88 0.92 0.96   1   1.04 1.08 1.12 1.16   1.2,13.0
                      t (s) from GPS 1168989747.125                                                                    t (s) from GPS 1168989747.125                                                                    t (s) from GPS 1168989747.125,22.0
FIG. 5. Spectrogram of the LIGO Hanford data around the time of the blip glitch for the leftmost injection from Fig. 2. Left,0.0
panel: data containing the blip glitch and the simulated CBC signal. Middle panel: data after a fair draw from the glitch,0.0
model has been subtracted leaving behind only the chirping CBC signal. Right panel: data after a fair draw from the glitch,0.0
"and CBC models has been subtracted, leaving behind only Gaussian detector noise.",0.0
"blue, as well as the injected parameters. In all cases the                                                                                     expected from the glitch spectrogram, the glitch is char-",0.0
"recovered parameters are consistent with their injected                                                                                        acterized by a series of short high frequency bursts, each",0.0
"values. In orange, we plot results from a CBC+noise run                                                                                        of which is modeled by different wavelets within our glitch",0.0
"and find small biases in the source intrinsic parameters,                                                                                      model. Figure 10 shows posterior distributions for se-",0.0
most notably the mass ratio.                                                                                                                   lected source parameters for the left-most injection in,0.0
"   Finally, Fig. 8 shows the spectrogram of the data be-                                                                                       blue, as well as the injected parameters. In all cases the",3.0
fore and after various components of the model have been                                                                                       recovered parameters are consistent with their injected,0.0
"subtracted from the data. The left panel corresponds to                                                                                        values, suggesting that the presence of the glitch does",0.0
data that contain both a signal and the glitch and thus                                                                                        not incur biases on the inferred source properties if the,0.0
"both the signal chirp and the characteristic glitch arches                                                                                     two are modeled simultaneously. As before, we also plot",0.0
are visible. In the middle panel we plot data after a                                                                                          results from a CBC+noise run that neglects the glitch,0.0
"fair draw from the glitch model has been subtracted, re-                                                                                       in the data in orange and again find small biases by the",0.0
sulting in both the high and the low frequency arches of                                                                                       presence of the glitch in the source intrinsic parameters.,0.0
"the glitch having been regressed, leaving only the chirp-                                                                                         The glitch subtraction process is detailed in Fig. 11",0.0
ing signal behind. The right panel corresponds to data                                                                                         that again shows spectrograms of the original data con-,0.0
"where a fair draw from the CBC model has further been                                                                                          taining both the glitch and the signal (left), data after a",0.0
"subtracted and is consistent with Gaussian noise.                                                                                              fair draw glitch model has been subtracted (middle), and",0.0
                                                                                                                                               data after both the glitch and the fair draw CBC model,143.0
"                                                                                                                                               have been removed (right). As before, data from the mid-",143.0
                      C.       Glitch type 3: Blue mountain                                                                                    dle panel could be used for further data processing. The,22.0
                                                                                                                                               right panel shows data where a model for both the glitch,143.0
                                                                                                                                               and the CBC have been subtracted. Even though the ma-,143.0
   The final type of glitch we consider is the blue moun-                                                                                      jority of the glitch power is absent (compare the left and,3.0
"tain; the spectrogram of the LIGO Hanford instance of                                                                                          right panels), some small non Gaussian power might be",0.0
a blue mountain glitch we consider is shown in the right                                                                                       left behind. The reason for this is that the blue mountain,0.0
panel of Fig. 1. The glitch has a duration of multiple sec-                                                                                    glitch is manifested as individual short bursts of glitch,0.0
"onds and is characterized by higher frequencies ∼ 200Hz.                                                                                       power, which our flexible analysis attempts to model",0.0
"We inject simulated signals at different times relative to                                                                                     completely independently. Indeed, the glitch model for",0.0
"the glitch and again analyze data from the two LIGO de-                                                                                        this run uses O(70) wavelets. Each of these wavelets,",0.0
tectors with the CBC+glitch+noise model with settings                                                                                          needs to model sufficient non-Gaussian power in the data,0.0
shown in Table I. Due to the large glitch duration we                                                                                          in order to overcome the parsimony penalty incurred by,0.0
"have to increase the length of the analyzed segment even                                                                                       adding more parameters to the model. As such, we ex-",0.0
"further to 16s. Despite the glitch’s overall long duration,                                                                                    pect that some of the weaker “bursts” of the glitch will",0.0
we do not find it necessary to increase the wavelet max-                                                                                       not be recovered. Possible ways to alleviate this are dis-,0.0
"imum quality factor Qmax , as the glitch is composed of                                                                                        cussed in Sec. V.",0.0
"short individual bursts of power, each of which is mod-",0.0
eled by individual wavelets with a small quality factor.,0.0
   Figure 9 shows the whitened data and credible inter-,3.0
vals for the whitened CBC and glitch reconstruction in                                                                                                   IV.        GRAVITATIONAL WAVE EVENTS,0.0
each detector for each of the injected signals. Due to the,0.0
"large glitch duration, the signals are injected sufficiently                                                                                     As a further demonstration of our CBC+glitch+noise",0.0
"wide apart that the reconstruction plots show non over-                                                                                        model, we also analyze two astrophysical events,",0.0
lapping parts of the data and the glitch. The glitch re-                                                                                       GW170817 [4] and GW150914 [40] whose data are avail-,0.0
"constructions are therefore not expected to match. As                                                                                          able from GWOSC [32, 33]. Though not the main focus",0.0
avr_spaces,22.950819672131146
                                                                                                                                                                          7,170.0
          2                                                             2                                                2,10.0
σnoise    0                                                             0                                                0,0.0
         −2                                 LIGO Hanford            −2                                                  −2    Data        CBC      Glitch,9.0
          2                                                             2                                                2,10.0
σnoise    0                                                             0                                                0,0.0
         −2                                 LIGO Livingston         −2                                                  −2,9.0
                   −0.2                 0.0              0.2                 −0.2                0.0              0.2          −0.2               0.0               0.2,19.0
                          t (s) from GPS 1172917779.7                               t (s) from GPS 1172917779.7                       t (s) from GPS 1172917779.7,26.0
FIG. 6. Credible intervals for the glitch (orange) and the CBC (blue) signal reconstruction for data containing a scattered light,0.0
glitch in LIGO Livingston and a simulated CBC signal at 3 different times with respect to the glitch (left to right). Shaded,0.0
"regions correspond to 90% credible intervals, while in grey dashed lines we plot the data whitened with a fair draw PSD from",0.0
our noise model posterior. The top row corresponds to LIGO Hanford while the bottom row corresponds to LIGO Livingston.,0.0
               4   CBC+glitch+noise                                                               and subtracted. Analysis of simulated signals suggests,15.0
                   CBC+noise,19.0
"                                                                                                  that this procedure leads to unbiased inference, while",98.0
               2,15.0
                                                                                                  any analysis on data that contain the glitch results in,98.0
                                                                                                  highly biased source parameters [27]. Both versions of,98.0
               0,15.0
              30,14.0
                 0.4    0.6     0.8   1.0,17.0
                                            0.6,44.0
"                                                                                                  the data are publicly available, both with and without",98.0
"                                                                                                  the glitch [26], so we analyze them both with different",98.0
     M (M )   28                            0.4,5.0
                                                                                                  models. We use data from the LIGO Hanford and the,98.0
              26                            0.2                                                   LIGO Livingston detectors and analyze 64s of data from,14.0
           24,11.0
              0.4       0.6     0.8   1.0,14.0
                                         0.0,41.0
                                            24      26   28    30,44.0
                                                                                                  16Hz to 2048Hz using the IMRPhenomD NRTides wave-,98.0
          0.4                            0.4                        6                             form model that includes finite-size effects [41]. We em-,10.0
          0.2                            0.2                        4                             ploy our CBC+glitch+noise model on the data with the,10.0
χeff      0.0                            0.0                                                      glitch and the CBC+noise model on data where the glitch,0.0
                                                                    2,68.0
         −0.2                           −0.2,9.0
                                                                                                  has already been subtracted. For the CBC+glitch+noise,98.0
         −0.4                           −0.4                        0,9.0
              0.4       0.6     0.8   1.0 24        26   28    30   −0.4 −0.2 0.0    0.2   0.4    case we use GlitchBuster [23] to provide a quick fit to,14.0
                           q                       M (M )                    χeff,27.0
                                                                                                  the glitch and use that as a starting point for our glitch,98.0
                                                                                                  model during sampling.,98.0
FIG. 7. One- and two-dimensional posterior distribution for                                          Credible intervals for the signal and glitch reconstruc-,0.0
selected source parameters of the simulated signal from the                                       tions are shown in Fig. 12 for each detector for ∼ 150ms of,0.0
"left panels of Fig. 6 injected on top of a LIGO Livingston scat-                                  data around the glitch. Despite its high SNR, GW170817",0.0
"tered light glitch. We include the mass ratio q, the effective                                    had a relatively low amplitude, so the LIGO Hanford",0.0
"spin χeff , and the detector frame chirp mass M posteriors,                                       plot has been zoomed in to make the signal visible. The",0.0
while black crosses or black vertical lines denote the true pa-,0.0
"                                                                                                  LIGO Livingston data are dominated by the glitch, peak-",98.0
rameters of the injection. Blue (orange) contours and lines,0.0
correspond to the CBC+glitch+noise (CBC+noise) run.,0.0
                                                                                                  ing at ∼ 150σ relative to the background detector Gaus-,98.0
                                                                                                  sian noise. The signal is not visible in the LIGO Liv-,98.0
                                                                                                  ingston data given the plotting scale. Figure 13 shows,98.0
                                                                                                  selected source parameters obtained from data both with,98.0
"of this paper, the analysis presented below also provides",0.0
"                                                                                                  and without the glitch. We find consistent results, show-",98.0
an estimate of the effect of marginalizing over the noise,0.0
                                                                                                  ing that our combined CBC+glitch+noise analysis can,98.0
PSD has on the inferred astrophysical parameters. More,0.0
                                                                                                  faithfully fit the CBC signal and the glitch simultane-,98.0
details about this effect will be presented in a separate,0.0
"                                                                                                  ously, without the need for the two step process of first",98.0
study.,0.0
                                                                                                  removing the glitch and then reanalyzing the data.,98.0
                                      A.          GW170817                                                               B.    GW150914,38.0
  Perhaps the most known instance of a GW signal over-                                               The first GW signal directly detected by the LIGO,2.0
"lapping with an instrumental glitch is GW170817 [4].                                              detectors, GW150914 [40], did not overlap with an in-",0.0
"Inference on the GW170817 source properties is per-                                               strumental glitch [42]. However, since it is one of the",0.0
"formed on data where the glitch in LIGO Livingston                                                best studied and loudest signals, we select it as a demon-",0.0
has been modeled with BayesWave’s glitch-only model                                               stration of our analysis on data without glitches. Our,0.0
avr_spaces,36.054054054054056
                                                                                                                                                                                                                                                                                                                                  8,322.0
                  100                                                                   30                                100                                                                     30                                100                                                                  30,18.0
                                                                                        25                                                                                                        25                                                                                                     25,88.0
                                                                                             Normalized energy                                                                                         Normalized energy                                                                                      Normalized energy,93.0
                   60                                                                                                      60                                                                                                        60,19.0
                                                                                        20                                                                                                        20                                                                                                     20,88.0
                   40                                                                                                      40                                                                                                        40,19.0
         f (Hz)    30                                                                   15,9.0
                                                                                                                 f (Hz)    30                                                                     15,113.0
                                                                                                                                                                                                                           f (Hz)    30                                                                  15,219.0
                   20                                                                   10                                 20                                                                     10                                 20                                                                  10,19.0
                                                                                        5                                                                                                         5                                                                                                      5,88.0
                   10                                                                   0                                  10                                                                     0                                  10                                                                  0,19.0
                    0.3     0.45   0.6   0.75   0.9   1.05   1.2   1.35    1.5   1.65                                       0.3    0.45   0.6   0.75   0.9   1.05     1.2    1.35    1.5   1.65                                       0.3    0.45   0.6   0.75   0.9   1.05   1.2   1.35    1.5   1.65,20.0
                                   t (s) from GPS 1172917778.7                                                                            t (s) from GPS 1172917778.7                                                                               t (s) from GPS 1172917778.7,35.0
FIG. 8. Spectrogram of the LIGO Livingston data around the time of the scattered light glitch for the leftmost injection from,0.0
Fig. 6. Left panel: data containing the scattered light glitch and the simulated CBC signal. Middle panel: data after a fair,0.0
draw from the glitch model has been subtracted leaving behind only the chirping CBC signal. Right panel: data after a fair,0.0
"draw from the glitch and CBC models has been subtracted, leaving behind only Gaussian detector noise.",0.0
              2                                                                                                       2                                                                                                         2,14.0
σnoise        0                                                                                                       0                                                                                                         0,0.0
          −2                LIGO Hanford                                                                          −2                                                                                                        −2,10.0
              2                                                                                                       2                                                                                                         2,14.0
σnoise        0                                                                                                       0                                                                                                         0,0.0
          −2                LIGO Livingston                                                                       −2               Data           CBC               Glitch                                                  −2,10.0
                          -0.4           -0.2            0                0.2           0.4                                       -0.4          -0.2            0                   0.2           0.4                                       -0.4          -0.2            0                0.2           0.4,26.0
                                    t (s) from GPS 1165069535.9                                                                            t (s) from GPS 1165069536.9                                                                               t (s) from GPS 11650695367.9,36.0
FIG. 9. Credible intervals for the glitch (orange) and the CBC (blue) signal reconstruction for data containing a blue mountain,0.0
glitch in LIGO Hanford and a simulated CBC signal at 3 different times with respect to the glitch (left to right). Shaded,0.0
"regions correspond to 90% credible intervals, while in grey dashed lines we plot the data whitened with a fair draw PSD from",0.0
our noise model posterior. The top row corresponds to LIGO Hanford while the bottom row corresponds to LIGO Livingston.,0.0
"glitch model has the flexibility to use no glitch wavelets,                                                                                                                                                                V.             CONCLUSIONS",0.0
we therefore expect many samples in the glitch model,0.0
posterior to contain exactly zero glitch power. We an-,0.0
alyze 4s of data starting at 16Hz and with a sampling                                                                                                                  We construct and validate an analysis of GW data,0.0
"rate of 2048Hz. We perform two runs, one with the                                                                                                                   that simultaneously models astrophysical CBC signals",0.0
CBC+glitch+noise model and one with the CBC+glitch                                                                                                                  and instrumental glitches. We test the analysis against,0.0
model using otherwise identical settings.                                                                                                                           real instances of glitches in the two LIGO detectors from,0.0
                                                                                                                                                                    O2 data and simulated CBC signals injected at different,164.0
                                                                                                                                                                    times with respect to the glitch. We find that our analy-,164.0
"                                                                                                                                                                    sis can separate the two, and provide both estimates for",164.0
                                                                                                                                                                    the CBC source parameters and glitch-subtracted data,164.0
   Relevant results are shown in Figs. 14 and 15 where as                                                                                                           for subsequent analyses. The glitch model we employ is,3.0
before we plot the CBC and glitch reconstructions of the                                                                                                            a sum of sine-Gaussian wavelets that is not tuned to any,0.0
CBC+glitch+noise model in the two detectors and the                                                                                                                 specific glitch type and morphology; it can thus handle,0.0
recovered source parameters. The CBC reconstruction of                                                                                                              even novel glitch types that might first appear during,0.0
Fig. 14 is consistent with previous results [43]. The glitch                                                                                                        O4. Even though this flexibility is desirable given the,0.0
"reconstruction is too small to identify in the scale of the                                                                                                         unpredictable and evolving nature of glitches, the effi-",0.0
"plot, as we find that 86% and 14% of our posterior sam-                                                                                                             cacy of glitch subtraction can be improved by employing",0.0
ples had exactly zero glitch wavelets in LIGO Hanford                                                                                                               targeted priors for different glitch types. One such exam-,0.0
and LIGO Livingston respectively. Figure 15 shows the                                                                                                               ple would be a prior that anticipates arches at frequency,0.0
posterior distribution for selected source parameters of                                                                                                            multiples in the case of scattered light glitches. We leave,0.0
GW150914 obtained under the CBC+glitch+noise and                                                                                                                    such targeted priors to future work.,0.0
the CBC+noise models. The two posteriors yield con-                                                                                                                   Our analysis considered only simulated BBH sig-,0.0
"sistent results, showing that the glitch model does not                                                                                                             nals, though we also present an analysis of the BNS",0.0
affect the CBC parameters when no glitch is present in                                                                                                              GW170817. We expect overlapping CBCs and glitches,0.0
the data.                                                                                                                                                           of similar duration to be a worse-case-scenario due to,0.0
avr_spaces,33.41379310344828
                                                                                                                                                                   9,163.0
            4    CBC+glitch+noise                                                                    the glitch model during sampling will decrease the sam-,12.0
                 CBC+noise,17.0
                                                                                                     pler’s convergence time and result in ready-to-use glitch-,101.0
            2,12.0
                                                                                                     subtracted data more quickly. We hope that our analysis,101.0
            0                                                                                        will contribute to robust and efficient glitch mitigation,12.0
                0.4    0.6      0.8   1.0,16.0
                                                                                                     against the increased event rate anticipated in O4; our,101.0
         30                                  0.4,9.0
                                                                                                     goal is to facilitate analysis of as much data as possible,101.0
   M (M ),3.0
         28                                  0.3,9.0
         26                                  0.2                                                     and maximize the science output of the upcoming obser-,9.0
         24                                  0.1                                                     vations.,9.0
         22                                  0.0,9.0
                0.4    0.6      0.8   1.0       22   24   26   28   30,16.0
        0.2                                  0.2                         4                                           ACKNOWLEDGMENTS,8.0
χeff    0.0                                  0.0,0.0
                                                                         2,73.0
       −0.2                                 −0.2,7.0
"                                                                                                        We thank Derek Davis, Laura Nuttall, and Jessica",104.0
       −0.4                                 −0.4                         0,7.0
                0.4    0.6      0.8   1.0       22   24   26   28   30   −0.4   −0.2     0.0   0.2   McIver for sharing preliminary results and datasets,16.0
                          q                          M (M )                            χeff,26.0
                                                                                                     for LIGO glitches and CBC injections. This research,101.0
"                                                                                                     has made use of data, software and/or web tools ob-",101.0
FIG. 10. One- and two-dimensional posterior distribution for                                         tained from the Gravitational Wave Open Science Cen-,0.0
"selected source parameters of the simulated signal from the                                          ter (https://www.gw-openscience.org), a service of LIGO",0.0
"left panels of Fig. 9 injected on top of a LIGO Hanford blue                                         Laboratory, the LIGO Scientific Collaboration and the",0.0
"mountain glitch. We include the mass ratio q, the effective                                          Virgo Collaboration. LIGO is funded by the U.S. Na-",0.0
"spin χeff , and the detector frame chirp mass M posteriors,",0.0
                                                                                                     tional Science Foundation. Virgo is funded by the French,101.0
while black crosses or black vertical lines denote the true pa-,0.0
rameters of the injection.,0.0
"                                                                                                     Centre National de Recherche Scientifique (CNRS), the",101.0
                                                                                                     Italian Istituto Nazionale della Fisica Nucleare (INFN),101.0
"                                                                                                     and the Dutch Nikhef, with contributions by Polish and",101.0
                                                                                                     Hungarian institutes. The authors are grateful for com-,101.0
"their similar morphology [44, 45]. Given that, we plan to                                            putational resources provided by the LIGO Laboratory",0.0
carry out a larger scale study of our CBC+glitch analysis                                            and supported by National Science Foundation Grants,0.0
"that includes more glitch types and CBC classes, such as                                             PHY-0757058 and PHY-0823459. N.J.C. appreciates the",0.0
"BNSs and lower mass BBHs. Additionally, the analysis                                                 support provided by NSF award PHY-1912053. M.W.",0.0
presented here did not make use of GlitchBuster [23]                                                 gratefully acknowledges support and hospitality from the,0.0
"to provide initial fits to the glitch, apart from the                                                Simons Foundation through the pre-doctoral program at",0.0
"GW170817 case. In the future we plan to investigate                                                  the Center for Computational Astrophysics, Flatiron In-",0.0
interfacing GlitchBuster and BayesWave in more de-                                                   stitute. The Flatiron Institute is supported by the Si-,0.0
"tail, in the hopes that an efficient starting point for                                              mons Foundation. Software: gwpy [46], matplotlib [47].",0.0
" [1] J. Aasi et al. (LIGO Scientific), Class. Quant. Grav. 32,                                       [10] C. Talbot and E. Thrane, (2020), arXiv:2006.05292",1.0
"     074001 (2015), arXiv:1411.4547 [gr-qc].                                                              [astro-ph.IM].",5.0
" [2] F. Acernese et al. (Virgo Collaboration), Class. Quant.                                         [11] S. A. Usman et al., Class. Quant. Grav. 33, 215004",1.0
"     Grav. 32, 024001 (2015), arXiv:1408.3978 [gr-qc].                                                    (2016), arXiv:1508.02357 [gr-qc].",5.0
" [3] R. Abbott et al. (LIGO Scientific, Virgo), (2020),                                              [12] S. Sachdev et al., (2019), arXiv:1901.08580 [gr-qc].",1.0
"     arXiv:2010.14527 [gr-qc].                                                                       [13] B. Zackay, T. Venumadhav, J. Roulet, L. Dai, and",5.0
" [4] B. P. Abbott et al. (LIGO Scientific Collaboration, Virgo                                            M. Zaldarriaga, (2019), arXiv:1908.05644 [astro-ph.IM].",1.0
"     Collaboration), Phys. Rev. Lett. 119, 161101 (2017),                                            [14] R. DeRosa, J. C. Driggers, D. Atkinson, H. Miao,",5.0
"     arXiv:1710.05832 [gr-qc].                                                                            V. Frolov, M. Landry, J. A. Giaime, and R. X.",5.0
" [5] B. P. Abbott et al. (LIGO Scientific Collaboration,                                                  Adhikari, Classical and Quantum Gravity 29, 215008",1.0
"     Virgo Collaboration), Living Rev. Rel. 19, 1 (2013),                                                 (2012), arXiv:1204.5504 [physics.ins-det].",5.0
"     arXiv:1304.0670 [gr-qc].                                                                        [15] V. Tiwari et al., Class. Quant. Grav. 32, 165014 (2015),",5.0
" [6] K. Chatziioannou, C.-J. Haster, T. B. Littenberg, W. M.                                              arXiv:1503.07476 [gr-qc].",1.0
"     Farr, S. Ghonge, M. Millhouse, J. A. Clark, and N. Cor-                                         [16] G. D. Meadors, K. Kawabe, and K. Riles, Class. Quant.",5.0
"     nish, Phys. Rev. D 100, 104004 (2019).                                                               Grav. 31, 105014 (2014), arXiv:1311.6835 [astro-ph.IM].",5.0
" [7] J. Veitch et al., Phys. Rev. D 91, 042003 (2015),                                               [17] J. Driggers et al. (LIGO Scientific), Phys. Rev. D 99,",1.0
"     arXiv:1409.7215 [gr-qc].                                                                             042001 (2019), arXiv:1806.00532 [astro-ph.IM].",5.0
" [8] B. P. Abbott et al. (LIGO Scientific, Virgo), Class.                                            [18] D. Davis, T. Massinger, A. Lundgren, J. Driggers, A. Ur-",1.0
"     Quant. Grav. 37, 055002 (2020), arXiv:1908.11170 [gr-                                                ban, and L. Nuttall, Class. Quant. Grav. 36, 055011",5.0
"     qc].                                                                                                 (2019), arXiv:1809.05348 [astro-ph.IM].",5.0
" [9] C. Rover, R. Meyer, and N. Christensen, Class. Quant.                                           [19] G. Vajente, Y. Huang, M. Isi, J. C. Driggers, J. S. Kissel,",1.0
"     Grav. 28, 015010 (2011), arXiv:0804.3853 [stat.ME].                                                  M. J. Szczepanczyk, and S. Vitale, Phys. Rev. D 101,",5.0
avr_spaces,24.253521126760564
                                                                                                                                                                                                                                                                                                                     10,309.0
                                                                                   30                                                                                                       30                                                                                                     30,83.0
             500                                                                                                     500                                                                                                      500,13.0
                                                                                   25                                                                                                       25                                                                                                     25,83.0
                                                                                        Normalized energy                                                                                        Normalized energy                                                                                      Normalized energy,88.0
                                                                                   20                                                                                                       20                                                                                                     20,83.0
    f (Hz)   100                                                                   15,4.0
                                                                                                            f (Hz)   100                                                                    15,108.0
                                                                                                                                                                                                                     f (Hz)   100                                                                  15,213.0
              50                                                                   10                                 50                                                                    10                                 50                                                                  10,14.0
                                                                                   5                                                                                                        5                                                                                                      5,83.0
                                                                                   0                                                                                                        0                                                                                                      0,83.0
               0.5     0.6   0.7   0.8   0.9   1    1.1   1.2   1.3    1.4   1.5                                       0.5   0.6   0.7   0.8    0.9   1   1.1    1.2    1.3   1.4     1.5                                       0.5    0.6   0.7   0.8   0.9   1   1.1   1.2   1.3    1.4   1.5,15.0
                             t (s) from GPS 1165069534.9                                                                           t (s) from GPS 1165069534.9                                                                               t (s) from GPS 1165069534.9,29.0
FIG. 11. Spectrogram of the LIGO Livingston data around the time of the blue mountain glitch for the leftmost injection from,0.0
Fig. 9. Left panel: data containing the blue mountain glitch and the simulated CBC signal. Middle panel: data after a fair,0.0
draw from the glitch model has been subtracted leaving behind only the chirping CBC signal. Right panel: data after a fair,0.0
"draw from the glitch and CBC models has been subtracted, leaving behind only Gaussian detector noise.",0.0
                                                                                                                                                                                    CBC+glitch+noise,180.0
                   1         LIGO Hanford                                                                                                                                 4         CBC+noise (cleaned),19.0
                                                                                                                                                                          2,170.0
   σnoise          0                                                                                                                                                      0,3.0
                                                                                                                                                                          0.4         0.6                0.8                  1.0,170.0
                                                                                                                                                                                                                                 4000,225.0
                                                                                                                                                          M (M ),154.0
              −1                                                                                                                                                   1.198,14.0
                                                                                                                                                                                                                                    2000,228.0
             150,13.0
             100             LIGO Livingston                                                                                                                     1.1975                                                                0,13.0
                                                                                                                                                                      0.4             0.6                0.8                  1.0       1.1975           1.198,166.0
               50,15.0
σnoise,0.0
                                                                                                                                                                   0.10                                                             0.10                                 30,163.0
                   0                                                                                                                                                                                                                                                     20,19.0
                                                                                                                                                                χeff   0.05                                                         0.05,160.0
             −50                                                                                                                                                                                                                                                         10,13.0
         −100                 Data                 CBC                Glitch                                                                                           0.00                                                         0.00,9.0
                                                                                                                                                                                                                                                                          0,266.0
         −150                                                                                                                                                             0.4         0.6                0.8                  1.0       1.1975           1.198                 0.00         0.05                            0.10,9.0
           −0.15                     −0.12                −0.09                −0.06                                   −0.03                   0.00                                                                                                                                     χeff,11.0
                                                                                                                                                                                                q                                              M (M ),192.0
                                         t (s) from GPS 1187008881.4457,41.0
                                                                                                                                                          FIG. 13. One- and two-dimensional posterior distribution for,154.0
FIG. 12. Credible intervals for the glitch (orange) and the                                                                                               selected source parameters for GW170817. We include the,0.0
"CBC (blue) signal reconstruction for GW170817. Shaded                                                                                                     mass ratio q, the effective spin χeff , and the detector frame",0.0
"regions correspond to 90% credible intervals, while in grey                                                                                               chirp mass M posteriors. Blue curves show posteriors under",0.0
"dashed lines we plot the data whitened with a fair draw PSD                                                                                               the CBC+glitch+noise model on the full data, while orange",0.0
from our noise model posterior. The top row corresponds to                                                                                                curves correspond to the CBC+noise model on data where the,0.0
LIGO Hanford while the bottom row corresponds to LIGO                                                                                                     glitch has already been subtracted. The two sets of results are,0.0
Livingston. The LIGO Hanford plot zooms in to show the                                                                                                    consistent with each other.,0.0
signal that is invisible in the LIGO Livingston plot due to the,0.0
size of the glitch; note the y-scale difference in the two plots,0.0
"                                                                                                                                                          [27] C. Pankow et al., Phys. Rev. D98, 084016 (2018),",154.0
                                                                                                                                                               arXiv:1808.03619 [gr-qc].,159.0
"     042003 (2020), arXiv:1911.09083 [gr-qc].                                                                                                             [28] LIGO Scientific Collaboration, Virgo Collaboration,",5.0
"[20] R. Ormiston, T. Nguyen, M. Coughlin, R. X. Adhikari,                                                                                                      “LALSuite,” https://git.ligo.org/lscsoft/lalsuite (2018).",0.0
"     and E. Katsavounidis, Phys. Rev. Res. 2, 033066 (2020),                                                                                              [29] N. J. Cornish, (2021), arXiv:2101.01188 [gr-qc].",5.0
"     arXiv:2005.06534 [astro-ph.IM].                                                                                                                      [30] N. J. Cornish and K. Shuman, Phys. Rev. D 101, 124008",5.0
"[21] S. Coughlin et al., Phys. Rev. D 99, 082002 (2019),                                                                                                       (2020), arXiv:2005.03610 [gr-qc].",0.0
"     arXiv:1903.04058 [astro-ph.IM].                                                                                                                      [31] N. J. Cornish, (2016), arXiv:1606.00953 [gr-qc].",5.0
"[22] N. J. Cornish and T. B. Littenberg, Class. Quant. Grav.                                                                                              [32] Gravitational Wave Open Science Center (GWOSC),",0.0
"     32, 135012 (2015), arXiv:1410.3835 [gr-qc].                                                                                                               https://www.gw-openscience.org/.",5.0
"[23] N. J. Cornish, T. B. Littenberg, B. Bécsy, K. Chatziioan-                                                                                           [33] R. Abbott et al. (LIGO Scientific, Virgo), (2019),",0.0
"     nou, J. A. Clark, S. Ghonge, and M. Millhouse, (2020),                                                                                                    arXiv:1912.11716 [gr-qc].",5.0
"     arXiv:2011.09494 [gr-qc].                                                                                                                            [34] S. Husa, S. Khan, M. Hannam, M. Pürrer, F. Ohme,",5.0
"[24] P.    J.   Green,     Biometrika    82,     711    (1995),                                                                                                X. Jiménez Forteza, and A. Bohé, Phys. Rev. D 93,",0.0
"     http://oup.prod.sis.lan/biomet/article-                                                                                                                   044006 (2016), arXiv:1508.07250 [gr-qc].",5.0
"     pdf/82/4/711/699533/82-4-711.pdf.                                                                                                                    [35] S. Khan, S. Husa, M. Hannam, F. Ohme, M. Pürrer,",5.0
"[25] T. B. Littenberg and N. J. Cornish, Phys. Rev. D91,                                                                                                       X. Jiménez Forteza, and A. Bohé, Phys. Rev. D 93,",0.0
"     084034 (2015), arXiv:1410.3852 [gr-qc].                                                                                                                   044007 (2016), arXiv:1508.07253 [gr-qc].",5.0
"[26] BayesWave Glitch Subtraction for GW170817, https://                                                                                                  [36] M. Cabero et al., Class. Quant. Grav. 36, 15 (2019),",0.0
     dcc.ligo.org/LIGO-T1700406/public.                                                                                                                        arXiv:1901.05093 [physics.ins-det].,5.0
avr_spaces,54.56164383561644
                                                                                                                                                                11,160.0
"           6                                                                                         [37] J. Powell, Class. Quant. Grav. 35, 155017 (2018),",11.0
           4            LIGO Hanford                                                                      arXiv:1803.11346 [astro-ph.IM].,11.0
           2,11.0
"                                                                                                     [38] T. Accadia et al., Classical and Quantum Gravity 27,",101.0
σnoise     0,0.0
                                                                                                          194011 (2010).,106.0
"                                                                                                     [39] S. Soni et al., arXiv e-prints , arXiv:2007.14876 (2020),",101.0
         −2                                                                                               arXiv:2007.14876 [astro-ph.IM].,9.0
"         −4             Data             CBC               Glitch                                    [40] B. Abbott et al. (LIGO Scientific, Virgo), Phys. Rev.",9.0
"           6                                                                                              Lett. 116, 061102 (2016), arXiv:1602.03837 [gr-qc].",11.0
"                        LIGO Livingston                                                              [41] T. Dietrich et al., Phys. Rev. D99, 024029 (2019),",24.0
           4                                                                                              arXiv:1804.02235 [gr-qc].,11.0
σnoise,0.0
"           2                                                                                         [42] B. P. Abbott et al. (LIGO Scientific, Virgo), Class.",11.0
"           0                                                                                              Quant. Grav. 33, 134001 (2016), arXiv:1602.03844 [gr-",11.0
                                                                                                          qc].,106.0
"         −2                                                                                          [43] B. P. Abbott et al. (LIGO Scientific, Virgo), Phys. Rev.",9.0
"         −4                                                                                               Lett. 116, 241102 (2016), arXiv:1602.03840 [gr-qc].",9.0
"         −0.06               −0.04            −0.02           0.00        0.02          0.04         [44] B. P. Abbott et al. (LIGO Scientific, Virgo), Class.",9.0
"                                    t (s) from GPS 1126259462.391                                         Quant. Grav. 35, 065010 (2018), arXiv:1710.02185 [gr-",36.0
                                                                                                          qc].,106.0
"FIG. 14. Credible intervals for the glitch (orange) and the                                          [45] D. Davis, L. V. White, and P. R. Saulson, Class. Quant.",0.0
"CBC (blue) signal reconstruction for GW150914. Shaded                                                     Grav. 37, 145001 (2020), arXiv:2002.09429 [gr-qc].",0.0
"regions correspond to 90% credible intervals, while in grey                                          [46] D. Macleod, A. L. Urban, S. Coughlin, T. Massinger,",0.0
"dashed lines we plot the data whitened with a fair draw PSD                                               M. Pitkin, paulaltin, J. Areeda, E. Quintero, T. G. Bad-",0.0
"from our noise model posterior. The top row corresponds to                                                ger, L. Singer, and K. Leinweber, “gwpy/gwpy: 1.0.1,”",0.0
LIGO Hanford while the bottom row corresponds to LIGO                                                     (2020).,0.0
"Livingston. Our glitch model recovers essentially no incoher-                                        [47] J. D. Hunter, Computing In Science & Engineering 9, 90",0.0
ent power coincident with the astrophysical signal and there-                                             (2007).,0.0
fore the reconstruction is not visible in the scale of the plot.,0.0
                     CBC+glitch+noise,21.0
             4       CBC+noise,13.0
             2,13.0
            0,12.0
            0.6             0.8         1.0,12.0
           34                                 0.6,11.0
    M (M ) 32                                 0.4,4.0
           30                                 0.2,11.0
           28                                 0.0,11.0
            0.6             0.8         1.0      28   30      32     34,12.0
          0.2                                 0.2,10.0
                                                                          6,74.0
χeff      0.0                                 0.0                         4,0.0
                                                                          2,74.0
         −0.2                             −0.2,9.0
                                                                          0,74.0
               0.6          0.8         1.0     28    30      32     34       −0.2     0.0     0.2,15.0
                             q                        M (M )                         χeff,29.0
FIG. 15. One- and two-dimensional posterior distribution for,0.0
selected source parameters for GW150914. We include the,0.0
"mass ratio q, the effective spin χeff , and the detector frame",0.0
chirp mass M posteriors. Blue curves show posteriors un-,0.0
"der the CBC+glitch+noise model, while orange curves corre-",0.0
spond to the CBC+noise model. The two sets of results are,0.0
consistent with each other.,0.0
avr_spaces,22.228070175438596
