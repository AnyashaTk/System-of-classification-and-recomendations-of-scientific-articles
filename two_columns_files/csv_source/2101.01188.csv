text,space_num
                                                              Rapid and Robust Parameter Inference for Binary Mergers,62.0
                                                                                               Neil J. Cornish,95.0
"                                                                           eXtreme Gravity Institute, Department of Physics,",75.0
"                                                                        Montana State University, Bozeman, Montana 59717, USA",72.0
                                                        The detection rate for compact binary mergers has grown as the sensitivity of the global network,56.0
"                                                     of ground based gravitational wave detectors has improved, now reaching the stage where robust",53.0
                                                     automation of the analyses is essential. Automated low-latency algorithms have been developed,53.0
                                                     that send out alerts when candidate signals are detected. The alerts include sky maps to facilitate,53.0
"                                                     electromagnetic follow up observations, along with probabilities that the system might contain a",53.0
"                                                     neutron star, and hence be more likely to generate an electromagnetic counterpart. Data quality is-",53.0
"                                                     sues, such as loud noise transients (glitches), can adversely affect the low-latency algorithms, causing",53.0
                                                     false alarms and throwing off parameter estimation. Here a new analysis method is presented that is,53.0
"                                                     robust against glitches, and capable of producing fully Bayesian parameter inference, including sky",53.0
"                                                     maps and mass estimates, in a matter of minutes. Key elements of the method are wavelet-based",53.0
arXiv:2101.01188v4 [gr-qc] 6 May 2021,0.0
"                                                     de-noising, penalized maximization of the likelihood during the initial search, rapid sky localization",53.0
"                                                     using pre-computed inner products, and heterodyned likelihoods for full Bayesian inference.",53.0
                                                         I.    INTRODUCTION                                duces low-latency sky maps and initial parameter es-,57.0
"                                                                                                           timates, followed by full Bayesian parameter estima-",107.0
                                           What started with a trickle in 2015 [1] has now turned          tion. For binary black holes the entire process takes,43.0
"                                        into a veritable deluge [2, 3] of gravitational wave signals       just minutes on a laptop; for binary neutron stars, ini-",40.0
                                        detected by the LIGO and Virgo instruments. Keep-                  tial sky maps and mass estimates are ready in min-,40.0
"                                        ing up with the ever increasing event rate is challeng-            utes, and full results are ready in less than an hour.",40.0
                                        ing. While the searches for gravitational wave signals are         The QuickCBC code is open source https://github.,40.0
"                                        now highly automated and capable of producing near-                com/eXtremeGravityInstitute/QuickCBC, and can be",40.0
"                                        real time alerts [4–8], full parameter inference [9, 10] has       used to analyze public LIGO-Virgo data hosted by the",40.0
                                        lagged behind. This is in part due to the large compu-             Gravitational Wave Open Science Center https://www.,40.0
"                                        tational cost of fully Bayesian parameter inference, and           gw-openscience.org. For testing purposes the algo-",40.0
                                        in part due to the challenge of working with data that             rithm was run in real time during the LIGO-Virgo O3,40.0
"                                        needs to be carefully calibrated [11, 12] and cleaned of           observing run, automatically generating results for trig-",40.0
                                        various noise contaminants [13–16].                                gers sent to the Gravitational-Wave Candidate Event,40.0
"                                           The instrument noise in the LIGO and Virgo data is,             Database.",43.0
"                                        for the most part, well described as locally stationary               Existing algorithms can perform most of the indi-",40.0
"                                        and Gaussian [17]. Short duration signals, such as high            vidual steps in the QuickCBC algorithm. For example,",40.0
"                                        mass binary black holes, are in the sensitive band of the          the PyCBC search algorithm [20] performs low-latency",40.0
"                                        detector for a second or less, and the odds of the signal          searches for CBC signals that incorporate glitch mit-",40.0
"                                        encountering a noise transient is low. However, for longer         igation via a chi-squared test [19] and automatic gat-",40.0
"                                        duration signals, such as low mass black hole binaries or          ing of loud glitches [20]. The BayesWave algorithm [16,",40.0
"                                        systems that include a neutron star, the signals are in the        21, 22], produces on-source spectral estimates and per-",40.0
"                                        sensitive band of the detectors for tens of seconds or even        forms glitch subtraction [3, 23, 24]. The BayesStar algo-",40.0
"                                        minutes, and it is likely that the signal will encounter a         rithm [25] produces low-latency sky maps to help guide",40.0
                                        noise transient. As the low-frequency sensitivity of the           the search for electromagnetic counterparts to binary,40.0
"                                        detectors improve, low mass systems are virtually guar-            mergers, and several rapid parameter estimation algo-",40.0
                                        anteed to encounter noise transients. The LIGO/Virgo               rithms have been developed [26–30]. What is novel is,40.0
"                                        analyses have been fortified against noise transients using        that QuickCBC is a fully automated, end-to-end analy-",40.0
"                                        a combination of vetoes [18], glitch robust search statis-         sis algorithm that is robust against glitches, and able to",40.0
"                                        tics [19], gating [20] and glitch subtraction [16]. Gating         produce reliable results in a matter of minutes. Many",40.0
"                                        of glitches is used in the online searches, while glitch sub-      of the methods used by QuickCBC, such as wavelet de-",40.0
"                                        traction is performed prior to off-line parameter estima-          noising [31], banded likelihoods for glitch rejection, and",40.0
"                                        tion.                                                              heterodyned likelihoods for rapid inference [32, 33], are",40.0
                                           Here a proof of concept for a robust end-to-end                 new to LIGO-Virgo data analysis.,43.0
                                        low-latency Bayesian parameter estimation algorithm -                 Core elements of the QuickCBC algorithm have been,40.0
                                        QuickCBC - is presented. The QuickCBC algorithm reads              merged with the BayesWave algorithm [34]. The key,40.0
"                                        in calibrated strain data, performs robust on-source spec-         difference between the implementations is that the",40.0
"                                        tral estimation, executes a rapid search for compact bi-           BayesWave variant [35] jointly marginalizes over the CBC",40.0
"                                        nary coalescence (CBC) signals, uses wavelet de-noising            signal parameters, a model for the power spectral density",40.0
"                                        to subtract any glitches from the search residuals, pro-           (PSD) and a wavelet based model for noise transients.",40.0
avr_spaces,45.44827586206897
                                                                                                                      2,118.0
The QuickCBC algorithm uses a fixed PSD and a point         first five stages complete the algorithm will have pro-,0.0
"estimate for any noise transients. The other key differ-    duced a full three-dimensional sky map (RA, DEC and",0.0
"ence is speed: QuickCBC can be provide results with a la-   luminosity distance), along with estimates for the com-",0.0
"tency of minutes, while the more refined BayesWave+CBC      ponent masses and spins. All in about the time is took",0.0
analysis [35] takes hours.                                  you to read this paragraph. The precise run time will,0.0
                                                            depend on the duration and bandwidth of the signal and,60.0
                                                            the speed and number of computations cores. For binary,60.0
 II.   OVERVIEW OF THE QUICKCBC ALGORITHM                   black hole systems at current LIGO/Virgo sensitivity it is,1.0
                                                            usually sufficient to use 4 seconds of data sampled at 2048,60.0
                                                            Hz. For neutron star - black hole systems it is enough,60.0
   The QuickCBC algorithm works with short snippets of,3.0
"                                                            to use 8 to 16 seconds of data sampled at 2048 Hz, while",60.0
"LIGO-Virgo data, typically 4 to 8 seconds in length when",0.0
                                                            for binary neutron star systems we need 16 to 32 seconds,60.0
searching for binary black holes and 16 to 32 seconds in,0.0
                                                            of data sampled at 4096 Hz. For a binary black hole,60.0
length when searching for binary neutron stars. The run,0.0
"                                                            system, running on a 2016 MacBook Pro laptop with",60.0
time scales roughly linearly with the data volume.,0.0
"                                                            a 2.9 GHz quad-core processor, it takes ∼ 60 seconds",60.0
"   The first step is to produce estimates for the power     for the PSD estimation and intrinsic parameter search,",3.0
spectral density in each detector. On-source spectral es-   and an additional ∼ 30 seconds to complete the extrin-,0.0
"timation, where the short segment of data to be searched    sic parameter search and produce sky maps. The cost",0.0
"is also used to estimate the power spectral density (PSD),  of the intrinsic parameter search scales linearly with the",0.0
"can be thrown off by the presence of loud signals or loud   data duration, while the cost of the extrinsic parameter",0.0
"glitches. To avoid such biases, QuickCBC uses an itera-     search scales linearly with the sample rate. Thus, the in-",0.0
tive approach that combines a running median estimate       trinsic parameter search for neutron-star black hole bina-,0.0
for the spectrum with spectral line identification and      ries takes either two to four times longer than for binary,0.0
"wavelet de-noising [31]. The de-noising removes signals     black holes, but time to produce a sky map is the same.",0.0
"and glitches, so only the spectral estimate from the first  Sky maps can be produced in very low latency by skip-",0.0
stage of the analysis is passes to the second stage. The    ping the intrinsic search and instead using the intrinsic,0.0
"second stage performs a rapid, network coherent search      parameters provided by the search pipelines (as is done",0.0
for CBC signals using a parallel tempered Markov Chain      by BayesStar [25]). The run time to produce a sky map,0.0
"Monte Carlo algorithm (PTMCMC) [36] with a banded           with QuickCBC is comparable to, or a little faster than,",0.0
"likelihood that is analytically maximized over amplitude,   BayesStar. The main difference is that the QuickCBC",0.0
"phase and arrival time. Only the intrinsic parameters       maps are fully Bayesian, while BayesStar maps are only",0.0
of the signal - masses and spins - are explored by the      approximately so.,0.0
PTMCMC. The banded likelihood automatically identi-,0.0
                                                               The final stage of the algorithm refines the initial pa-,63.0
fies and rejects frequency bands that are impacted by,0.0
                                                            rameter estimates using a PTMCMC algorithm and a,60.0
noise transients. The removal is done separately for each,0.0
"                                                            fast, heterodyned likelihood function [32, 33]. The het-",60.0
"time delay, resulting in a robust time-frequency glitch",0.0
"                                                            erodyned likelihood offers significant speed advantages,",60.0
rejection method that can detect signals in the presence,0.0
                                                            especially for long duration signals such as binary neu-,60.0
of glitches. The third stage subtracts the best-fit CBC,0.0
                                                            tron star inspirals. The run-time for the final PTMCMC,60.0
"waveform from the data, and performs a second round",0.0
                                                            stage scales linearly with the sample rate and is indepen-,60.0
of spectral estimation and wavelet de-noising. The de-,0.0
                                                            dent of the observation time. On the same laptop com-,60.0
noising produces a glitch model that is subtracted from,0.0
"                                                            puter described earlier, the PTMCMC stage takes four",60.0
"the original data, while preserving any gravitational wave",0.0
                                                            minutes for black hole binaries and neutron star - black,60.0
signals. The cleaned data and updated spectral estimates,0.0
"                                                            hole binaries, and eight minutes for neutron star bina-",60.0
are used in the subsequent stages of the analysis. The,0.0
                                                            ries. These run-times are several orders magnitude faster,60.0
fourth stage refines the estimates of the intrinsic param-,0.0
"                                                            than the hours or days it takes for LALinference [9, 10]",60.0
eters using a standard non-maximized and non-banded,0.0
                                                            to produce results.,60.0
"likelihood function. Consequently, the amplitude, phase",0.0
and arrival time at each detector also have to be explored,0.0
by the PTMCMC. The refined estimates for the intrinsic,0.0
parameters are then passed to the fifth stage of the anal-     A.    Spectral Estimation and Wavelet De-noising,0.0
"ysis, which uses a PTMCMC algorithm with an algebraic",0.0
likelihood function to map out the extrinsic parameters        The QuickCBC algorithm is design to work with short,0.0
"of the source - sky location, luminosity distance, inclina- stretches of data, typically between Tobs = 4 and Tobs =",0.0
tion and polarization angles while holding the intrinsic    32 seconds in duration. Traditional spectral estimation,0.0
"parameters fixed. Since the extrinsic parameters only im-   techniques, such as Welch averaging, can not be used on",0.0
"pact the projection of the waveform onto the detectors,     short data segments like these. The advantages of work-",0.0
"the inner products in the likelihood can be pre-computed,   ing with short data segments are speed and robustness",0.0
resulting in an algebraic likelihood function that can be   against non-stationary drifts in the power spectrum. The,0.0
evaluated in a fraction of a microsecond [37]. With the     disadvantages are low spectral resolution and possible bi-,0.0
avr_spaces,18.85
                                                                                                                                  3,130.0
                                                                   FIG. 2: Time-frequency maps illustrating the spectral es-,67.0
                                                                   timation and de-noising procedure applied to four seconds,67.0
                                                                   of LIGO Hanford data surrounding GPS time 1126259462.,67.0
                                                                   The initial spectral estimation and whitening (upper panel),67.0
                                                                   is impacted by the loud signal from GW150914. Wavelet de-,67.0
"                                                                   noising is used to remove the excess power, then the spectral",67.0
                                                                   estimation is repeated. The original data is re-whitened (mid-,67.0
                                                                   dle panel) ready for the next iteration. The process is iterated,67.0
                                                                   until the excess SNR plateaus. The bottom panel shows the,67.0
                                                                   de-noised data used to produce the final spectral estimate.,67.0
                                                                   smoothing window ∆f is chosen to strike a balance be-,67.0
                                                                   tween following the slope of the spectrum (small ∆f ’s,67.0
"                                                                   follow the slope), and ignoring sharp spectral lines (large",67.0
"FIG. 1: Workflow diagram for the QuickCBC algorithm. The           ∆f ’s are robust against lines). More accurately, it is the",0.0
"time domain data, d(t), is read in, windowed, and Fourier",0.0
                          ˜ ). An initial on-source PSD esti-      number of Fourier samples in the smoothing window that,26.0
transform to produce d(f,0.0
"                                                                   is critical, so for longer observation times smaller win-",67.0
mate S(f ) is produced using wavelet de-noising to remove,0.0
glitch and signal power. Next the data is searched using a,0.0
                                                                   dows can be used. For the shortest 4 second segments,67.0
glitch-robust likelihood function that maximizes over extrin-      the default width is ∆f = 16 Hz. The smoothed spectral,0.0
"sic parameters and returns initial estimates for the intrinsic     estimate Ss (f ) is used to identify spectral lines, which",0.0
"parameters ~ η . The PSD estimation is then repeated on the        are found by taking the ratio R(f ) = Sp (f )/Ss (f ), with",0.0
"residual d − h(~η ), and wavelet de-noising is used to fit and re- lines defined as regions where this ratio exceeds R∗ = 10.",0.0
move any glitches g̃(f ) that might be present in the data. The    The full spectral estimate is then given by,0.0
"de-glitched data, d(f˜ ) − g̃(f ), is used to pre-compute various",0.0
                                                                                         ,89.0
"inner products for the projected network likelihood, allowing                              Ss (f ), for R(f ) ≤ R∗",0.0
                                                    ~ such as the               S(f ) =                             .           (1),52.0
"for a rapid mapping of the extrinsic parameters ξ,                                         Sp (f ), for R(f ) > R∗",0.0
sky position and luminosity distance. The initial estimates,0.0
for the full set of parameters θ~ = {~      ~ are used along with,0.0
"                                        η , ξ},                    The initial spectral estimate p      is used to whiten the",40.0
the de-glitched data and refined PSD estimate to initialize the    data: d(f˜ ) → d˜w (f ) = d(f  ˜ )/ S(f ). The whitened,0.0
heterodyned likelihood function that is used by the PTMCMC         data is wavelet transformed using an over-complete col-,0.0
algorithm to rapidly produce full posterior distribution.          lection of Morlet-Gabor continuous wavelets (see the,0.0
                                                                   top panel of Figure 2). A wavelet de-noising proce-,67.0
                                                                   dure [31] is then used to remove any non-Gaussian fea-,67.0
ases due to the presence of loud signals or glitches. To           tures from the data. Wavelet de-noising is basically a,0.0
guard against such biases an iterative wavelet de-noising          time-frequency thresholding technique. For stationary,0.0
"approach is used to remove non-Gaussian features from              Gaussian noise, the wavelet power spectrum, Snm , should",0.0
the data.                                                          follow a chi-squared distribution with two degrees of free-,0.0
   The iterative spectral estimation procedure proceeds            dom. Wavelet pixels with power above a certain thresh-,3.0
"as follows: A Tukey window is applied to the data to               old are identified, then an inverse wavelet transform of",0.0
limit spectral leakage. A FFT is then used to produce              these pixels is used to produce a whitened time domain,0.0
a periodogram Sp (f ). A running median of width ∆f                reconstruction of the excess power. The reconstructed,0.0
is used to smooth the periodogram. The width of the                feature is re-colored using the smooth component of the,0.0
avr_spaces,29.58
                                                                                                                                                   4,147.0
"power spectrum Ss (f ) and subtracted from the original                        BayesWave trans-dimensional spectral model [21, 22] to",0.0
time domain data. The thresholding procedure starts by                         the glitch-subtracted data. The spectral model includes,0.0
"identifying pixels with Snm > S0 , then surrounding pix-                       a smooth component described by a cubic spline, and line",0.0
"els with Sn±1m±1 > S1 are also flagged, with the goal                          features described by a Lorentzian line model. The run-",0.0
of identifying clusters of excess power. The standard                          ning median is used to initialize the spline model. The,0.0
threshold values are S0 = 10 and S1 = 6. The power                             spacing of the spline points is determined by comparing,0.0
"spectral estimation is repeated using the de-noised data.                      two running averages of the running median, one with a",0.0
The updated power spectrum is then used to whiten the                          window twice as wide as the other. The usual choice is to,0.0
"original data, and the wavelet de-noising procedure is re-                     use 4 Hz and an 8 Hz window. The spline control points",0.0
peated. The entire procedure is iterated until the signal-                     are spaced more closely in regions where the two aver-,0.0
"to-noise of the non-Gaussian excess plateaus. This typi-                       ages diverge, and spaced further apart in regions where",0.0
"cally takes just one or two iterations, but data with very                     the two averages converge. The minimum spacing of the",0.0
loud glitches may require as many as five or six iterations                    spline control points is set at 4 Hz and the maximum,0.0
for the procedure to converge.                                                 spacing is set at 32 Hz. The threshold on the ratio of the,0.0
   Figure 2 illustrates the spectral estimation and de-                        the two averages is set at 20%. The Lorentzian line model,3.0
noising procedure using 4 seconds of data surrounding                          is initialized using the outliers from the running median,0.0
"GW150914. The initial spectral estimate used to whiten                         to set the initial location, amplitude and width of the",0.0
the data (top panel) overestimates the height of the spec-                     lines. A simple fixed dimension MCMC is then used to,0.0
trum through the band between ∼ 40Hz → 120Hz due                               refine the model parameters. To control unphysical oscil-,0.0
"to the loud gravitational wave signal. The data in the                         lations in the spline model, a prior is used that penalizes",0.0
middle panel is whitened using the updated spectrum                            points with large second derivatives. Figure 4 compares,0.0
found after the initial round of wavelet de-noising. More                      the QuickCBC spectral estimate to the estimate from the,0.0
"features are now visible in the mid-band frequencies. In                       BayesWave algorithm [21, 22]. The QuickCBC estimate",0.0
this example the procedure converged after two itera-                          agrees very well with the BayesWave estimate. The key,0.0
tions. The lower panel shows the de-noised data that                           difference is that the QuickCBC estimate is produced in,0.0
"was used to produce the final spectral estimate. Figure                        seconds, while the more refined BayesWave estimate takes",0.0
3 shows the whitened time domain reconstruction of the                         tens of minutes or longer to produce.,0.0
feature that was removed by the de-noising process. In,0.0
this instance the feature is the gravitational wave signal                                   1x10-39,0.0
                                                                                                                                Welch Average,128.0
from a binary black hole merger. It would be a bad idea                                                                                H1 BW,0.0
                                                                                             1x10-40                             H1 QuickCBC,93.0
to use the wavelet de-noised data from the spectral esti-,0.0
mation procedure for subsequent stages in the analysis!                                      1x10-41,0.0
"Instead, just the spectral estimate is used.",0.0
                                                                                             1x10-42,93.0
                                                                               S(f) (Hz-1),79.0
       6                                                                                     1x10-43,7.0
                  H1 excess,18.0
                                                                                             1x10-44,93.0
       4,7.0
                                                                                             1x10-45,93.0
       2                                                                                     1x10-46,7.0
                                                                                             1x10-47,93.0
g(t)   0,0.0
                                                                                                                 100                            1000,113.0
                                                                                                                       f (Hz),119.0
       -2,7.0
                                                                               FIG. 4:      A comparison of power spectral density esti-,79.0
       -4                                                                      mates using four seconds of LIGO Hanford data surround-,7.0
                                                                               ing GW150914 centered on GPS time 1126259462. The low-,79.0
       -6,7.0
                                                                               latency QuickCBC algorithm produces a good approximation,79.0
            0.3        0.32   0.34   0.36   0.38    0.4   0.42   0.44   0.46   to the reference BayesWave estimate. A Welch average us-,12.0
                                            t (s)                              ing 2048 seconds of data surrounding the event is shown for,44.0
                                                                               comparison.,79.0
FIG. 3: The non-Gaussian feature removed by wavelet de-,0.0
noising during the iterative spectral estimation procedure ap-,0.0
plied to four seconds of LIGO Hanford data centered on GPS,0.0
time 1126259462. In this instance the non-Gaussian feature,0.0
is the gravitational wave signal from the binary black hole                     B.              Parallel Tempered Markov Chain Monte Carlo,0.0
merger GW150914.,0.0
                                                                                 The QuickCBC algorithm uses a Parallel Tempered,81.0
"  The final stage of the QuickCBC spectral estimation                          Markov Chain Monte Carlo (PTMCMC) algorithm [36,",2.0
"procedure is to fit a fixed dimension version of the                           38, 39] for both the initial search, the fast sky map-",0.0
avr_spaces,23.417910447761194
                                                                                                                            5,124.0
ping and the full parameter inference. The implemen-             The reference value θ~ is updated to the current value of,0.0
"tation varies slightly between the different stages, mostly      the chain every few hundred iterations and the Fisher",0.0
"in terms of the likelihood function used, but the central        matrix is recomputed at the new location. The Fisher",0.0
engine is the same.                                              matrix proposal employs the eigenvectors v(k) and eigen-,0.0
"   The PTMCMC algorithm uses a collection of chains              values λk , found by solving the linear system",3.0
that explore likelihoods that are scaled by “inverse tem-                                  j         i,0.0
                          ~ = βi ln L(θ).,26.0
"peratures” βi : ln L(βi , θ)                  ~      Chains with                      Γij v(k) = λk v(k) .                (4)",0.0
"βi = 1 explore the target posterior, while chains with",0.0
"βi > 1 range more widely, and help chains to escape              Jumps from the current location x to candidate loca-",0.0
from local maxima. Chains with βi < 1 can be used to             tion y are proposed by first randomly selecting an eigen-,0.0
"help lock on to weak signals. The temperature ladder             direction p, and setting",0.0
is set so that there are multiple “cold” chains: βi = 1                                          γ,0.0
"for i = [1, Nc ] that interact with Nh “hot” chains on a                             y = x + p v(p) ,                     (5)",0.0
                                                                                                  λp,98.0
geometrically spaced temperature ladder: βk = αk for,0.0
"k = [1, Nh ]. The choice of increment α and the num-",0.0
"                                                                 where γ ∼ N (0, 1) is a zero mean, unit variance Gaus-",65.0
ber of hot chains are tunable parameters. Setting α too,0.0
                                                                 sian deviate. The proposal densities for this jump can-,65.0
large will result in poor exchange between chains. Set-,0.0
                                                                 cel in the Metropolis-Hastings ratio since the Fisher ma-,65.0
ting α too small will require a prohibitive number of,0.0
                                                                 trix is held fixed (aside from occasional infrequent up-,65.0
chains to reach the desired maximum temperature. A,0.0
                                                                 dates). Jumping along eigen-directions is more robust,65.0
good rule-of-thumb for the maximum temperature is that,0.0
"                                                                 that drawing from the full Fisher matrix, as the matri-",65.0
"the effective signal-to-noise  ratio for the hottest chain,",0.0
                  p                                              ces are often poorly-conditioned. The poor conditioning,18.0
SNRNh = SNR βNk should be of order 4-5. For typ-,0.0
"                                                                 typically only impacts one or two eigen-directions, and",65.0
ical LIGO-Virgo signals with SNR ∼ 10 → 20 we need,0.0
                                                                 still allows for good acceptance of jumps along the other,65.0
βNk ∼ 1/4 → 1/16. Using a spacing of α = 0.8 requires,0.0
                                                                 eigen-directions. Small Gaussian jumps along individual,65.0
of order Nh ∼ 6 → 12 hot chains to reach the desired,0.0
                                                                 parameter directions are included in the proposal mix to,65.0
maximum temperature. These rule-of-thumb settings for,0.0
                                                                 help cover directions that might not be explored well by,65.0
the PTMCMC temperature ladder have been found to,0.0
                                                                 the Fisher matrix jumps.,65.0
"work in practice, but the efficiency could be improved",0.0
                                                                    Differential evolution (DE) proposals [40] are particu-,68.0
by using dynamic temperature spacing [39]. When loud,0.0
                                                                 larly good at exploring degenerate directions in parame-,65.0
"signals (SNR > 30) are detected, it may be necessary to",0.0
                                                                 ter space - the very same directions that cause the Fisher,65.0
start a new analysis with additional chains to have a high,0.0
                                                                 matrix to become ill-conditioned. The variant of differ-,65.0
enough maximum temperature.,0.0
                                                                 ential evolution used by QuickCBC works as follows: A,65.0
"   Each chain is updated using a mixture of proposal             history array of past samples, z is collected for each tem-",3.0
distributions. The standard mix includes draws from              perature level (with multiple copies for the cold chains).,0.0
"the prior distribution, jumps along eigenvectors of the          The array is initialized with draws from the prior. Sam-",0.0
"Fisher information matrix, differential evolution, Gaus-         ples are added to the history array after every ∼ 10 it-",0.0
sian jumps along each intrinsic parameter direction and          erations. A counter j keeps track of how many samples,0.0
a dedicated extrinsic parameter proposal that draws new          have been added. The new sample added is added to the,0.0
"sky locations that maintain the time delay between a             array at index j(modNH ). That is, when j reaches NH",0.0
"randomly selected pair of detectors, while analytically          the first entry in the array gets replaced and so on. The",0.0
"adjusting the other extrinsic parameters to keep the de-         DE proposal is made as follows: Two samples, k, l, are",0.0
tector frame waveforms unchanged. The extrinsic pro-             drawn from the history array and used to propose a new,0.0
posal is described in detail in section IVa of Ref. [16].        location,0.0
   The Fisher information matrix proposal is based on a,3.0
quadratic expansion of the log likelihood:                                           y = x + γ(zk − zl ) .                (6),0.0
                                                                                                                     √,117.0
                ~ = −∂i ∂j ln L,16.0
           Γij (θ)                                               Here γ is drawn from a Gaussian of width 2.38/ 2d for,11.0
"                   X Z Aab     ab       2      ab ab             90% of the DE updates, where d is number of parameters,",19.0
"                           ,i A,j + Aab Φ,i Φ,j",27.0
             =4                                       df .   (2) and set to γ = 1 for the rest. The proposal is symmet-,13.0
"                                  S a (f )                       ric, so the proposal densities cancel in the Metropolis-",34.0
                   ab,19.0
                                                                 Hastings ratio. The Gaussian DE jumps are good for,65.0
"Here the derivatives are taken with respect to the wave-         exploring local correlations, while the γ = 1 DE jumps",0.0
form parameters θi centered on some reference value θ.        ~  allow the chains to move between discrete modes of the,0.0
"The sum is over the detectors, a, in the network, and the        posterior.",0.0
"harmonics, b, of the gravitational wave signal:                     The QuickCBC sampler is currently limited to using",0.0
"                                                                 waveform templates that describe non-precessing, quasi-",65.0
                          X                ab,26.0
                ha (f ) =     Aab (f )eiΦ     (f ),16.0
                                                   .         (3) circular binaries. These templates can be parameterized,51.0
                          b                                      in terms of four intrinsic parameters and seven extrinsic,26.0
avr_spaces,22.211764705882352
                                                                                                                                            6,140.0
"parameters. The intrinsic parameters are the individual           where a labels the detector, F+a (α, β, ψ) and F×a (α, β, ψ)",0.0
"mass m1 , m2 and the aligned dimensionless spins χ1 , χ2 .        are the antenna response patterns, ∆ta is the arrival time",0.0
"Here χ = χ   ~ · L̂, where χ  ~ = S/m  ~ 2 is the dimensionless   relative to the geocenter time, φc is the merger phase, and",0.0
spin vector and L̂ is a unit vector aligned with the orbital      DL is the luminosity distance. The reference geocenter,0.0
"angular momentum. The seven extrinsic parameters are              waveform h+ (~η , f ) is generated using an arbitrary fidu-",0.0
"the sky location RA, DEC = (α, β), luminosity distance            cial luminosity distance D∗ , with merger time and phase",0.0
"DL , polarization and inclination (ψ, ι), merger time and         set equal to zero. As such, the reference waveform only",0.0
"merger phase (tc , φc ).                                          depends on the four intrinsic parameters ~η . Defining",0.0
   The QuickCBC sampler uses the modified collection                                                                     1/2,3.0
                                                                                                 D∗  a 2,97.0
"of parameters ~η → {ln M, ln M, χ1 , χ2 } and ξ~ →                                     Fa =            F+ + 2 F×a 2                      (9)",0.0
"{α, sin β, ln DL , ψ, cos ι, φc , tc , }, where M = m1 + m2 is                                  DL",0.0
the total mass and M = (m1 m2 )3/5 /M 1/5 is the chirp            and,0.0
mass. The priors are taken to be uniform in all the pa-,0.0
"rameters save for M, M, DL . For the masses the pri-                                       λa = atan(F×a /F+a ) + φc                    (10)",0.0
"ors are uniform in m1 , m2 , which can √          be enforced us-",0.0
ing the Jacobian factor JM = M m1 m2 / M 2 − 4m1 m2 .             the response can be written as,0.0
"For the distance, the prior is taken to be uniform in lu-",0.0
"minosity distance volume, which can be enforced using                                   ~ f ) = h+ (~η , f )Fa eiλa e2πif ∆ta .",0.0
"                                                                                   ha (θ,                                                (11)",83.0
                                       3,39.0
the Jacobian factor JD = DL              . Some waveform mod-,0.0
"els, such as the IMRPhenomD model [41, 42] used to                We see that the waveforms in each detector are identi-",0.0
"produce the plots in this paper, are only considered              cal up to an overall amplitude scaling, time shift and",0.0
"to be reliable for a sub-set of mass ratios and spins.            phase shift. Denoting the data in detector a as da (f ),",0.0
"To account for this, the prior ranges for the IMRPhe-             the Gaussian log likelihood is given by",0.0
nomD analyses are restricted such that m1 /m2 < 18 and,0.0
|χ| < χmax = 0.85. The default prior on the spins is uni-                                               1                 1,0.0
                                                                                ln La = (da |ha ) − (ha |ha ) − (da |da ) .              (12),80.0
form in the aligned spin component. To facilitate com-                                                  2                 2,0.0
"parison with the IMRPhenomPv2 precessing model [43],              Here (x|y) denotes the noise weighted inner product",0.0
"which uses a uniform-in-direction spin prior, a second",0.0
                                                                                                     Z ∗,101.0
spin prior option can be selected that is uniform in the                                                  x y + y∗ x,0.0
"aligned spin component for isotopically distributed spins,                                (x|y) = 2                      df ,            (13)",0.0
                                                                                                               S(f ),111.0
"namely, p(χ) = ln(χmax /|χ|)/(2χmax ).",0.0
                                                                  where S(f ) is the power spectral density of the noise.,66.0
                                                                  The network log likelihood is found                 by summing the in-,66.0
           C.   Glitch Robust Coherent Search                     dividual contributions: ln L = a ln La .,11.0
                                                                                                                P,112.0
   The QuickCBC algorithm can be used to search for CBC,3.0
signals in segments of LIGO/Virgo data. The standard                                         1.  Maximized likelihood,0.0
usage is to follow-up triggers from template-bank based,0.0
"CBC search pipelines, but any valid GPS time will do.                During the search stage, the power spectral density",0.0
QuickCBC executes a stochastic search using a PTMCMC              is held fixed and the (da |da ) term is a constant that,0.0
algorithm and a glitch-robust maximized likelihood func-          can be ignored. Standard tricks are used to maximize,0.0
"tion. The search is limited to the dominant waveform              over the amplitude, phase and arrival time of the wave-",0.0
"harmonic for non-precessing, quasi-circular binaries. As          forms. Writing the signal in terms of unit normalized",0.0
"such, the search may fail to detect systems with signifi-         sine and cosine quadratures, (ha,s |ha,s ) = (ha,c |ha,c ) = 1,",0.0
"cant contributions from higher modes, strongly precess-           (ha,s |ha,c ) = 0:",0.0
"ing systems, or highly eccentric systems. Extending the",0.0
"search to include higher modes is straightforward. In-                 ha (f ) = Aa (ha,s (f ) sin φa + ha,c (f ) cos φa ) ,             (14)",0.0
cluding precession and eccentricity is far more challeng-,0.0
ing.                                                              the log likelihood (dropping the (da |da ) constant term),0.0
"   The dominant waveform harmonic for non-precessing,             becomes",3.0
quasi-circular binaries has polarization states related:,0.0
                                                                                                                                 1,129.0
"h× (f ) = ih+ (f ) where                                             ln La = Aa ρa (ta , ~η ) cos(φa − ϕa (ta , ~η )) − A2a ,           (15)",0.0
                                                                                                                                 2,129.0
                                   2 cos ι,35.0
"                        =−                   .               (7) where ~η are the intrinsic parameters of the source, and",24.0
                               (1 + cos2 ι),31.0
"                                                                  ρa (ta , ~η ) = |za (ta , ~η )|, ϕa (ta , ~η ) = arg{za (ta , ~η )} where",66.0
The detector response can be written as:,0.0
"                                                                                                      da (f )h∗a,c (f, ~η ) 2πif ta",102.0
                                                                                                   Z,99.0
"        ~ f ) = h+ (~η , f ) D∗ F a + iF a e2πif ∆ta eiφc",8.0
                                                ,48.0
"    ha (θ,                          +        ×                (8)                za (ta , ~η ) = 4                         e        .    (16)",4.0
                             DL                                                                               Sn (f ),29.0
avr_spaces,22.17808219178082
                                                                                                                                          7,138.0
The likelihood is maximized with respect to amplitude               40,0.0
                                                                                                                              H1,126.0
and phase by setting Aa = ρa and φa = ϕa :                          35                                                        L1,0.0
                                        1 2                         30,40.0
"               ln La,max (ta , ~η ) =    ρ (ta , ~η ) .   (17)",15.0
                                        2 a                         25,40.0
"The complex SNR time series za (ta , ~η ) can be computed           20",0.0
using an inverse fast Fourier transform. The likelihood           ρ-,0.0
                                                                    15,68.0
can then be maximized with respect to the time offset ta,0.0
"by sorting the resulting time series ρa (ta , ~η ). The network     10",0.0
likelihood                                                             5,0.0
                                    1X 2                               0,36.0
"             ln Lmax ({ti }, ~η ) =     ρ (ta , ~η )       (18)",13.0
                                    2 a a                              -5,36.0
                                                                            50   100           150      200        250        300   350,76.0
can be maximized with respect to the arrival times in                                                 f (Hz),0.0
"each detector, {ti }, subject to the constraint that the",0.0
time differences ∆tij = |ti − tj | are less than the light        FIG. 5: The banded ρ̄ statistic as a function of central fre-,0.0
"travel times between the detector sites. The maximiza-            quency for a template with chirp mass M = 1.197M , total",0.0
"tion is done pair-wise between detectors, starting with           mass M = 2.8M and merger time tc = 1187008882.4486",0.0
a reference detector. For networks with three or more             GPS seconds. The ρ̄ statistic successfully identifies the fre-,0.0
                                                                  quency bands where the signal track crosses a loud noise tran-,66.0
detectors the pair-wise approach can yield collections of,0.0
                                                                  sient in the LIGO Livingston detector.,66.0
time delays that do not correspond to any physical sky lo-,0.0
"cation. Similarly, the relative phases may not correspond",0.0
"to any physical sky location, inclination and polarization           Here we introduce a variant of this approach with",0.0
angle. In most cases this is not a problem as the extrin-         fixed-width frequency bands. Defining the ρ̄ statistic:,0.0
sic parameters get refined in the subsequent sky-mapping,0.0
stage of the analysis.                                                                                (d − h|h)maxφ0,0.0
"   When glitches are present in the data, the log likeli-                              ρ̄(f, ∆f ) =                                 (20)",3.0
                                                                                                         (h|h)1/2,105.0
"hood times series in each detector, ln La,max (ta , ~η ), may",0.0
have multiple distinct maxima. Some of these maxima               where the noise-weighted inner products are computed,0.0
"will be associated with glitches and some will be asso-           across a frequency band of width ∆f , centered at fre-",0.0
"ciated with the signal. To account for this possibility,          quency f . The inner product of the residual, d − h, and",0.0
"all maxima that are at least 50 ms apart are recored for          the template, h, is analytically maximized with respect to",0.0
each detector before applying the network time-delay re-          the overall phase in that band using sine/cosine quadra-,0.0
"striction. The algorithm can return multiple solutions,           tures. In pure Gaussian noise, d = n, we have",0.0
"each with different arrival times, amplitudes and phases.",0.0
"A glitch rejection step is then applied to each candidate                         E[ρ̄] = 1 − SNR,             Var[ρ̄] = 1.         (21)",0.0
solution before arriving at a unique maximum likelihood,0.0
"solution.                                                         When the template matches a signal in the data, d =",0.0
"                                                                  n + h, we have",66.0
"                                                                                         E[ρ̄] = 1,    Var[ρ̄] = 1.                 (22)",89.0
                2.   Banded Glitch Rejection,16.0
"                                                                  When a glitch is present in the data, d = n + g the",66.0
"  CBC searches use variants of the ρ search statistic,            template rings-off against a glitch and ρ̄(f, ∆f ) becomes",2.0
"defined for data d and templates h as                             large and positive. Frequency bands where ρ̄(f, ∆f ) > 4",0.0
                               (d|h)                              are excluded from the likelihood calculation. The am-,31.0
                        ρ=             .                  (19)    plitude and phase maximization are repeated for the full,24.0
                              (h|h)1/2                            template with any glitch-impacted bands removed. The,30.0
"When a glitch is present in the data, d = n + g, the              banded glitch rejection is applied to the collection of can-",0.0
template can ring-off against the glitch. Usually this oc-        didate solutions from the original likelihood maximiza-,0.0
curs across a narrow band of frequencies. Looking at              tion step. The solution with the largest banded likelihood,0.0
how ρ accumulates with frequency can be used to detect            is returned and used by the PTMCMC search algorithm.,0.0
"glitches. Rather than steadily accumulating, ρ gets a big",0.0
boost in the frequency band where the signal crosses a,0.0
"glitch. Motivated by these considerations, a chi-squared                                  D.     Glitch Removal",0.0
test for glitch rejection has been incorporated into CBC,0.0
searches [19]. The statistic uses frequency bands on vary-           The PTMCMC search using the banded maximum,0.0
"ing width, with",0.0
              p the width chosen so that the template has         likelihood function returns an initial estimate for the ex-,14.0
"equal SNR= (h|h) in each band.                                    trinsic parameters of the signal, along with the arrival",0.0
avr_spaces,17.402985074626866
                                                                                                                                              8,142.0
"times, amplitudes and phases in each detector. This",0.0
solution is then used to subtract the CBC signal from,0.0
the data. The residual is then processed through the,0.0
same spectral estimation procedure that was applied to,0.0
the original data. Figure 6 shows the reconstructed,0.0
glitch model for residual in the LIGO Livingston detec-,0.0
tor roughly a second before the merger of binary neutron,0.0
star GW170817.,0.0
       100,7.0
                   L1 glitch,19.0
        50,8.0
g(t)     0,0.0
                                                                                 FIG. 7: Time-frequency maps of the LIGO Livingston data,81.0
        -50                                                                      centered at GPS time 1187008882. The upper panel shows the,8.0
                                                                                 raw whitened data. The black line indicates the reconstructed,81.0
                                                                                 time-frequency track for GW170817 found using the banded,81.0
       -100                                                                      maximum likelihood. The best-fit signal is subtracted from,7.0
"              -1      -0.9     -0.8   -0.7   -0.6    -0.5   -0.4   -0.3   -0.2   the data, then wavelet de-noising is used to identify any noise",14.0
                                             t (s),45.0
                                                                                 transients in the data. The noise transients are removed from,81.0
                                                                                 the original data in preparation for more refined parameter,81.0
FIG. 6: The whitened glitch model in LIGO Livingston data                        estimation (lower panel).,0.0
centered at GPS time 1187008882. The glitch reconstruc-,0.0
tion was performed after a low-latency point estimate for the,0.0
"GW170817 signal, which is coincident with the glitch, was",0.0
"subtracted from the data.                                                        equation 11). Taking a reference waveform ĥ+ , scaled to",0.0
"                                                                                 unity at some reference distance Da , the log likelihood",81.0
   Figure 7 shows time-frequency maps of the LIGO Liv-                           can be written as,3.0
ingston data surrounding the GW170817 event. The up-,0.0
per panel shows the time-frequency track for the point                                     X Fa Da                                   F 2 D2,0.0
estimate of the signal that was subtracted from the data                          ln L =               e−iλa C(ta ) + eiλa C ∗ (ta ) − a 2a .,0.0
                                                                                           a,91.0
                                                                                                DL                                     2DL,96.0
prior to the second round of spectral estimation and,0.0
wavelet de-noising. The lower panel shows the whitened                                                                                     (23),0.0
data after the noise transient has been removed. All sub-                        where,0.0
sequent stages of the analysis are performed using the,0.0
                                                                                                                 da ĥ∗+ 2πif ta,113.0
                                                                                                             Z,109.0
glitch subtracted data.,0.0
"                                                                                                Ca (ta ) =               e       df ,       (24)",96.0
                                                                                                                 Sn (f ),113.0
                       E.      Low Latency Sky Mapping,23.0
                                                                                 can be evaluated using a Fast Fourier transform (FFT).,81.0
                                                                                 In order to have sufficient time resolution (typically a,81.0
"   The search phase delivers an estimate for the intrinsic                       tenth of a millisecond or less), it is necessary to zero-",3.0
"parameters, in addition to the amplitudes, phases and                            pad the frequency series prior to performing the FFT.",0.0
"arrival times in each detector. The next step is to find ex-                     Nonetheless, the computational cost is small. Putting",0.0
trinsic parameters that are consistent with the waveforms                        everything together we have,0.0
seen in each detector. With three or more detectors the,0.0
problem of solving for the extrinsic parameters ξ~ given,0.0
"the relative amplitudes, arrival times and phases is over-                            ~ θ)",0.0
                                                                                         ~ =,89.0
                                                                                               X                                       Fa2 Da2,95.0
"                                                                                 ln L(ξ,           2Fa |Ca (ta )| cos(λa −arg{Ca (ta )})−   2 .",81.0
"constrained, and often ill-posed due to noise. Rather                                          a",0.0
                                                                                                                                        2DL,136.0
"than trying to solve the problem analytically, we once                                                                                   (25)",0.0
"again resort to a Monte Carlo approach, this time aided                          The quantities Da and Ca (ta ) can be pre-computed and",0.0
by an extremely cheap-to-compute likelihood function.                            stored for any choice of intrinsic parameters ~η . The like-,0.0
"   When the intrinsic parameters ~η are held fixed, the                          lihood for any set of extrinsic parameters can then be",3.0
"response in each detector can be found by applying pro-                          found at the cost of a few multiplications and a cosine,",0.0
jections to a reference geocenter waveform that amount                           allowing for millions of likelihood evaluations per second.,0.0
"to amplitude re-scalings, phase shifts and time shifts (see                      Similar techniques can be used to accelerate the calcula-",0.0
avr_spaces,29.53030303030303
                                                                                                                                           9,139.0
"tion of the extrinsic Fisher matrix, ΓE          ij = (∂ξ i h|∂ξ j h):   ΓE ij ; small Gaussian jumps along each extrinsic parameter",0.0
                    X                                                   direction; and deterministic jumps along sky rings that,20.0
"            ΓEij =        (Fa,i Fa,j + Fa2 λa,i λa,j )H0a                preserve the time delay between a randomly selected pair",12.0
                     a                                                   of detectors [16]. Samples from the chains with unit in-,21.0
"               +δitc (2πFa2 λ,i ta,j λ,j ta,i )H1a                       verse temperature are used to produce low latency sky",15.0
                                                                         maps such as the example shown in Figure 8.,73.0
"                +δitc δjtc (4π 2 Fa2 ta,i ta,j )H2a",16.0
                                                    ,52.0
                                                                    (26),68.0
where Hka = (f k h+ |h+ )a . The inner products Hka are                                 F.    CBC Parameter Estimation,0.0
computed once and stored. The luminosity distance can,0.0
be extracted from the reference waveform by re-scaling,0.0
                                                                             The rapid coherent search and low latency sky map-,77.0
"the response function such that Fa → (Da /DL )Fa , with",0.0
                                                                         ping yield a good starting solution for a Bayesian explo-,73.0
Da scaled such that H0a = 1. The derivatives of ar-,0.0
                                                                         ration of source parameters. The inference is performed,73.0
"rival time at each detector, ta,i , are non-vanishing for",0.0
"                                                                         using the PTMCMC sampler Fisher matrix proposals,",73.0
"{α, β, tc }. The phase derivatives are non-vanishing for",0.0
"                                                                         differential evolution, deterministic sky ring jumps in the",73.0
"{α, β, ψ, ι, φc }:",0.0
                                                                         extrinsic parameters and small Gaussian jumps along,73.0
"                            (F+a (F×a ),i − F+,i a",28.0
                                                    (F×a ))             each parameter direction. The analysis is sped up by,52.0
"           λa,i = δiφc +                                      .     (27) using a heteroydned likelihood function [32, 33].",11.0
                                           Fa2                               The heteroydyned likelihood uses a reference waveform,43.0
"while the derivatives of the re-scaled antenna pattern are               h̄, in this case the maximum likelihood solution from the",0.0
"non-vanishing for {α, β, ψ, ι, DL }:                                     search, to re-write the log likelihood as",0.0
                                                                                                   1                         1,99.0
                Fa                   a,16.0
"                             (F+a F+,i    + (F×a )(F×a ),i )             ln La = (r̄a |h̄a ) + (h̄a |h̄a ) − (r̄a |∆h̄a ) − (∆h̄a |∆h̄a ).",29.0
"    Fa,i = −       δiDL +                                       .   (28)                           2                         2",4.0
               DL                            Fa                                                                                        (29),15.0
                                                                         where r̄a = da − h̄a and ∆ha = h̄a − ha . The (r̄a |h̄a ) and,73.0
                                                                         (h̄a |h̄a ) terms in the likelihood can be computed once and,73.0
                                                                         stored. The (∆ha |∆ha ) term can be written as,73.0
                                                                                    ∆h∆h∗                Ā2 + A2 − 2ĀA cos ∆Φ,84.0
                                                                                Z                    Z,80.0
                                                                             4               df = 4                               df (30),77.0
                                                                                      S(f )                           S(f ),86.0
"                                                                         where we have used h = A(f )eiΦ(f ) , h̄ = Ā(f )eiΦ̄(f ) and",73.0
                                                                         ∆Φ(f ) = Φ̄(f ) − Φ(f ). The phase difference between the,73.0
"                                                                         reference waveform h̄, and waveforms drawn from the",73.0
"                                                                         posterior distribution h will always be small, so using a",73.0
                                                                         reference waveform effectively heterodynes the numera-,73.0
"                                                                         tor of equation (30), rending it a slowly varying function",73.0
                                                                         of frequency. The (r̄a |∆ha ) in the likelihood can be writ-,73.0
                                                                         ten as,73.0
                                                                                                Z,96.0
"FIG. 8: Low latency sky map for GW170817. The blue star                         (r̄a |∆ha ) = 4 (<r̄w <∆hw + =r̄w =∆hw )df ,           (31)",0.0
indicates the location of the electromagnetic counterpart to,0.0
the BNS merger.                                                          where,0.0
                                                                                                                     1/2,117.0
   A PTMCMC algorithm is used to explore the extrinsic                                                 r̄ e−iΦ̄(f ) Ss (f ),3.0
parameters. The initial “burn-in” phase can be acceler-                                         r̄w =                                  (32),0.0
                                                                                                               S(f ),111.0
ated by randomly trying out sky locations until one is,0.0
found that yields the correct time delays between the de-                is the whitened reference residual heterodyned by the,0.0
tectors to within some pre-defined tolerance. However                    reference phase and,0.0
the likelihood evaluation is so fast that such acceleration,0.0
                                                                                                     Ā(f ) − A(f )e−i∆Φ(f ),101.0
                                                                                                                             ,125.0
"is not necessary, and the chains can simply be initialized",0.0
                                                                                           ∆hw =                                       (33),91.0
at some random draw from the prior distribution. During                                                         1/2,0.0
                                                                                                              Ss (f ),110.0
the burn-in phase the extrinsic PTMCMC uses the same,0.0
"number of chains and the same temperature ladder as                      is the heterodyned difference in the waveforms, whitened",0.0
the intrinsic PTMCMC from the coherent search. Each                      by the smooth component of the amplitude spectral den-,0.0
chain inherits the intrinsic parameters from the search                  sity. The integrands in (30) and (31) can be written as,0.0
phase. A mixture of proposal distributions are employed:                 products of a slowly varying function s(f ) and a rapidly,0.0
Jumps along eigenvectors of the extrinsic Fisher matrix                  varying function r(f ). In equation (30) the numerator,0.0
avr_spaces,40.52
                                                                                                                      10,118.0
"is a slowly varying function, while the inverse of the      GW190924 021846, was chosen as it was one of the",0.0
"full power spectral density is a rapidly varying function   signals flagged for glitch removal.The second example,",0.0
"due to the spectral lines. In equation (31) the real and    GW190719 215514, was chosen as it has among the low-",0.0
"imaginary parts of ∆hw are slowly varying while the real    est signal-to-noise ratios, and thus posed more of a chal-",0.0
and imaginary parts of the heterodyned residual r̄w are     lenge for the initial search.,0.0
rapidly varying. The integrals (in practice sums over fre-     The prior ranges on the masses were set between,0.0
quency) can be evaluated accurately and rapidly using a     0.25M and 150M . The priors on the aligned spin com-,0.0
Legendre polynomial expansion. The sum over frequency       ponents were chosen to correspond to a uniform distri-,0.0
is broken up into bands of width ∆f and the discrete        bution of spin directions and magnitudes in an effort to,0.0
Legendre polynomial expansions of the rapidly varying       mimic the priors used in the reference LIGO/Virgo anal-,0.0
function r(f ) are computed once and stored for each fre-   yses which using the IMRPhenomPv2 precessing spin,0.0
quency band. Each frequency band covers M = Tobs ∆f         model [43]. The analyses shown here used the IMRPhe-,0.0
"frequencies, and the number of bands is K = 2fring /∆f ,    nomD phenomenological model [42], which describes the",0.0
"where fring is the ringdown frequency of the reference      dominant ` = |m| = 2 mode of a quasi-circular, spin-",0.0
waveform. The discrete values of the rapidly varying        aligned binary system. To stay within the domain of,0.0
function in each band can be expanded in a sum of dis-      validity of this model the maximum spin magnitude was,0.0
crete Legendre polynomials:                                 set to χmax = 0.85 and the maximum mass ratio was set,0.0
                                                            to m1 /m2 < 18.,60.0
                            XM,28.0
                      rk =      ρ` P` (k)             (34),22.0
                            `=0,28.0
where P` (k) are the discrete Legendre polynomials of or-,0.0
der ` [44] and the expansion coefficients are given by,0.0
                             XM,29.0
"                    ρ` = α`       P` (k)rk ,          (35)",20.0
                             k=0,29.0
where α` is a normalization constant. The contribution,0.0
to the inner products from each frequency band are given,0.0
by,0.0
                  XM          X 1,18.0
"                      sk rk '      α`−1 ρ` σ` ,       (36)",22.0
                  k=0          `=0,18.0
where σ` are the expansion coefficients for the slowly,0.0
varying function s(f ) and the sum has been restricted to,0.0
"just the first two terms in the Legendre expansion, which",0.0
"is usually sufficient when using short frequency bands,     FIG. 9: Time-frequency maps of LIGO Livingston data cen-",0.0
∆f ≤ 4 Hz. For the slowly varying function s(f ) the        tered at GPS time 1253326744. The black line indicates the,0.0
required expansion coefficients in the k < K frequency      reconstructed time-frequency track for GW190924 021846.,0.0
"band are given by σ0 = (s((k + 1)∆f ) + s(k∆f ))/2 and      The upper panel shows the raw whitened data, while the lower",0.0
σ1 = (s((k + 1)∆f ) − s(k∆f ))/2. The sum (36) includes     panel shows the whitened data after wavelet de-noising.,0.0
"the first and last bins in each frequency band, so there is",0.0
"a double counting of the contributions from these bins,        Figure 9 illustrates the output of the search phase and",0.0
which can be corrected for by subtracting the sum over      glitch removal for GW190924 021846. A moderately loud,0.0
the K − 2 repeated values values. The heterodyning pro-     glitch that intersects the time-frequency track of the sig-,0.0
cedure speeds up the likelihood calculations by a factor    nal was identified and removed from the data.,0.0
"of ∼ M , with the largest speed up being for low mass,         Figure 10 compares the output of the full QuickCBC",0.0
long duration signals such as those from binary neutron     analysis using the internally de-noised with the pub-,0.0
star mergers.                                               licly released LALinference samples available from the,0.0
                                                            GWOSC website. The LALinference used a BayesWave,60.0
                                                            PSD and glitch model. The results show good agree-,60.0
"              G.   Examples from GWTC-2                     ment, the main difference being that the QuickCBC anal-",14.0
                                                            ysis took a few minutes while the LALinference analysis,60.0
"   To illustrate the performance of the sampler, two ex-    took a few days.",3.0
amples were chosen from the second Gravitational Wave          Figure 11 compares the QuickCBC and LALinference,0.0
"Transient Catalog, GWTC-2 [3]. The first example,           analyses for the low signal-to-noise ratio event",0.0
avr_spaces,10.333333333333334
                                                                                                                 11,113.0
                                                         iterations. The posterior distributions from the two,57.0
                                                         samplers are again in good agreement.,57.0
                                                                             III.  SUMMARY,77.0
"                                                            The QuickCBC analysis pipeline is an end-to-end, open-",60.0
                                                         source tool for gravitational wave data analysis. Its key,57.0
                                                         features are speed and robustness against noise tran-,57.0
                                                         sients. The main limitation of the pipeline is that it,57.0
                                                         currently only works with the IMRPhenomD waveform,57.0
                                                         model. A near-term development goal is to expand,57.0
"                                                         the range of waveform models, starting with the IM-",57.0
"                                                         RPhenomHM model [45], which includes contributions",57.0
"                                                         from higher modes, and the IMRPhenomD NRTidal",57.0
                                                         model [46] which includes tidal effects for binanry neu-,57.0
                                                         tron star mergers. A longer term goal is to add precessing,57.0
                                                         spin models.,57.0
                                                            Possible uses for the QuickCBC pipeline for researchers,60.0
                                                         outside the LIGO/Virgo collaboration are as a platform,57.0
                                                         to develop novel analyses that can be applied to the pub-,57.0
FIG. 10:      A comparison of parameter inference for    licly released data. Within the LIGO/Virgo collabora-,0.0
GW190924 021846 showing the preferred LALinference IM-   tion the pipeline could be used to generate low latency,0.0
"RPhenomPv2 samples and the QuickCBC IMRPhenomD sam-      sky maps, and to provide estimates for how likely it is",0.0
ples.                                                    that the system will result in the disruption of a neu-,0.0
"                                                         tron star, and thus a good candidate for producing an",57.0
                                                         electromagnetic counterpart.,57.0
                                                                             Acknowledgments,77.0
                                                            The author is grateful for the support provided by,60.0
                                                         NSF award PHY1912053. This work was initiated while,57.0
                                                         the author was on sabbatical at the Observatoire de la,57.0
"                                                         Côte d’Azur, kindly hosted by Nelson Christensen. Dis-",57.0
"                                                         cussions with Tyson Littenberg, Katerina Chatziioannou",57.0
                                                         and Marcella Wijngaarden were very helpful. The author,57.0
                                                         greatly appreciates Marcella Wijngaarden’s help in track-,57.0
"                                                         ing down an error in the sky localization algorithm, Char-",57.0
                                                         lie Hoy’s help in extracting the LALinference samples,57.0
                                                         and Bence Bécsy’s for writing the scripts for automating,57.0
                                                         the running of the pipeline in response to triggers from,57.0
                                                         the Gravitational-Wave Candidate Event Database. The,57.0
                                                         author appreciates feedback on a draft version from Will,57.0
                                                         Farr and Nelson Christensen. This research has made,57.0
                                                         use of data obtained from the Gravitational Wave Open,57.0
"                                                         Science Center (https://www.gw-openscience.org), a ser-",57.0
"FIG. 11:      A comparison of parameter inference for    vice of LIGO Laboratory, the LIGO Scientific Collabo-",0.0
GW190719 215514 showing the preferred LALinference IM-   ration and the Virgo Collaboration. LIGO is funded by,0.0
RPhenomPv2 samples and the QuickCBC IMRPhenomD sam-      the U.S. National Science Foundation. Virgo is funded,0.0
ples.                                                    by the French Centre National de Recherche Scientifique,0.0
"GW190719 215514.        The weakness of the signal       (CNRS), the Italian Istituto Nazionale della Fisica Nu-",0.0
"posed no obstacle to the QuickCBC analysis, with the     cleare (INFN) and the Dutch Nikhef, with contributions",0.0
search phase locking onto the signal after a few hundred by Polish and Hungarian institutes.,0.0
avr_spaces,45.42
                                                                                                                            12,124.0
" [1] B. P. Abbott et al. (Virgo, LIGO Scientific), Phys. Rev.  [16] N. J. Cornish, T. B. Littenberg, B. Bécsy, K. Chatziioan-",1.0
"     X6, 041015 (2016), 1606.04856.                                 nou, J. A. Clark, S. Ghonge, and M. Millhouse (2020),",5.0
" [2] B. Abbott et al. (LIGO Scientific, Virgo), Phys. Rev. X        2011.09494.",1.0
"     9, 031040 (2019), 1811.12907.                             [17] B. P. Abbott et al. (LIGO Scientific, Virgo), Class.",5.0
" [3] R. Abbott et al. (LIGO Scientific, Virgo) (2020),              Quant. Grav. 37, 055002 (2020), 1908.11170.",1.0
"     2010.14527.                                               [18] B. P. Abbott, R. Abbott, T. D. Abbott, M. R. Aber-",5.0
" [4] C. Messick, K. Blackburn, P. Brady, P. Brockill, K. Can-       nathy, F. Acernese, K. Ackley, C. Adams, T. Adams,",1.0
"     non, R. Cariou, S. Caudill, S. J. Chamberlin, J. D.            P. Addesso, R. X. Adhikari, et al., Classical and Quan-",5.0
"     Creighton, R. Everett, et al., Physical Review D 95            tum Gravity 35, 065010 (2018), ISSN 1361-6382, URL",5.0
"     (2017), ISSN 2470-0029, URL http://dx.doi.org/10.              http://dx.doi.org/10.1088/1361-6382/aaaafa.",5.0
"     1103/PhysRevD.95.042001.                                  [19] B. Allen, Phys. Rev. D 71, 062001 (2005), gr-qc/0405045.",5.0
" [5] S. Klimenko, G. Vedovato, M. Drago, F. Salemi, V. Ti-     [20] S. A. Usman et al., Class. Quant. Grav. 33, 215004",1.0
"     wari, G. Prodi, C. Lazzaro, K. Ackley, S. Tiwari,              (2016), 1508.02357.",5.0
"     C. Da Silva, et al., Physical Review D 93 (2016),         [21] N. J. Cornish and T. B. Littenberg, Class. Quant. Grav.",5.0
"     ISSN 2470-0029, URL http://dx.doi.org/10.1103/                 32, 135012 (2015), 1410.3835.",5.0
"     PhysRevD.93.042004.                                       [22] T. B. Littenberg and N. J. Cornish, Phys. Rev. D",5.0
" [6] T. D. Canton, A. H. Nitz, B. Gadre, G. S. Davies,              91, 084034 (2015), URL https://link.aps.org/doi/",1.0
"     V. Villa-Ortega, T. Dent, I. Harry, and L. Xiao, Real-         10.1103/PhysRevD.91.084034.",5.0
"     time search for compact binary mergers in advanced ligo   [23] B. Abbott et al. (LIGO Scientific, Virgo), Phys. Rev.",5.0
"     and virgo’s third observing run using pycbc live (2020),       Lett. 119, 161101 (2017), 1710.05832.",5.0
"     2008.07494.                                               [24] C. Pankow et al., Phys. Rev. D 98, 084016 (2018),",5.0
" [7] T. Adams, D. Buskulic, V. Germain, G. M. Guidi,                1808.03619.",1.0
"     F. Marion, M. Montani, B. Mours, F. Piergiovanni, and     [25] L. P. Singer and L. R. Price, Phys. Rev. D 93, 024013",5.0
"     G. Wang, Classical and Quantum Gravity 33, 175012              (2016), 1508.03634.",5.0
"     (2016), ISSN 1361-6382, URL http://dx.doi.org/10.         [26] C. Pankow, P. Brady, E. Ochsner, and R. O’Shaughnessy,",5.0
"     1088/0264-9381/33/17/175012.                                   Phys. Rev. D 92, 023002 (2015), 1502.04370.",5.0
" [8] Q. Chu, Ph.D. thesis, The University of Western Aus-      [27] D. George and E. Huerta, Phys. Lett. B 778, 64 (2018),",1.0
     tralia (2017).                                                 1711.03121.,5.0
" [9] J. Veitch, V. Raymond, B. Farr, W. Farr, P. Graff, S. Vi- [28] D. Wysocki, R. O’Shaughnessy, J. Lange, and Y.-L. L.",1.0
"     tale, B. Aylott, K. Blackburn, N. Christensen, M. Cough-       Fang, Phys. Rev. D 99, 084026 (2019), 1902.04934.",5.0
"     lin, et al., Physical Review D 91 (2015), ISSN 1550-      [29] R. J. Smith, G. Ashton, A. Vajpeyi, and C. Talbot, Mon.",5.0
"     2368, URL http://dx.doi.org/10.1103/PhysRevD.91.               Not. Roy. Astron. Soc. 498, 4492 (2020), 1909.11873.",5.0
"     042003.                                                   [30] A. Delaunoy, A. Wehenkel, T. Hinderer, S. Nissanke,",5.0
"[10] G. Ashton, M. Hübner, P. D. Lasky, C. Talbot, K. Ack-         C. Weniger, A. R. Williamson, and G. Louppe (2020),",0.0
"     ley, S. Biscoveanu, Q. Chu, A. Divakarla, P. J. Easter,        2010.12931.",5.0
"     B. Goncharov, et al., The Astrophysical Journal Sup-      [31] C. Torrence and G. P. Compo, Bulletin of the American",5.0
"     plement Series 241, 27 (2019), ISSN 1538-4365, URL             Meteorological Society 79, 61 (1998).",5.0
"     http://dx.doi.org/10.3847/1538-4365/ab06fc.               [32] N. J. Cornish (2010), 1007.4820.",5.0
"[11] A. D. Viets, M. Wade, A. L. Urban, S. Kand-               [33] N. J. Cornish and K. Shuman, Phys. Rev. D 101, 124008",0.0
"     hasamy, J. Betzwieser, D. A. Brown, J. Burguet-Castell,        (2020), 2005.03610.",5.0
"     C. Cahillane, E. Goetz, K. Izumi, et al., Classical and   [34] K. Chatziioannou, N. J. Cornish, M. Wijngaarden, and",5.0
"     Quantum Gravity 35, 095015 (2018), ISSN 1361-6382,             T. B. Littenberg (2020), unpublished Manuscript.",5.0
"     URL http://dx.doi.org/10.1088/1361-6382/aab658.           [35] K. Chatziioannou, N. Cornish, M. Wijngaarden, and",5.0
"[12] V. Collaboration, F. Acernese, T. Adams, K. Agatsuma,          T. B. Littenberg (2021), 2101.01200.",0.0
"     L. Aiello, A. Allocca, M. A. Aloy, A. Amato, S. Antier,   [36] R. H. Swendsen and J.-S. Wang, Phys. Rev. Lett.",5.0
"     M. Arène, et al., Calibration of advanced virgo and re-       57, 2607 (1986), URL https://link.aps.org/doi/10.",5.0
     construction of the gravitational wave signal h(t) during      1103/PhysRevLett.57.2607.,5.0
"     the observing run o2 (2018), 1807.03275.                  [37] N. J. Cornish (2016), 1606.00953.",5.0
"[13] J. Driggers, S. Vitale, A. Lundgren, M. Evans,            [38] T. B. Littenberg and N. J. Cornish, Physical Review D",0.0
"     K. Kawabe, S. Dwyer, K. Izumi, R. Schofield, A. Effler,        80 (2009), ISSN 1550-2368, URL http://dx.doi.org/",5.0
"     D. Sigg, et al., Physical Review D 99 (2019), ISSN 2470-       10.1103/PhysRevD.80.063007.",5.0
"     0029, URL http://dx.doi.org/10.1103/PhysRevD.99.          [39] W. D. Vousden, W. M. Farr, and I. Mandel, Monthly No-",5.0
"     042001.                                                        tices of the Royal Astronomical Society 455, 1919–1937",5.0
"[14] D. Davis, T. Massinger, A. Lundgren, J. C. Driggers,           (2015), ISSN 1365-2966, URL http://dx.doi.org/10.",0.0
"     A. L. Urban, and L. Nuttall, Classical and Quantum             1093/mnras/stv2422.",5.0
"     Gravity 36, 055011 (2019), ISSN 1361-6382, URL http:      [40] C. J. Ter Braak, Statistics and Computing 16, 239",5.0
     //dx.doi.org/10.1088/1361-6382/ab01c5.                         (2006).,5.0
"[15] G. Vajente, Y. Huang, M. Isi, J. Driggers, J. Kissel,     [41] S. Husa, S. Khan, M. Hannam, M. Pürrer, F. Ohme,",0.0
"     M. Szczepańczyk, and S. Vitale, Physical Review D 101         X. Jiménez Forteza, and A. Bohé, Phys. Rev. D 93,",5.0
"     (2020), ISSN 2470-0029, URL http://dx.doi.org/10.              044006 (2016), 1508.07250.",5.0
"     1103/PhysRevD.101.042003.                                 [42] S. Khan, S. Husa, M. Hannam, F. Ohme, M. Pürrer,",5.0
avr_spaces,5.761904761904762
                                                                                                                        13,120.0
"     X. Jiménez Forteza, and A. Bohé, Phys. Rev. D 93,       [45] L. London, S. Khan, E. Fauchon-Jones, C. Garcı́a,",5.0
"     044007 (2016), 1508.07253.                                     M. Hannam, S. Husa, X. Jiménez-Forteza, C. Kalaghatgi,",5.0
"[43] M. Hannam, P. Schmidt, A. Bohé, L. Haegel, S. Husa,           F. Ohme, and F. Pannarale, Phys. Rev. Lett. 120,",0.0
"     F. Ohme, G. Pratten, and M. Pürrer, Physical Review           161102 (2018), URL https://link.aps.org/doi/10.",5.0
"     Letters 113 (2014), ISSN 1079-7114, URL http://dx.             1103/PhysRevLett.120.161102.",5.0
"     doi.org/10.1103/PhysRevLett.113.151101.                   [46] T. Dietrich, S. Khan, R. Dudi, S. J. Kapadia, P. Ku-",5.0
"[44] C. P. Neuman and D. I. Schonbach, International Jour-          mar, A. Nagar, F. Ohme, F. Pannarale, A. Samaj-",0.0
"     nal for Numerical Methods in Engineering 8, 743 (1974),        dar, S. Bernuzzi, et al., Physical Review D 99 (2019),",5.0
"     https://onlinelibrary.wiley.com/doi/pdf/10.1002/nme.1620080406,ISSN 2470-0029, URL http://dx.doi.org/10.1103/",5.0
     URL https://onlinelibrary.wiley.com/doi/abs/10.                PhysRevD.99.024029.,5.0
     1002/nme.1620080406.,5.0
avr_spaces,12.692307692307692
