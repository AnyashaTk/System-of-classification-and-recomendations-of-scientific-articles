text,space_num,symbolic_percent,space_percent,num_world,num_columns,front_spaces_perc,back_spaces
                                                                       Reconstructing Patchy Reionization with Deep Learning,71.0,0.3870967741935484,0.6129032258064516,6.0,1.0,0.3736842105263158,0.34736842105263155
                                                                                              Eric Guzman1 and Joel Meyers1,94.0,0.2032520325203252,0.7967479674796748,5.0,1.0,0.49473684210526314,0.3526315789473684
                                                           1,59.0,0.016666666666666666,0.9833333333333333,1.0,1.0,0.3105263157894737,0.6842105263157895
"                                                               Department of Physics, Southern Methodist University, 3215 Daniel Ave, Dallas, TX 75275, USA",63.0,0.5161290322580645,0.4838709677419355,13.0,1.0,0.33157894736842103,0.1842105263157895
"                                                                                                (Dated: August 23, 2021)",96.0,0.175,0.825,4.0,1.0,0.5052631578947369,0.368421052631579
                                                                  The precision anticipated from next-generation cosmic microwave background (CMB) surveys will,66.0,0.5220125786163522,0.4779874213836478,11.0,1.0,0.3473684210526316,0.16315789473684206
                                                               create opportunities for characteristically new insights into cosmology. Secondary anisotropies of,63.0,0.546583850931677,0.45341614906832295,11.0,1.0,0.33157894736842103,0.15263157894736845
"                                                               the CMB will have an increased importance in forthcoming surveys, due both to the cosmological",63.0,0.5095541401273885,0.49044585987261147,15.0,1.0,0.33157894736842103,0.17368421052631577
                                                               information they encode and the role they play in obscuring our view of the primary fluctuations.,63.0,0.5125,0.48750000000000004,16.0,1.0,0.33157894736842103,0.1578947368421053
                                                               Quadratic estimators have become the standard tools for reconstructing the fields that distort the,63.0,0.5279503105590062,0.4720496894409938,14.0,1.0,0.33157894736842103,0.15263157894736845
                                                               primary CMB and produce secondary anisotropies. While successful for lensing reconstruction with,63.0,0.5345911949685535,0.46540880503144655,12.0,1.0,0.33157894736842103,0.16315789473684206
"                                                               current data, quadratic estimators will be sub-optimal for the reconstruction of lensing and other",63.0,0.5279503105590062,0.4720496894409938,14.0,1.0,0.33157894736842103,0.15263157894736845
arXiv:2101.01214v2 [astro-ph.CO] 20 Aug 2021,0.0,0.9090909090909091,0.09090909090909094,5.0,1.0,0.0,0.7684210526315789
                                                               effects at the expected sensitivity of the upcoming CMB surveys. In this paper we describe a,63.0,0.4967741935483871,0.5032258064516129,16.0,1.0,0.33157894736842103,0.1842105263157895
"                                                               convolutional neural network, ResUNet-CMB, that is capable of the simultaneous reconstruction",63.0,0.532051282051282,0.46794871794871795,11.0,1.0,0.33157894736842103,0.17894736842105263
"                                                               of two sources of secondary CMB anisotropies, gravitational lensing and patchy reionization. We",63.0,0.5253164556962026,0.47468354430379744,13.0,1.0,0.33157894736842103,0.16842105263157892
                                                               show that the ResUNet-CMB network significantly outperforms the quadratic estimator at low noise,63.0,0.5283018867924528,0.4716981132075472,13.0,1.0,0.33157894736842103,0.16315789473684206
                                                               levels and is not subject to the lensing-induced bias on the patchy reionization reconstruction that,63.0,0.5276073619631901,0.47239263803680986,15.0,1.0,0.33157894736842103,0.14210526315789473
                                                               would be present with a straightforward application of the quadratic estimator.,63.0,0.4859154929577465,0.5140845070422535,11.0,1.0,0.33157894736842103,0.25263157894736843
"                                                                  I.   INTRODUCTION                                coefficients, and cause the observed statistics to be non-",66.0,0.3699421965317919,0.630057803468208,11.0,18.0,0.3473684210526316,0.08947368421052626
                                                                                                                   stationary. This change to the statistics can be observed,115.0,0.28488372093023256,0.7151162790697674,9.0,1.0,0.6052631578947368,0.09473684210526312
"                                                  Observations of the cosmic microwave background                  in the data, and thereby can be used to reconstruct the",50.0,0.5117647058823529,0.4882352941176471,17.0,10.0,0.2631578947368421,0.10526315789473684
"                                               (CMB) have provided a wealth of cosmological informa-               field causing the distortion [25, 26].",47.0,0.5163398692810458,0.4836601307189542,14.0,8.0,0.24736842105263157,0.1947368421052632
"                                               tion. The coming generation of CMB surveys, includ-                    The standard technique for reconstructing distortions",47.0,0.5380116959064327,0.4619883040935673,14.0,11.0,0.24736842105263157,0.09999999999999998
"                                               ing those from Simons Observatory [1], CCAT-prime [2],              of the CMB fluctuations utilizes a quadratic estimator,",47.0,0.5588235294117647,0.4411764705882353,16.0,8.0,0.24736842105263157,0.10526315789473684
"                                               CMB-S4 [3], PICO [4], and CMB-HD [5], will map the                  constructed from a weighted product of two factors of",47.0,0.5119047619047619,0.48809523809523814,19.0,10.0,0.24736842105263157,0.11578947368421055
                                               CMB with unprecedented precision. In addition to pro-               CMB fluctuations [25]. The quadratic estimator has been,47.0,0.5529411764705883,0.44705882352941173,16.0,8.0,0.24736842105263157,0.10526315789473684
                                               viding greater sensitivity to primary CMB intensity and             used to great success to detect the effects of gravita-,47.0,0.5529411764705883,0.44705882352941173,18.0,7.0,0.24736842105263157,0.10526315789473684
"                                               polarization fluctuations, next generation observations             tional lensing at high significance with existing CMB sur-",47.0,0.5838150289017341,0.4161849710982659,14.0,7.0,0.24736842105263157,0.08947368421052626
                                               will allow for much more precise measurements of sec-               veys [27–29]. While the quadratic estimator works well,47.0,0.5443786982248521,0.4556213017751479,17.0,8.0,0.24736842105263157,0.1105263157894737
"                                               ondary CMB anisotropies [6].                                        with current data, it will be sub-optimal at the sensitivity",47.0,0.4342857142857143,0.5657142857142857,14.0,21.0,0.24736842105263157,0.07894736842105265
                                                  Secondary anisotropies of the CMB are generated by               anticipated in the next generation of CMB surveys. One,50.0,0.5266272189349113,0.47337278106508873,17.0,8.0,0.2631578947368421,0.1105263157894737
                                               interaction of CMB photons with structure which in-                 reason for this is that higher order effects of the sources of,47.0,0.536723163841808,0.46327683615819204,20.0,9.0,0.24736842105263157,0.06842105263157894
                                               tervenes between our telescopes and the surface of last             secondary anisotropies become too important to ignore in,47.0,0.5614035087719298,0.4385964912280702,17.0,7.0,0.24736842105263157,0.09999999999999998
"                                               scattering. Prominent sources of secondary anisotropies             very high fidelity CMB maps, and use of the quadratic",47.0,0.5595238095238095,0.44047619047619047,16.0,7.0,0.24736842105263157,0.11578947368421055
                                               include weak gravitational lensing by large-scale struc-            estimator results in an estimate of the distortion field,47.0,0.5730994152046783,0.42690058479532167,16.0,7.0,0.24736842105263157,0.09999999999999998
                                               ture (see [7] for a review); the various manifestations             whose variance is limited by secondary anistropies rather,47.0,0.563953488372093,0.436046511627907,17.0,7.0,0.24736842105263157,0.09473684210526312
"                                               of the Sunyaev-Zel’dovich effect [8–12], which describe             than by instrumental noise. This challenge can be over-",47.0,0.5647058823529412,0.43529411764705883,16.0,7.0,0.24736842105263157,0.10526315789473684
"                                               Compton scattering of CMB photons with free electrons               come by using maximum likelihood estimators [30, 31] or",47.0,0.5470588235294118,0.4529411764705882,17.0,8.0,0.24736842105263157,0.10526315789473684
                                               in galaxy clusters and the intergalactic medium; the in-            by iteratively removing the effects of the secondaries [32].,47.0,0.5714285714285714,0.4285714285714286,18.0,7.0,0.24736842105263157,0.07894736842105265
"                                               tegrated Sachs-Wolfe [13] and Rees-Sciama effects [14],             Another limiting factor in the use of the quadratic esti-",47.0,0.563953488372093,0.436046511627907,17.0,7.0,0.24736842105263157,0.09473684210526312
                                               characterizing how time-dependent gravitational poten-              mator is that the presence of more than one distortion,47.0,0.5621301775147929,0.4378698224852071,15.0,8.0,0.24736842105263157,0.1105263157894737
                                               tials alter the energy of CMB photons; and the moving               field can lead to biases in the reconstructed fields. This,47.0,0.5375722543352601,0.4624277456647399,20.0,8.0,0.24736842105263157,0.08947368421052626
"                                               lens effect [15], where the transverse motion of massive            bias can be avoided at the cost of increased variance with",47.0,0.5549132947976878,0.4450867052023122,20.0,7.0,0.24736842105263157,0.08947368421052626
                                               objects imprints temperature fluctuations on the CMB.               the use of ‘bias-hardened’ estimators [33].,47.0,0.5379746835443038,0.4620253164556962,13.0,8.0,0.24736842105263157,0.16842105263157892
                                               The sensitivity of upcoming experiments should allow                   One of the main motivations for an accurate recon-,47.0,0.5238095238095238,0.47619047619047616,16.0,10.0,0.24736842105263157,0.11578947368421055
                                               some of these effects to be detected for the first time in          struction of the CMB lensing field is related to the search,47.0,0.5517241379310345,0.4482758620689655,23.0,6.0,0.24736842105263157,0.08421052631578951
                                               the coming years [16–24]. These secondary anisotropies              for primordial gravitational waves. CMB polarization,47.0,0.5688622754491018,0.43113772455089816,13.0,8.0,0.24736842105263157,0.12105263157894741
                                               act both as a source of cosmological information and as             can be split into curl-free E modes and divergence-free,47.0,0.5470588235294118,0.4529411764705882,19.0,7.0,0.24736842105263157,0.10526315789473684
"                                               a source of confusion for the primary anisotropies.                 B modes, the latter of which are generated by primor-",47.0,0.5238095238095238,0.47619047619047616,18.0,9.0,0.24736842105263157,0.11578947368421055
"                                                  Sources of secondary anisotropies can be reconstructed           dial gravitational waves, but not by density fluctuations",50.0,0.5697674418604651,0.43023255813953487,15.0,6.0,0.2631578947368421,0.09473684210526312
"                                               due to the changes they imprint on the statistics of                at linear order [34, 35]. Gravitational lensing of the",47.0,0.5266272189349113,0.47337278106508873,19.0,9.0,0.24736842105263157,0.1105263157894737
"                                               the primary CMB fluctuations. In particular, the pri-               CMB can convert E-mode polarization into B-mode po-",47.0,0.5421686746987951,0.45783132530120485,16.0,8.0,0.24736842105263157,0.12631578947368416
"                                               mary CMB anisotropies are expected to be well described             larization, and these lensing-induced B modes act as a",47.0,0.5502958579881657,0.4497041420118343,18.0,7.0,0.24736842105263157,0.1105263157894737
                                               by nearly Gaussian fluctuations that can be fully char-             source of confusion in searches for primordial gravita-,47.0,0.5588235294117647,0.4411764705882353,17.0,7.0,0.24736842105263157,0.10526315789473684
"                                               acterized by their power spectra C` . Sources of sec-               tional waves [36, 37]. With an estimate of the lensing",47.0,0.5266272189349113,0.47337278106508873,20.0,8.0,0.24736842105263157,0.1105263157894737
"                                               ondary anisotropies break rotational invariance, induce             field, it is possible to delens the CMB, thereby removing",47.0,0.5697674418604651,0.43023255813953487,16.0,7.0,0.24736842105263157,0.09473684210526312
                                               off-diagonal correlations between the spherical harmonic            some of the lensing B modes enabling greater sensitivity,47.0,0.5789473684210527,0.42105263157894735,15.0,7.0,0.24736842105263157,0.09999999999999998
avr_spaces,53.11864406779661,1.0,0.0,1.0,1.0,0.27957181088314004,0.9473684210526316
                                                                                                                                   2,131.0,0.007575757575757576,0.9924242424242424,1.0,1.0,0.6894736842105263,0.3052631578947368
to primordial gravitational waves [38–40].                   machine learning is capable of producing promising re-,0.0,0.7391304347826086,0.26086956521739135,13.0,10.0,0.0,0.39473684210526316
    Delensing the CMB is useful beyond the benefits it       sults for lensing reconstruction and delensing at noise,4.0,0.7758620689655172,0.22413793103448276,17.0,4.0,0.021052631578947368,0.3894736842105263
provides for primordial gravitational wave searches [41].    levels where the quadratic estimator is sub-optimal [77].,0.0,0.8559322033898306,0.14406779661016944,15.0,3.0,0.0,0.3789473684210526
"For example, delensing the temperature and E-mode po-        The focus of this work is to extend the techniques of",0.0,0.7807017543859649,0.2192982456140351,19.0,5.0,0.0,0.4
"larization leads to sharper peaks in the power spectra,      Ref. [77] to the simultaneous reconstruction of CMB lens-",0.0,0.8135593220338984,0.18644067796610164,18.0,4.0,0.0,0.3789473684210526
"allowing for a better determination of parameters which      ing and patchy reionization. As described above, recon-",0.0,0.8275862068965517,0.1724137931034483,16.0,4.0,0.0,0.3894736842105263
"impact peak positions [41, 42]. Delensing can also re-       structing patchy reionization in the presence of lensing",0.0,0.811965811965812,0.18803418803418803,17.0,4.0,0.0,0.38421052631578945
duce the off-diagonal covariance induced by lensing [41]     is challenging due to the extra variance coming from,0.0,0.8230088495575221,0.17699115044247793,17.0,3.0,0.0,0.4052631578947369
and thereby improve the sensitivity of the CMB to other      lensing-induced B-mode polarization and by the bias,0.0,0.8125,0.1875,17.0,4.0,0.0,0.41052631578947374
"effects, such as primordial non-Gaussianity [43].            that can result from the sensitivity of the patchy reion-",0.0,0.7796610169491526,0.22033898305084743,16.0,7.0,0.0,0.3789473684210526
    In order to achieve the goals of next generation CMB     ization estimator to the effects of lensing. A main goal,4.0,0.7692307692307693,0.23076923076923073,20.0,3.0,0.021052631578947368,0.38421052631578945
"surveys, delensing will be necessary (see e.g. [3, 44, 45]). of this work is to determine the extent to which machine",0.0,0.8290598290598291,0.1709401709401709,21.0,1.0,0.0,0.38421052631578945
"However, achieving the required delensing performance        learning is capable of surmounting these challenges.",0.0,0.831858407079646,0.16814159292035402,13.0,5.0,0.0,0.4052631578947369
is not without challenges. Delensing algorithms that,0.0,0.8846153846153846,0.11538461538461542,7.0,1.0,0.0,0.7263157894736842
go beyond the quadratic estimator are under develop-,0.0,0.8653846153846154,0.13461538461538458,8.0,1.0,0.0,0.7263157894736842
"ment, but the implementations can be computationally                      II.    QUADRATIC ESTIMATOR",0.0,0.67,0.32999999999999996,10.0,14.0,0.0,0.4736842105263158
"intensive [31, 46–48]. In the near-term, delensing the",0.0,0.8703703703703703,0.12962962962962965,8.0,1.0,0.0,0.7157894736842105
CMB using external tracers of the lensing field holds           In this section we will review the construction of the,0.0,0.7627118644067796,0.23728813559322037,19.0,6.0,0.0,0.3789473684210526
"promise [49], though at improved sensitivity, internal de-   quadratic estimator for CMB lensing [25] and for patchy",0.0,0.8448275862068966,0.15517241379310343,17.0,2.0,0.0,0.3894736842105263
"lensing, whereby the CMB is delensed using a map of          reionization [65]. The quadratic estimator has become",0.0,0.7807017543859649,0.2192982456140351,17.0,6.0,0.0,0.4
the lensing field reconstructed from the observed CMB        the standard technique for lensing reconstruction with,0.0,0.8173913043478261,0.18260869565217386,15.0,5.0,0.0,0.39473684210526316
"map, will be necessary to achieve the best delensing per-    current data, though it will be sub-optimal with the high",0.0,0.8135593220338984,0.18644067796610164,20.0,3.0,0.0,0.3789473684210526
formance [32]. Internal delensing can lead to biases in      precision data expected from future CMB surveys [31].,0.0,0.8157894736842105,0.1842105263157895,17.0,4.0,0.0,0.4
"the delensed CMB map, though these biases can be mit-        We will also discuss how the estimator for the spatial",0.0,0.7739130434782608,0.22608695652173916,20.0,5.0,0.0,0.39473684210526316
igated without much loss in sensitivity by splitting the     variation of the optical depth is biased in the presence of,0.0,0.8083333333333333,0.19166666666666665,20.0,3.0,0.0,0.368421052631579
data appropriately [50].                                     lensing [73].,0.0,0.4594594594594595,0.5405405405405406,5.0,19.0,0.0,0.6105263157894737
"    Reionization, the process by which the neutral gas",4.0,0.7962962962962963,0.20370370370370372,8.0,1.0,0.021052631578947368,0.7157894736842105
filling the Universe became ionized by the first stars,0.0,0.8518518518518519,0.14814814814814814,9.0,1.0,0.0,0.7157894736842105
"and galaxies between redshifts of about 20 and 6, was                      A.     Weak Gravitational Lensing",0.0,0.6481481481481481,0.35185185185185186,14.0,14.0,0.0,0.43157894736842106
a complex and non-uniform process [51–59]. The spa-,0.0,0.8627450980392157,0.13725490196078427,8.0,1.0,0.0,0.7315789473684211
tial variations or patchiness in the process of reioniza-       Cosmological structure which intervenes between our,0.0,0.8260869565217391,0.17391304347826086,15.0,4.0,0.0,0.39473684210526316
tion leads to effects on the observed CMB temperature        telescopes and the CMB surface of last scattering gen-,0.0,0.7913043478260869,0.20869565217391306,18.0,5.0,0.0,0.39473684210526316
and polarization [60–71]. Patchy reionization can pro-       erates gravitational potentials which deflect CMB pho-,0.0,0.8347826086956521,0.16521739130434787,14.0,4.0,0.0,0.39473684210526316
"duce B-mode polarization, either by the modulation of        tons [7]. In real space this effect can be understood",0.0,0.7894736842105263,0.21052631578947367,18.0,5.0,0.0,0.4
E-mode polarization or by scattering of remote temper-       as a re-mapping of the unlensed CMB by a direction-,0.0,0.7946428571428571,0.2053571428571429,18.0,4.0,0.0,0.41052631578947374
"ature quadrupoles, and these secondary B modes can           dependent deflection angle,",0.0,0.7727272727272727,0.2272727272727273,11.0,6.0,0.0,0.5368421052631579
potentially act as a source of confusion in searches for,0.0,0.8392857142857143,0.1607142857142857,10.0,1.0,0.0,0.7052631578947368
"primordial gravitational waves [72].                                        T len (n̂) = T prim (n̂ + ∇φ(n̂)) ,",0.0,0.5315315315315315,0.46846846846846846,14.0,21.0,0.0,0.4157894736842105
"    Quadratic estimators have been designed to recon-          (Qlen ± iU len )(n̂) = (Qprim ± iU prim )(n̂ + ∇φ(n̂)) , (1)",4.0,0.7235772357723578,0.2764227642276422,22.0,6.0,0.021052631578947368,0.3526315789473684
struct the spatial variations in optical depth that result,0.0,0.8620689655172413,0.13793103448275867,9.0,1.0,0.0,0.6947368421052631
"from patchy reionization [65, 66]. However, when ap-         where (T prim , Qprim , U prim ) are the primordial CMB",0.0,0.7586206896551724,0.24137931034482762,21.0,5.0,0.0,0.3894736842105263
"plied to maps of the lensed CMB, the patchy reioniza-        fields, φ is the lensing potential, n̂ is the line-of-sight",0.0,0.7833333333333333,0.21666666666666667,20.0,5.0,0.0,0.368421052631579
"tion quadratic estimator will be biased by the effects of    direction, and the superscript ‘len’ refers to the lensed",0.0,0.8220338983050848,0.17796610169491522,19.0,3.0,0.0,0.3789473684210526
"lensing, since both effects lead to mode-coupling and the    field [25]. In harmonic space, lensing of the CMB induces",0.0,0.8220338983050848,0.17796610169491522,19.0,3.0,0.0,0.3789473684210526
"estimators are not independent [73]. In principle, the       mode-coupling, or correlation, between fluctuations of",0.0,0.8347826086956521,0.16521739130434787,14.0,4.0,0.0,0.39473684210526316
lensing estimator is also biased by the presence of patchy   different wavenumbers `1 6= `2 that is proportional to the,0.0,0.8235294117647058,0.17647058823529416,20.0,2.0,0.0,0.37368421052631584
"reionization, though the bias to the lensing estimate is     lensing potential φ. In the flat-sky approximation [25],",0.0,0.8290598290598291,0.1709401709401709,17.0,3.0,0.0,0.38421052631578945
expected to be small because the effects of patchy reion-                                                φ,0.0,0.46226415094339623,0.5377358490566038,11.0,25.0,0.0,0.4421052631578948
ization are much smaller than those of lensing. These                 X len (`1 )Y len (`2 )  CMB,0.0,0.6597938144329897,0.3402061855670103,17.0,10.0,0.0,0.4894736842105263
"                                                                                                    ∝ fXY   (`1 , `2 )φ(`) ,     (2)",100.0,0.14393939393939395,0.8560606060606061,8.0,4.0,0.5263157894736842,0.3052631578947368
"biases can be mitigated with delensing, and they can be",0.0,0.8363636363636363,0.1636363636363637,10.0,1.0,0.0,0.7105263157894737
"                                                             where ` = `1 + `2 and (X, Y ) = (T, E, B). In this pa-",61.0,0.33043478260869563,0.6695652173913044,17.0,1.0,0.32105263157894737,0.39473684210526316
essentially avoided with bias-hardening at the cost of a,0.0,0.8571428571428571,0.1428571428571429,9.0,1.0,0.0,0.7052631578947368
                                                             per we focus on the EB mode-coupling since the corre-,61.0,0.38596491228070173,0.6140350877192983,10.0,1.0,0.32105263157894737,0.4
small increase to the variance of the estimator [73]. So,0.0,0.8392857142857143,0.1607142857142857,10.0,1.0,0.0,0.7052631578947368
                                                             sponding estimator has the lowest variance for the noise,61.0,0.41025641025641024,0.5897435897435898,9.0,1.0,0.32105263157894737,0.38421052631578945
"far, only upper limits on the effects of patchy reioniza-                                                               φ",0.0,0.4049586776859504,0.5950413223140496,11.0,32.0,0.0,0.3631578947368421
"tion exist [74, 75], though the effects may be detectable    levels we consider. For this case, the factor fXY             (`1 , `2 )",0.0,0.7218045112781954,0.27819548872180455,23.0,9.0,0.0,0.30000000000000004
in future data [76].                                         in Eq. (2) is defined as,0.0,0.4235294117647059,0.5764705882352941,10.0,21.0,0.0,0.5526315789473684
"    In this paper, we apply the techniques of machine             φ",4.0,0.6268656716417911,0.3731343283582089,10.0,7.0,0.021052631578947368,0.6473684210526316
"                                                                fEB  (`1 , `2 ) = (` · `1 )C`EE",64.0,0.22105263157894736,0.7789473684210526,10.0,2.0,0.3368421052631579,0.5
                                                                                    ,84.0,0.011764705882352941,0.9882352941176471,1.0,1.0,0.4421052631578947,0.5526315789473684
                                                                                                    − (` · `2 )C`BB,100.0,0.09565217391304348,0.9043478260869565,5.0,1.0,0.5263157894736842,0.39473684210526316
                                                                                                                      ,118.0,0.008403361344537815,0.9915966386554622,1.0,1.0,0.6210526315789474,0.37368421052631584
learning to reconstruct the effects of patchy reionization                                     1                  2,0.0,0.4608695652173913,0.5391304347826087,10.0,28.0,0.0,0.39473684210526316
in simulated CMB data. It has been shown recently that                                           × sin 2(ϕ(`1 ) − ϕ(`2 )) .      (3),0.0,0.5075757575757576,0.49242424242424243,19.0,25.0,0.0,0.3052631578947368
avr_spaces,11.764705882352942,1.0,0.0,1.0,1.0,0.061919504643962855,0.9473684210526316
                                                                                                                                                           3,155.0,0.00641025641025641,0.9935897435897436,1.0,1.0,0.8157894736842105,0.17894736842105263
"   The quadratic estimator provides a way of estimating                  and out of our line of sight. Next, Thomson scatter-",3.0,0.704,0.29600000000000004,18.0,10.0,0.015789473684210527,0.3421052631578947
any field leading to mode coupling by using a weighted                   ing of remote temperature quadrupoles on the free elec-,0.0,0.71875,0.28125,19.0,10.0,0.0,0.3263157894736842
product of pairs of observed CMB maps. The unbiased                      trons in ionized bubbles generates new polarization fluc-,0.0,0.7153846153846154,0.2846153846153846,17.0,12.0,0.0,0.3157894736842105
"minimum-variance EB quadratic estimator for the CMB                      tuations. Finally, the radial velocity of ionized bubbles",0.0,0.7307692307692307,0.2692307692307693,15.0,12.0,0.0,0.3157894736842105
gravitational lensing potential is given by [25]                         generates CMB temperature fluctuations through the ki-,0.0,0.7086614173228346,0.2913385826771654,14.0,13.0,0.0,0.3315789473684211
                                                                         netic Sunyaev-Zel’dovich effect.,73.0,0.2857142857142857,0.7142857142857143,3.0,1.0,0.38421052631578945,0.4473684210526315
                             d2 `1 obs,29.0,0.18421052631578946,0.8157894736842105,3.0,1.0,0.15263157894736842,0.8
                       Z,23.0,0.041666666666666664,0.9583333333333334,1.0,1.0,0.12105263157894737,0.8736842105263158
"               φ                                        φ                   For the purpose of this paper, we focus solely on the",15.0,0.3488372093023256,0.6511627906976745,13.0,30.0,0.07894736842105263,0.32105263157894737
"φ̂EB (`) =   NEB   (`)             E (`1 )B obs (`2 )FEB    (`1 , `2 ) ,",0.0,0.5277777777777778,0.4722222222222222,16.0,11.0,0.0,0.6210526315789473
"                            (2π)2                                        screening effect of patchy reionization, since we are inter-",28.0,0.42857142857142855,0.5714285714285714,10.0,21.0,0.14736842105263157,0.30000000000000004
                                                                   (4)   ested in the effect that can be reconstructed from obser-,67.0,0.3923076923076923,0.6076923076923078,11.0,2.0,0.3526315789473684,0.3157894736842105
with                                                                     vations of CMB polarization alone. The scattering effect,0.0,0.4108527131782946,0.5891472868217054,9.0,35.0,0.0,0.32105263157894737
                                                                         results in new polarization that is not correlated with the,73.0,0.3787878787878788,0.6212121212121212,10.0,1.0,0.38421052631578945,0.3052631578947368
                                       φ,39.0,0.025,0.975,1.0,1.0,0.20526315789473684,0.7894736842105263
"                 φ                   fEB  (`1 , `2 )                     polarization generated at the surface of last scattering,",17.0,0.46923076923076923,0.5307692307692308,14.0,21.0,0.08947368421052632,0.3157894736842105
"               FEB   (`1 , `2 ) =                    .             (5)",15.0,0.21428571428571427,0.7857142857142857,8.0,18.0,0.07894736842105263,0.631578947368421
"                                   C`EE,obs",35.0,0.18604651162790697,0.813953488372093,1.0,1.0,0.18421052631578946,0.7736842105263158
                                     1,37.0,0.02631578947368421,0.9736842105263158,1.0,1.0,0.19473684210526315,0.8
"                                            C`BB,obs",44.0,0.15384615384615385,0.8461538461538461,1.0,1.0,0.23157894736842105,0.7263157894736842
                                                2,48.0,0.02040816326530612,0.9795918367346939,1.0,1.0,0.25263157894736843,0.7421052631578947
                                                                         and the kinetic Sunyaev-Zel’dovich effect only produces,73.0,0.3828125,0.6171875,7.0,1.0,0.38421052631578945,0.3263157894736842
                                                                         temperature fluctuations.,73.0,0.24489795918367346,0.7551020408163265,2.0,1.0,0.38421052631578945,0.4842105263157894
The factor in front of Eq. (4) is an overall normalization                  The screening effect modulates the amplitude of the,0.0,0.7244094488188977,0.2755905511811023,19.0,10.0,0.0,0.3315789473684211
"factor defined as                                                        temperature and polarization anisotropies, scaling them",0.0,0.5078125,0.4921875,9.0,29.0,0.0,0.3263157894736842
                Z 2                                    −1              by a factor e−τ (n̂) . For the purpose of the simulations,16.0,0.4,0.6,15.0,26.0,0.08421052631578947,0.3157894736842105
"      φ                d `1 φ                 φ                          described below, we first apply modulation followed by",6.0,0.41732283464566927,0.5826771653543308,13.0,30.0,0.031578947368421054,0.3315789473684211
"    NEB (`) =                 f (`1 , `2 )FEB (`1 , `2 )       , (6)     lensing giving maps in real space according to",4.0,0.5714285714285714,0.4285714285714286,22.0,14.0,0.021052631578947368,0.37368421052631584
                      (2π)2 EB,22.0,0.23333333333333334,0.7666666666666666,2.0,1.0,0.11578947368421053,0.8421052631578947
which also gives the variance of the estimator. We define                                  T mod (n̂) = (T prim (n̂)e−τ (n̂) )len,0.0,0.6046511627906976,0.39534883720930236,19.0,18.0,0.0,0.32105263157894737
"each observed field as the lensed field plus noise,                        (Qmod ± iU mod )(n̂) = ((Qprim ± iU prim )(n̂)e−τ (n̂) )len ,",0.0,0.6691176470588235,0.3308823529411765,23.0,13.0,0.0,0.28421052631578947
                                                                                                                                                        (9),152.0,0.01935483870967742,0.9806451612903225,1.0,1.0,0.8,0.1842105263157895
"                 X obs (`) = X len (`) + N X (`) ,                 (7)",17.0,0.35714285714285715,0.6428571428571428,13.0,9.0,0.08947368421052632,0.631578947368421
                                                                         such that the superscript ’mod’ refers to maps that have,73.0,0.3643410852713178,0.6356589147286822,10.0,1.0,0.38421052631578945,0.32105263157894737
"where X = (T, E, B) and N X (`) is the noise correspond-                 been first modulated by patchy reionization then lensed.",0.0,0.7131782945736435,0.28682170542635654,22.0,9.0,0.0,0.32105263157894737
"ing to field X, which we take to be a Gaussian random                    This is an idealized treatment of the two effects, which in",0.0,0.6893939393939394,0.31060606060606055,23.0,11.0,0.0,0.3052631578947368
field whose power spectrum is given by                                   reality cannot be so cleanly separated in time. We further,0.0,0.6183206106870229,0.38167938931297707,17.0,18.0,0.0,0.31052631578947365
                               2 2,31.0,0.058823529411764705,0.9411764705882353,2.0,1.0,0.1631578947368421,0.8210526315789474
                                                                         assume for our simulations that the lensing and patchy,73.0,0.36220472440944884,0.6377952755905512,9.0,1.0,0.38421052631578945,0.3315789473684211
"        C`T T,noise = ∆2T e`    θFWHM /(8 ln 2)",8.0,0.5957446808510638,0.4042553191489362,9.0,3.0,0.042105263157894736,0.7526315789473684
"                                                ,                        reionization fields are uncorrelated, though in reality they",48.0,0.40601503759398494,0.5939849624060151,9.0,13.0,0.25263157894736843,0.30000000000000004
"                                              2 2                        should exhibit some correlation, since they develop from",46.0,0.3953488372093023,0.6046511627906976,10.0,13.0,0.24210526315789474,0.32105263157894737
"        C`EE,noise  =  C`BB,noise   =  ∆2P e` θFWHM /(8 ln 2) .    (8)",8.0,0.6142857142857143,0.3857142857142857,12.0,7.0,0.042105263157894736,0.631578947368421
                                                                         the same underlying density fluctuations.,73.0,0.32456140350877194,0.6754385964912281,5.0,1.0,0.38421052631578945,0.4
"   At the noise levels of future experiments, the lensing                   Following the formalism for the lensing quadratic esti-",3.0,0.7175572519083969,0.2824427480916031,17.0,10.0,0.015789473684210527,0.31052631578947365
"quadratic estimator is sub-optimal, and maximum likeli-                  mator, an unbiased minimum variance EB estimator can",0.0,0.752,0.248,15.0,10.0,0.0,0.3421052631578947
"hood techniques or an iterative delensing procedure is                   be derived for τ (n̂) (see [65, 73] for the full derivation)",0.0,0.7218045112781954,0.27819548872180455,20.0,10.0,0.0,0.30000000000000004
necessary to produce the best estimate of the lensing                    which takes the form,0.0,0.6666666666666666,0.33333333333333337,13.0,11.0,0.0,0.5105263157894737
"field [31, 32]. The basic idea of the iterative technique                                           Z 2",0.0,0.4854368932038835,0.5145631067961165,12.0,22.0,0.0,0.45789473684210524
                                                                                                         d `1 obs,105.0,0.05309734513274336,0.9469026548672567,3.0,1.0,0.5526315789473685,0.4052631578947369
                                                                                          τ,90.0,0.01098901098901099,0.989010989010989,1.0,1.0,0.47368421052631576,0.5210526315789474
is to first apply the quadratic estimator on the observed                τ̂EB (`) = NEB        (`)             E (`1 )B obs (`2 )FEB           τ,0.0,0.5486111111111112,0.45138888888888884,22.0,24.0,0.0,0.2421052631578947
"                                                                                                                                                 (`1 , `2 ) ,",145.0,0.050955414012738856,0.9490445859872612,5.0,1.0,0.7631578947368421,0.17368421052631577
                                                                                                        (2π)2,104.0,0.045871559633027525,0.9541284403669725,1.0,1.0,0.5473684210526316,0.4263157894736842
"maps, then use the resulting estimate of the lensing field                                                                                            (10)",0.0,0.34415584415584416,0.6558441558441559,11.0,47.0,0.0,0.18947368421052635
"to delens, next apply the quadratic estimator on the de-                 where like Eq. (6), the factor",0.0,0.6990291262135923,0.30097087378640774,16.0,9.0,0.0,0.45789473684210524
"lensed maps, delens again with the resulting estimate of",0.0,0.8571428571428571,0.1428571428571429,9.0,1.0,0.0,0.7052631578947368
"the residual lensing field, and iterate this procedure un-                                 Z",0.0,0.5591397849462365,0.4408602150537635,10.0,17.0,0.0,0.5105263157894737
                                                                                                   d2 `1 τ,99.0,0.04716981132075472,0.9528301886792453,3.0,1.0,0.5210526315789473,0.4421052631578948
                                                                                                                                              −1,142.0,0.020689655172413793,0.9793103448275862,1.0,1.0,0.7473684210526316,0.23684210526315785
                                                                               τ                                             τ,79.0,0.015873015873015872,0.9841269841269842,2.0,23.0,0.41578947368421054,0.33684210526315794
"til convergence is achieved [32]. Simulations have shown                    NEB   (`) =                   f    (` 1 , ` 2 )F      (` 1 , ` 2 )     , (11)",0.0,0.5032679738562091,0.49673202614379086,26.0,28.0,0.0,0.1947368421052632
                                                                                                  (2π)2 EB                   EB,98.0,0.07086614173228346,0.9291338582677166,3.0,10.0,0.5157894736842106,0.3315789473684211
that the iterative technique closely matches the perfor-,0.0,0.875,0.125,8.0,1.0,0.0,0.7052631578947368
"mance of the maximum likelihood estimator [31, 32].                      is a normalization that is equal to the variance of the esti-",0.0,0.7014925373134329,0.29850746268656714,20.0,12.0,0.0,0.2947368421052632
"                                                                         mator, with the mode coupling caused by patchy screen-",73.0,0.36220472440944884,0.6377952755905512,9.0,1.0,0.38421052631578945,0.3315789473684211
                                                                         ing given by,73.0,0.11764705882352941,0.8823529411764706,3.0,1.0,0.38421052631578945,0.5526315789473684
                   B.    Patchy Reionization,19.0,0.45454545454545453,0.5454545454545454,3.0,3.0,0.1,0.7684210526315789
                                                                             τ,77.0,0.01282051282051282,0.9871794871794872,1.0,1.0,0.4052631578947368,0.5894736842105264
"                                                                                 (`1 , `2 ) = C`EE       − C`BB",81.0,0.15315315315315314,0.8468468468468469,8.0,4.0,0.4263157894736842,0.4157894736842105
                                                                                                                 ,96.0,0.017391304347826087,0.9826086956521739,2.0,9.0,0.5052631578947369,0.39473684210526316
                                                                           fEB                       1         2,75.0,0.044642857142857144,0.9553571428571429,3.0,16.0,0.39473684210526316,0.41052631578947374
"                                                                                                                     sin 2(ϕ(`1 ) − ϕ(`2 )) , (12)",117.0,0.1506849315068493,0.8493150684931507,8.0,1.0,0.6157894736842106,0.2315789473684211
   The inhomogeneous nature of the reionization epoch,3.0,0.8301886792452831,0.16981132075471694,7.0,1.0,0.015789473684210527,0.7210526315789474
                                                                         and the filter is,73.0,0.15555555555555556,0.8444444444444444,4.0,1.0,0.38421052631578945,0.5263157894736843
causes several observable impacts on the CMB [60–69].,0.0,0.8679245283018868,0.13207547169811318,8.0,1.0,0.0,0.7210526315789474
The patchiness of reionization leads to an anisotropic op-                                                            τ,0.0,0.42857142857142855,0.5714285714285714,10.0,31.0,0.0,0.37368421052631584
"                                                                                             τ                     fEB     (`1 , `2 )",93.0,0.08270676691729323,0.9172932330827068,6.0,13.0,0.48947368421052634,0.30000000000000004
"tical depth whose effects on the CMB can be separated                                      FEB    (`1 , `2 ) =    EE,obs BB,obs",0.0,0.5275590551181102,0.4724409448818898,18.0,24.0,0.0,0.3315789473684211
                                                                                                                                           .          (13),139.0,0.032467532467532464,0.9675324675324676,2.0,6.0,0.7315789473684211,0.18947368421052635
                                                                                                                C`1         C`2,112.0,0.047244094488188976,0.952755905511811,2.0,5.0,0.5894736842105263,0.3315789473684211
"into three categories: screening, scattering, and the ki-",0.0,0.8771929824561403,0.1228070175438597,8.0,1.0,0.0,0.7
"netic Sunyaev-Zel’dovich effect.                                         In Eq. (10) and throughout the rest of the paper, the",0.0,0.5793650793650794,0.4206349206349206,14.0,21.0,0.0,0.33684210526315794
"   First, the variation of the optical depth on the sky,                 E obs , B obs are defined according to",3.0,0.6666666666666666,0.33333333333333337,19.0,9.0,0.015789473684210527,0.4157894736842105
"τ (n̂), leads to a spatially dependent screening of CMB",0.0,0.8363636363636363,0.1636363636363637,10.0,1.0,0.0,0.7105263157894737
"fluctuations due to the scattering of CMB photons into                                      X obs (`) = X mod (`) + N X (`) ,                         (14)",0.0,0.4675324675324675,0.5324675324675325,22.0,32.0,0.0,0.18947368421052635
avr_spaces,37.76136363636363,1.0,0.0,1.0,1.0,0.19874401913875597,0.9473684210526316
                                                                                                                             4,125.0,0.007936507936507936,0.9920634920634921,1.0,1.0,0.6578947368421053,0.33684210526315794
with X and N X (`) as described below Eq. (7).                     Deep learning makes use of these neural networks by,0.0,0.6694915254237288,0.3305084745762712,20.0,11.0,0.0,0.3789473684210526
"   In the presence of lensing, the τ estimator is biased        using multiple successive layers of neurons, offering the",3.0,0.7768595041322314,0.22314049586776863,18.0,5.0,0.015789473684210527,0.3631578947368421
by a spurious signal that results from the mode-coupling        ability to learn complex nonlinear relationships hidden,0.0,0.8151260504201681,0.18487394957983194,16.0,5.0,0.0,0.37368421052631584
induced by lensing. The amplitude of the bias is more           in sets of data. There is a significant computational cost,0.0,0.7622950819672131,0.23770491803278693,20.0,6.0,0.0,0.35789473684210527
"than an order of magnitude greater than the true patchy         in training deep learning networks, but once trained, the",0.0,0.7851239669421488,0.2148760330578512,19.0,5.0,0.0,0.3631578947368421
"reionization signal, and the bias remains significant even      networks are capable of very quickly making predictions",0.0,0.8319327731092437,0.16806722689075626,16.0,4.0,0.0,0.37368421052631584
after 98% of the lensing signal has been removed [73].          with very low resource requirements. When dealing with,0.0,0.7796610169491526,0.22033898305084743,18.0,6.0,0.0,0.3789473684210526
"The bias for the EB estimator can be calculated by how          image data in computer vision tasks, the convolutional",0.0,0.7711864406779662,0.22881355932203384,19.0,6.0,0.0,0.3789473684210526
much of the lensing mode-coupling is picked up by the           neural network (CNN) has become the dominant deep,0.0,0.7610619469026548,0.23893805309734517,18.0,6.0,0.0,0.4052631578947369
patchy reionization estimator [73]                              learning network design.,0.0,0.6022727272727273,0.3977272727272727,7.0,16.0,0.0,0.5368421052631579
                                                                   It is natural to ask whether deep learning can be,67.0,0.3448275862068966,0.6551724137931034,10.0,1.0,0.3526315789473684,0.3894736842105263
                          d2 `1 φ                               usefully applied to cosmology. Maps of the content of,26.0,0.42735042735042733,0.5726495726495726,12.0,16.0,0.1368421052631579,0.38421052631578945
                      Z,22.0,0.043478260869565216,0.9565217391304348,1.0,1.0,0.11578947368421053,0.8789473684210526
               τ                            τ,15.0,0.044444444444444446,0.9555555555555556,2.0,15.0,0.07894736842105263,0.7631578947368421
" βEB (`) =   NEB  (`)          f (`1 , `2 )FEB (`1 , `2 )φ(`) . the Universe (such as the CMB) are 2D or 3D images,",1.0,0.6695652173913044,0.33043478260869563,26.0,8.0,0.005263157894736842,0.39473684210526316
                         (2π)2 EB,25.0,0.21212121212121213,0.7878787878787878,2.0,1.0,0.13157894736842105,0.8263157894736842
                                                           (15) from which we can extract cosmological information us-,59.0,0.4322033898305085,0.5677966101694916,9.0,1.0,0.3105263157894737,0.3789473684210526
"It is possible to construct a bias-hardened estimator that      ing CNNs. As a result, deep learning applications have a",0.0,0.8083333333333333,0.19166666666666665,19.0,4.0,0.0,0.368421052631579
is insensitive to the effects of lensing and which does not     growing presence in cosmology. Some recent applications,0.0,0.8235294117647058,0.17647058823529416,18.0,3.0,0.0,0.37368421052631584
have significantly higher variance than the estimator de-       of deep learning to the CMB involving CNNs are full-sky,0.0,0.8067226890756303,0.19327731092436973,18.0,4.0,0.0,0.37368421052631584
"scribed above [73].                                             foreground removal [78], fast Wiener filtering [79], mass",0.0,0.5537190082644629,0.44628099173553715,11.0,23.0,0.0,0.3631578947368421
"   In addition to the bias, lensing also adds variance to       estimation of galaxy clusters [80, 81], and cosmic string",3.0,0.7768595041322314,0.22314049586776863,19.0,4.0,0.015789473684210527,0.3631578947368421
the patchy reionization estimator by increasing the ob-         detection [82].,0.0,0.7848101265822784,0.21518987341772156,10.0,5.0,0.0,0.5842105263157895
served B-mode polarization power. A strategy to recon-             Cosmological structure along our line of sight leaves,0.0,0.775,0.22499999999999998,16.0,7.0,0.0,0.368421052631579
struct the screening effect of patchy reionization using        characteristic distortions imprinted in the observed CMB,0.0,0.825,0.17500000000000004,15.0,5.0,0.0,0.368421052631579
the tools above is therefore to first reconstruct the lens-     polarization maps resulting in secondary anisotropies,0.0,0.8376068376068376,0.16239316239316237,16.0,3.0,0.0,0.38421052631578945
"ing field, use that estimated lensing field to delens the       which can be identified and extracted by a CNN. These",0.0,0.7863247863247863,0.2136752136752137,20.0,4.0,0.0,0.38421052631578945
"CMB, and finally to reconstruct the patchy reionization         distortions are correlated over a range of scales, and so",0.0,0.7933884297520661,0.20661157024793386,18.0,5.0,0.0,0.3631578947368421
using a bias-hardened estimator. This procedure is dif-         the hierarchical feature extraction of the CNN is well-,0.0,0.7983193277310925,0.2016806722689075,17.0,5.0,0.0,0.37368421052631584
ficult to implement in practice and would lead to com-          suited to detect the impact of these distortions. In this,0.0,0.768595041322314,0.23140495867768596,20.0,6.0,0.0,0.3631578947368421
"plicated noise properties in the resulting estimates. One       paper, we employ a particular type of CNN called a Res-",0.0,0.7983193277310925,0.2016806722689075,19.0,4.0,0.0,0.37368421052631584
of the main goals of this paper is to compare the perfor-       UNet to analyze secondary anisotropies of the CMB. This,0.0,0.7815126050420168,0.2184873949579832,21.0,4.0,0.0,0.37368421052631584
mance of an idealized version of the above procedure to         choice is motivated by the success of a ResUNet for flat-,0.0,0.768595041322314,0.23140495867768596,21.0,5.0,0.0,0.3631578947368421
the results that can be obtained through machine learn-         sky CMB lensing reconstruction [77]. In the sections,0.0,0.7931034482758621,0.2068965517241379,17.0,5.0,0.0,0.3894736842105263
ing. We will show how our network is capable of making          that follow we discuss the ingredients that define a Res-,0.0,0.7603305785123967,0.23966942148760328,21.0,6.0,0.0,0.3631578947368421
"simultaneous estimates of a delensed polarization map, a        UNet, we describe the specific ResUNet architecture we",0.0,0.8135593220338984,0.18644067796610164,16.0,5.0,0.0,0.3789473684210526
"lensing map, and a patchy reionization map in a single          designed for simultaneous lensing and patchy reioniza-",0.0,0.788135593220339,0.211864406779661,17.0,6.0,0.0,0.3789473684210526
"step.                                                           tion reconstruction, and we specify how our network is",0.0,0.4322033898305085,0.5677966101694916,10.0,30.0,0.0,0.3789473684210526
                                                                implemented and trained.,64.0,0.25,0.75,3.0,1.0,0.3368421052631579,0.5368421052631579
      III.  DEEP LEARNING NETWORK AND,6.0,0.7027027027027027,0.29729729729729726,5.0,2.0,0.031578947368421054,0.8052631578947369
                        METHODS                                           B.    Residual U-Network (ResUNet),24.0,0.32407407407407407,0.6759259259259259,5.0,24.0,0.12631578947368421,0.43157894736842106
"   In this section, we provide a brief introduction to ma-         Convolutional layers are the core of a CNN. Each neu-",3.0,0.75,0.25,20.0,5.0,0.015789473684210527,0.368421052631579
chine learning and its applications to image processing.        ron in a convolutional layer operates on a region of pixels,0.0,0.7967479674796748,0.2032520325203252,19.0,5.0,0.0,0.3526315789473684
We then discuss the design of the ResUNet-CMB archi-            of its input called the receptive field. In the first convolu-,0.0,0.7619047619047619,0.23809523809523814,20.0,7.0,0.0,0.33684210526315794
"tecture that we apply to the task of patchy reionization        tional layer of a network, the receptive field is completely",0.0,0.7903225806451613,0.20967741935483875,20.0,5.0,0.0,0.34736842105263155
reconstruction with simulated CMB maps.                         determined by the kernel size. The kernel size specifies,0.0,0.6916666666666667,0.30833333333333335,14.0,13.0,0.0,0.368421052631579
                                                                the dimensions of the k × k filters which are slid across,64.0,0.38016528925619836,0.6198347107438016,12.0,1.0,0.3368421052631579,0.3631578947368421
                                                                the input to extract features. Each filter is sensitive to a,64.0,0.4032258064516129,0.5967741935483871,11.0,1.0,0.3368421052631579,0.34736842105263155
                                                                unique feature. Common choices for the kernel size use,64.0,0.3898305084745763,0.6101694915254237,9.0,1.0,0.3368421052631579,0.3789473684210526
"               A.    Deep Neural Networks                       k = 3, 5, 7, ..., with odd numbers selected so symmetry",15.0,0.5378151260504201,0.46218487394957986,16.0,14.0,0.07894736842105263,0.37368421052631584
                                                                about the central pixel can be maintained to reduce edge,64.0,0.39166666666666666,0.6083333333333334,10.0,1.0,0.3368421052631579,0.368421052631579
   Machine learning is a process whereby computers learn        effects. For more details about convolutional layers see,3.0,0.7916666666666666,0.20833333333333337,16.0,5.0,0.015789473684210527,0.368421052631579
the rules to complete tasks when provided a set of ex-          Ref. [83].,0.0,0.7162162162162162,0.28378378378378377,13.0,6.0,0.0,0.6105263157894737
"amples. In the past decade, artificial neural networks             By chaining together convolutional layers, neurons in",0.0,0.7833333333333333,0.21666666666666667,15.0,7.0,0.0,0.368421052631579
"(ANNs) have become ubiquitous in machine learning, be-          each successive layer become connected to a larger re-",0.0,0.788135593220339,0.211864406779661,17.0,6.0,0.0,0.3789473684210526
ing applied to a wide range of problems. The method is          gion of the initial input layer thereby increasing the,0.0,0.7627118644067796,0.23728813559322037,20.0,6.0,0.0,0.3789473684210526
inspired by biological systems in that ANNs use neurons         size of each consecutive receptive field. The progres-,0.0,0.7966101694915254,0.2033898305084746,17.0,5.0,0.0,0.3789473684210526
as the building blocks. These neurons are grouped into          sive increase in receptive field size of each convolutional,0.0,0.7886178861788617,0.21138211382113825,18.0,6.0,0.0,0.3526315789473684
layers and carry out tensor operations.                         layer makes the network sensitive to high-level features of,0.0,0.6910569105691057,0.3089430894308943,15.0,13.0,0.0,0.3526315789473684
avr_spaces,11.754098360655735,1.0,0.0,1.0,1.0,0.06186367558239861,0.9473684210526316
                                                                                                                                                              5,158.0,0.006289308176100629,0.9937106918238994,1.0,1.0,0.8315789473684211,0.16315789473684206
            Convolutional Layer,12.0,0.5806451612903226,0.4193548387096774,2.0,1.0,0.06315789473684211,0.8368421052631578
            Dropout Layer,12.0,0.48,0.52,2.0,1.0,0.06315789473684211,0.868421052631579
                                                                                                                                                   κbiased,147.0,0.045454545454545456,0.9545454545454546,1.0,1.0,0.7736842105263158,0.18947368421052635
            SELU Activation,12.0,0.5185185185185185,0.4814814814814815,2.0,1.0,0.06315789473684211,0.8578947368421053
            Batch Normalization,12.0,0.5806451612903226,0.4193548387096774,2.0,1.0,0.06315789473684211,0.8368421052631578
            Upsample Layer,12.0,0.5,0.5,2.0,1.0,0.06315789473684211,0.8631578947368421
       ||   Concatenation                                                                                                                     8,7.0,0.11188811188811189,0.8881118881118881,3.0,60.0,0.03684210526315789,0.24736842105263157
                                                                                                                                              12,142.0,0.013888888888888888,0.9861111111111112,1.0,1.0,0.7473684210526316,0.2421052631578947
                                                                                                                                         ×,137.0,0.007246376811594203,0.9927536231884058,1.0,1.0,0.7210526315789474,0.27368421052631575
                                                                                                                                       12,135.0,0.014598540145985401,0.9854014598540146,1.0,1.0,0.7105263157894737,0.2789473684210526
                                                             Convolution Block                                                            8,61.0,0.1223021582733813,0.8776978417266187,3.0,31.0,0.32105263157894737,0.2684210526315789
                                                                                                                             64 64 1,125.0,0.03787878787878788,0.9621212121212122,3.0,1.0,0.6578947368421053,0.3052631578947368
      Qobs U obs,6.0,0.5,0.5,3.0,1.0,0.031578947368421054,0.9157894736842105
                                                                                                                                                   τ biased,147.0,0.04516129032258064,0.9548387096774194,2.0,1.0,0.7736842105263158,0.1842105263157895
                                                                                                 ||,97.0,0.020202020202020204,0.9797979797979798,1.0,1.0,0.5105263157894737,0.4789473684210527
                                    8,36.0,0.02702702702702703,0.972972972972973,1.0,1.0,0.18947368421052632,0.8052631578947369
                                   12                                                                                   8,35.0,0.024793388429752067,0.9752066115702479,2.0,42.0,0.18421052631578946,0.3631578947368421
                                                                                                                        12                    8,120.0,0.02097902097902098,0.9790209790209791,2.0,11.0,0.631578947368421,0.24736842105263157
                                                                                                                                              12,142.0,0.013888888888888888,0.9861111111111112,1.0,1.0,0.7473684210526316,0.2421052631578947
                                  ×                                                                                 ×                    ×,34.0,0.021739130434782608,0.9782608695652174,3.0,51.0,0.17894736842105263,0.27368421052631575
                              8,30.0,0.03225806451612903,0.967741935483871,1.0,1.0,0.15789473684210525,0.8368421052631578
                              12                                                                                   8,30.0,0.02586206896551724,0.9741379310344828,2.0,42.0,0.15789473684210525,0.3894736842105263
                                                                                                                   12                   8,115.0,0.021897810218978103,0.9781021897810219,2.0,10.0,0.6052631578947368,0.2789473684210526
                                                                                                                                       12,135.0,0.014598540145985401,0.9854014598540146,1.0,1.0,0.7105263157894737,0.2789473684210526
                   64 64 64                                                                                64 64             64 64 1,19.0,0.11363636363636363,0.8863636363636364,8.0,47.0,0.1,0.3052631578947368
                                                                                                                                                   E biased,147.0,0.04516129032258064,0.9548387096774194,2.0,1.0,0.7736842105263158,0.1842105263157895
                                                                      ||,70.0,0.027777777777777776,0.9722222222222222,1.0,1.0,0.3684210526315789,0.6210526315789473
                                                      64,54.0,0.03571428571428571,0.9642857142857143,1.0,1.0,0.28421052631578947,0.7052631578947368
                                                  ×                                                   8,50.0,0.019417475728155338,0.9805825242718447,2.0,26.0,0.2631578947368421,0.45789473684210524
                                                                                                      12,102.0,0.019230769230769232,0.9807692307692307,1.0,1.0,0.5368421052631579,0.4526315789473684
                                                 64                                             ×,49.0,0.030927835051546393,0.9690721649484536,2.0,23.0,0.2578947368421053,0.4894736842105263
                                   128 128 128                                  128 128         8,35.0,0.16494845360824742,0.8350515463917526,6.0,22.0,0.18421052631578946,0.4894736842105263
                                                                                64 × 64        12                                             8,80.0,0.055944055944055944,0.9440559440559441,5.0,27.0,0.42105263157894735,0.24736842105263157
                                                                                          64                                             ×,90.0,0.021739130434782608,0.9782608695652174,2.0,23.0,0.47368421052631576,0.27368421052631575
                                                                                                                                              12,142.0,0.013888888888888888,0.9861111111111112,1.0,1.0,0.7473684210526316,0.2421052631578947
                                                                                                                                        8,136.0,0.0072992700729927005,0.9927007299270073,1.0,1.0,0.7157894736842105,0.2789473684210526
                                                                                                                                       12,135.0,0.014598540145985401,0.9854014598540146,1.0,1.0,0.7105263157894737,0.2789473684210526
                                                                                                                             64 64 1,125.0,0.03787878787878788,0.9621212121212122,3.0,1.0,0.6578947368421053,0.3052631578947368
                                            32 × 32,44.0,0.09803921568627451,0.9019607843137255,3.0,1.0,0.23157894736842105,0.7315789473684211
                                                                           64,75.0,0.025974025974025976,0.974025974025974,1.0,1.0,0.39473684210526316,0.5947368421052632
                                                                      ×,70.0,0.014084507042253521,0.9859154929577465,1.0,1.0,0.3684210526315789,0.6263157894736842
                                                       256           64,55.0,0.07042253521126761,0.9295774647887324,2.0,6.0,0.2894736842105263,0.6263157894736842
                                                               128,63.0,0.045454545454545456,0.9545454545454546,1.0,1.0,0.33157894736842103,0.6526315789473685
"FIG. 1. ResUNet-CMB architecture with residual connections excluded for clarity1 . The input images, (Qobs ,U obs ) are",0.0,0.8487394957983193,0.1512605042016807,19.0,1.0,0.0,0.37368421052631584
concatenated along the channel dimension. Convolutional layers are labeled with the number of filters they contain. The final,0.0,0.864,0.136,18.0,1.0,0.0,0.3421052631578947
"images, (κbiased ,τ biased ,E biased ), are the output of the final batch normalization layer of each branch. The network has 5,292,367",0.0,0.837037037037037,0.16296296296296298,23.0,1.0,0.0,0.2894736842105263
"total parameters and 5,287,113 trainable parameters. The receptive field size when ignoring residual and skip connections is",0.0,0.8709677419354839,0.12903225806451613,17.0,1.0,0.0,0.34736842105263155
101 × 101 pixels for each output. Widths of layers are chosen for visual clarity and are not to scale.,0.0,0.8137254901960784,0.18627450980392157,20.0,1.0,0.0,0.4631578947368421
"larger scales. For tasks involving images, using a CNN is                                  phase, relevant features for the reconstruction of the out-",0.0,0.66,0.33999999999999997,19.0,18.0,0.0,0.21052631578947367
beneficial since mapping a neuron directly to every pixel                                  put are learned by each convolutional layer and increase,0.0,0.6598639455782312,0.34013605442176875,18.0,18.0,0.0,0.22631578947368425
"would be computationally intractable.                                                      in complexity, becoming more abstract in deeper layers",0.0,0.5586206896551724,0.4413793103448276,12.0,28.0,0.0,0.23684210526315785
   Convolutional autoencoders are a type of CNN that                                       of the network. The output of each convolution is called,3.0,0.6054421768707483,0.3945578231292517,18.0,20.0,0.015789473684210527,0.22631578947368425
take a tensor for input and produce an identically sized                                   a feature map since it is a tensor made of encoded fea-,0.0,0.6232876712328768,0.37671232876712324,22.0,18.0,0.0,0.2315789473684211
"one for output. When used with image data, the tensor                                      tures. The feature maps are continuously down-sampled",0.0,0.6319444444444444,0.3680555555555556,17.0,20.0,0.0,0.2421052631578947
"takes a shape of (image height, image width, number of                                     at regular intervals lowering their dimensionality until a",0.0,0.6442953020134228,0.3557046979865772,18.0,19.0,0.0,0.21578947368421053
"channels). For example, if we have a 128 × 128 pixel                                       set minimum size is reached. This down-sampling helps",0.0,0.6111111111111112,0.38888888888888884,19.0,20.0,0.0,0.2421052631578947
"RGB image, then the input tensor shape would be (128,                                      increase the receptive field with respect to the input im-",0.0,0.6241610738255033,0.37583892617449666,20.0,20.0,0.0,0.21578947368421053
"128, 3) where the red, green, and blue pixel values each                                   age while also reducing the propagation of unnecessary",0.0,0.6413793103448275,0.35862068965517246,19.0,18.0,0.0,0.23684210526315785
represent a different channel. Employed with supervised                                    information.,0.0,0.5922330097087378,0.4077669902912622,8.0,19.0,0.0,0.45789473684210524
"learning, convolutional autoencoders are able to learn a",0.0,0.875,0.125,8.0,1.0,0.0,0.7052631578947368
nonlinear mapping between the input and output space.,0.0,0.8679245283018868,0.13207547169811318,8.0,1.0,0.0,0.7210526315789474
                                                                                           1,91.0,0.010869565217391304,0.9891304347826086,1.0,1.0,0.4789473684210526,0.5157894736842106
   There are two primary components in a convolutional                                         Graphic made with publicly available code from https://,3.0,0.6133333333333333,0.3866666666666667,16.0,21.0,0.015789473684210527,0.21052631578947367
"autoencoder, the encoder and decoder. In the encoding                                          github.com/HarisIqbal88/PlotNeuralNet.",0.0,0.631578947368421,0.368421052631579,9.0,22.0,0.0,0.30000000000000004
avr_spaces,53.59090909090909,1.0,0.0,1.0,1.0,0.2820574162679426,0.9473684210526316
                                                                                                                        6,120.0,0.008264462809917356,0.9917355371900827,1.0,1.0,0.631578947368421,0.3631578947368421
   The decoder takes the features learned in the last             A schematic representation of the ResUNet-CMB ar-,3.0,0.7391304347826086,0.26086956521739135,16.0,7.0,0.015789473684210527,0.39473684210526316
"layer of the encoder, the minimum representation, and         chitecture is shown in Fig. 1 where the residual connec-",0.0,0.788135593220339,0.211864406779661,18.0,5.0,0.0,0.3789473684210526
learns how to combine them to achieve the desired out-        tions were left out for clarity. The network is made up of,0.0,0.7666666666666667,0.23333333333333328,22.0,5.0,0.0,0.368421052631579
put. Starting from the minimum representation which is        a series of convolution blocks. We define a convolution,0.0,0.8034188034188035,0.19658119658119655,17.0,5.0,0.0,0.38421052631578945
"an abstract base, it is up-sampled while detail is added      block as consisting of four components in the following or-",0.0,0.8016528925619835,0.19834710743801653,20.0,4.0,0.0,0.3631578947368421
"through consecutive convolutional layers. The final re-       der: dropout layer, convolutional layer, activation layer,",0.0,0.8416666666666667,0.15833333333333333,14.0,4.0,0.0,0.368421052631579
sult is an output image with the same height and width        and batch normalization layer. The convolutional layer,0.0,0.7931034482758621,0.2068965517241379,18.0,5.0,0.0,0.3894736842105263
as the initial input to the network.                          is set with a kernel size of 5 × 5 and ’same’ padding. For,0.0,0.625,0.375,21.0,14.0,0.0,0.368421052631579
   Some localization information is lost through down-        the activation we use the Scaled Exponential Linear Unit,3.0,0.788135593220339,0.211864406779661,16.0,5.0,0.015789473684210527,0.3789473684210526
"sampling. To combat this, the outputs of some layers          (SELU) function [93]. The dropout layer, with a dropout",0.0,0.7777777777777778,0.2222222222222222,18.0,6.0,0.0,0.38421052631578945
"in the encoder phase can be concatenated with those of        rate of 0.3 which we found to be the optimal value, is",0.0,0.7586206896551724,0.24137931034482762,22.0,5.0,0.0,0.3894736842105263
the same size in the decoder. The concatenations are          necessary to prevent the network from over-fitting. The,0.0,0.7863247863247863,0.2136752136752137,17.0,6.0,0.0,0.38421052631578945
with respect to the channel dimension and are called          dropout layer is omitted from the first convolution block,0.0,0.7815126050420168,0.2184873949579832,18.0,6.0,0.0,0.37368421052631584
skip connections. As the output is reconstructed from         in the network in order to prevent the irretrievable loss,0.0,0.7899159663865546,0.2100840336134454,18.0,5.0,0.0,0.37368421052631584
"the minimum representation, the skip connections pro-         of initial information.",0.0,0.8,0.19999999999999996,10.0,5.0,0.0,0.5526315789473684
vide high resolution information just after up-sampling.,0.0,0.8928571428571429,0.1071428571428571,7.0,1.0,0.0,0.7052631578947368
These skip connections in combination with a convolu-             The final block of each branch in the decoder phase,0.0,0.7521367521367521,0.24786324786324787,18.0,7.0,0.0,0.38421052631578945
tional autoencoder were introduced for the purpose of         differs from the others in that the activation function is,0.0,0.7916666666666666,0.20833333333333337,18.0,5.0,0.0,0.368421052631579
"biomedical segmentation, and the resulting architecture       switched to a linear one. Down-sampling in the encoder",0.0,0.8275862068965517,0.1724137931034483,15.0,4.0,0.0,0.3894736842105263
is called a U-Net [84]. The encoding phase and decoding       phase is achieved by setting the stride to 2 in the convo-,0.0,0.775,0.22499999999999998,22.0,4.0,0.0,0.368421052631579
phase in the U-Net often mirror each other in both depth      lutional layer. The stride refers to the number of pixels,0.0,0.7899159663865546,0.2100840336134454,21.0,4.0,0.0,0.37368421052631584
and the locations at which up- or down-sampling occur.        between applications of the filter to the input image. A,0.0,0.788135593220339,0.211864406779661,19.0,5.0,0.0,0.3789473684210526
"As a result, this type of network is often presented in a     dedicated up-sampling layer with nearest-neighbor inter-",0.0,0.8220338983050848,0.17796610169491522,18.0,3.0,0.0,0.3789473684210526
"U-shape, hence its name.                                      polation was used for the decoding phase and was placed",0.0,0.5726495726495726,0.4273504273504274,14.0,20.0,0.0,0.38421052631578945
   As the network grows deeper by stacking convolutional      before the dropout layer to reduce the production of vi-,3.0,0.788135593220339,0.211864406779661,18.0,4.0,0.015789473684210527,0.3789473684210526
"layers, it has been shown that performance and accuracy       sual artifacts [94].",0.0,0.7926829268292683,0.20731707317073167,12.0,4.0,0.0,0.5684210526315789
"of the network decreases [85–87]. Residual connections,",0.0,0.8909090909090909,0.10909090909090913,7.0,1.0,0.0,0.7105263157894737
                                                                  Skip connections occur every three convolution blocks,66.0,0.3949579831932773,0.6050420168067228,7.0,1.0,0.3473684210526316,0.37368421052631584
which take the input of a convolutional layer and add,0.0,0.8301886792452831,0.16981132075471694,10.0,1.0,0.0,0.7210526315789474
                                                              in the encoder and concatenate along the channel di-,62.0,0.38596491228070173,0.6140350877192983,9.0,1.0,0.3263157894736842,0.4
it element-wise to the output of a subsequent convolu-,0.0,0.8518518518518519,0.14814814814814814,9.0,1.0,0.0,0.7157894736842105
                                                              mension. Residual connections connect every two con-,62.0,0.40350877192982454,0.5964912280701755,7.0,1.0,0.3263157894736842,0.4
"tional layer, allow more layers to be added to the network",0.0,0.8275862068965517,0.1724137931034483,11.0,1.0,0.0,0.6947368421052631
                                                              volution blocks. The first residual connection takes the,62.0,0.4152542372881356,0.5847457627118644,8.0,1.0,0.3263157894736842,0.3789473684210526
without degrading performance by helping to propagate,0.0,0.8867924528301887,0.1132075471698113,7.0,1.0,0.0,0.7210526315789474
"                                                              (Qobs , U obs ) input layer and adds it element-wise to the",62.0,0.3884297520661157,0.6115702479338843,13.0,1.0,0.3263157894736842,0.3631578947368421
parameter corrections to earlier layers and information,0.0,0.8909090909090909,0.10909090909090913,7.0,1.0,0.0,0.7105263157894737
                                                              batch normalization output of the second block. The,62.0,0.3893805309734513,0.6106194690265487,8.0,1.0,0.3263157894736842,0.4052631578947369
"to latter ones, through direct identity paths [86, 88, 89].",0.0,0.847457627118644,0.15254237288135597,10.0,1.0,0.0,0.6894736842105262
                                                              next connection is from the output of the second block,62.0,0.3879310344827586,0.6120689655172413,10.0,1.0,0.3263157894736842,0.3894736842105263
Their use can help improve network training and results.,0.0,0.8571428571428571,0.1428571428571429,9.0,1.0,0.0,0.7052631578947368
                                                              to that of the fourth block. The connections continue this,62.0,0.4083333333333333,0.5916666666666667,10.0,1.0,0.3263157894736842,0.368421052631579
Adding residual and skip connections to a convolutional,0.0,0.8727272727272727,0.12727272727272732,8.0,1.0,0.0,0.7105263157894737
                                                              pattern until the final two blocks of the decoder where,62.0,0.39316239316239315,0.6068376068376069,10.0,1.0,0.3263157894736842,0.38421052631578945
autoencoder yields an architecture called a ResUNet [90–,0.0,0.875,0.125,8.0,1.0,0.0,0.7052631578947368
                                                              no residual connections are used.,62.0,0.30526315789473685,0.6947368421052631,5.0,1.0,0.3263157894736842,0.5
92].,0.0,1.0,0.0,1.0,1.0,0.0,0.9789473684210527
"                                                                  In both the encoding and decoding phases, some resid-",66.0,0.37815126050420167,0.6218487394957983,9.0,1.0,0.3473684210526316,0.37368421052631584
                                                              ual connections occur between convolution blocks with,62.0,0.40869565217391307,0.5913043478260869,7.0,1.0,0.3263157894736842,0.39473684210526316
     C.    Network Architecture (ResUNet-CMB),5.0,0.7555555555555555,0.24444444444444446,4.0,3.0,0.02631578947368421,0.7631578947368421
                                                              different input and output tensor dimensions. For such,62.0,0.4051724137931034,0.5948275862068966,8.0,1.0,0.3263157894736842,0.3894736842105263
"                                                              residual connections, a convolutional layer with linear ac-",62.0,0.4297520661157025,0.5702479338842975,8.0,1.0,0.3263157894736842,0.3631578947368421
   We focus here on the application of a ResUNet de-          tivation and appropriate stride and number of filters is,3.0,0.7457627118644068,0.2542372881355932,19.0,6.0,0.015789473684210527,0.3789473684210526
signed to reconstruct the effects of patchy reionization      inserted into the connection in order to reconcile the ten-,0.0,0.8181818181818182,0.18181818181818177,18.0,4.0,0.0,0.3631578947368421
on the CMB polarization in the presence of lensing. Af-       sor dimensions. If there is a difference in the image size,0.0,0.7833333333333333,0.21666666666666667,21.0,4.0,0.0,0.368421052631579
"ter training, the ResUNet takes as input maps of the          between blocks in the decoder phase, a dedicated upsam-",0.0,0.7692307692307693,0.23076923076923073,19.0,6.0,0.0,0.38421052631578945
"observed Q and U polarization (Qobs , U obs ) and pro-        pling layer is used in addition to the convolutional layer.",0.0,0.768595041322314,0.23140495867768596,22.0,5.0,0.0,0.3631578947368421
"duces map-level estimates of the lensing convergence, the     We found adding a batch normalization layer in every",0.0,0.8245614035087719,0.17543859649122806,17.0,3.0,0.0,0.4
"patchy reionization, and the primordial E-mode polariza-      residual connection improved our results by lowering val-",0.0,0.8403361344537815,0.15966386554621848,15.0,4.0,0.0,0.37368421052631584
"tion (κ, τ, E prim ).                                         idation loss for all three outputs. In residual connections",0.0,0.5537190082644629,0.44628099173553715,15.0,21.0,0.0,0.3631578947368421
"   We use a modified version of the architecture defined in   containing a convolutional layer, the batch normalization",3.0,0.8235294117647058,0.17647058823529416,17.0,2.0,0.015789473684210527,0.37368421052631584
Ref. [77] which was shown to work in reconstructing the       is placed after the convolutional layer.,0.0,0.7941176470588235,0.20588235294117652,16.0,4.0,0.0,0.4631578947368421
lensing convergence map and therefore provided an ideal,0.0,0.8727272727272727,0.12727272727272732,8.0,1.0,0.0,0.7105263157894737
starting point from which to build upon. Implementation,0.0,0.8727272727272727,0.12727272727272732,8.0,1.0,0.0,0.7105263157894737
"of our network, which we call ResUNet-CMB, was done",0.0,0.8431372549019608,0.1568627450980392,9.0,1.0,0.0,0.7315789473684211
with the Keras package of TensorFlow 2.02 .,0.0,0.8372093023255814,0.16279069767441856,8.0,1.0,0.0,0.7736842105263158
 2 The code for ResUNet-CMB and the data pipeline used can be    found at https://github.com/EEmGuzman/resunet-cmb.,1.0,0.8434782608695652,0.15652173913043477,15.0,3.0,0.005263157894736842,0.39473684210526316
avr_spaces,14.73913043478261,1.0,0.0,1.0,1.0,0.07757437070938215,0.9473684210526316
                                                                                                                               7,127.0,0.0078125,0.9921875,1.0,1.0,0.6684210526315789,0.3263157894736842
                     D.   Data Pipeline                          ResUNet-CMB predictions are made by feeding in,21.0,0.4864864864864865,0.5135135135135135,10.0,15.0,0.11052631578947368,0.4157894736842105
"                                                              (Qobs , U obs ) from the prediction set as input to the fully",62.0,0.3902439024390244,0.6097560975609756,14.0,1.0,0.3263157894736842,0.3526315789473684
   The publicly available CAMB3 software is used to pro-      trained network. The input maps are also standardized,3.0,0.7913043478260869,0.20869565217391306,17.0,4.0,0.015789473684210527,0.39473684210526316
duce the primordial CMB and lensing power spec-               according to Eq. (16) with the mean and standard devi-,0.0,0.7327586206896551,0.26724137931034486,18.0,8.0,0.0,0.3894736842105263
tra [95].      A cosmology with parameters of H0 =            ation from the prediction set. Making a single prediction,0.0,0.7226890756302521,0.2773109243697479,18.0,10.0,0.0,0.37368421052631584
"67.9 km s−1 Mpc−1 , Ωb h2 = 0.0222, Ωc h2 = 0.118,            of (κ, τ, E prim ) regardless of noise level, takes approxi-",0.0,0.7131147540983607,0.28688524590163933,25.0,7.0,0.0,0.35789473684210527
"ns = 0.962, τ = 0.0943, and As = 2.21×10−9 was chosen         mately 0.021 seconds on average.",0.0,0.7446808510638298,0.25531914893617025,17.0,5.0,0.0,0.5052631578947369
since it allows a comparison with results from Ref. [77].        The ResUNet-CMB predictions are post-processed to,0.0,0.8070175438596491,0.19298245614035092,16.0,5.0,0.0,0.4
We take the patchy reionization spectrum C`τ τ to match       rescale the outputs to physically meaningful values. This,0.0,0.8067226890756303,0.19327731092436973,18.0,4.0,0.0,0.37368421052631584
the τ̄ = 0.058 model of Ref. [76].                            must be done because the network is trained on standard-,0.0,0.6271186440677966,0.3728813559322034,18.0,15.0,0.0,0.3789473684210526
"   Using the theory power spectra from CAMB and a mod-        ized maps, so the predictions made on the fully trained",3.0,0.7521367521367521,0.24786324786324787,20.0,5.0,0.015789473684210527,0.38421052631578945
"ified version of Orphics4 , seven different maps are pro-     network will also be standardized. To perform the rescal-",0.0,0.8151260504201681,0.18487394957983194,19.0,3.0,0.0,0.37368421052631584
"duced as Gaussian random fields: lensing convergence          ing, we rearrange Eq. (16) to solve for X using the mean",0.0,0.7711864406779662,0.22881355932203384,19.0,6.0,0.0,0.3789473684210526
"κ ≡ 21 ∇2 φ, patchy reionization τ , primordial E-mode po-    and standard deviation from the training set (since with",0.0,0.8050847457627118,0.19491525423728817,21.0,3.0,0.0,0.3789473684210526
"larization E prim , primordial Q and U polarization Qprim     real data we would not have a priori knowledge of the",0.0,0.7913043478260869,0.20869565217391306,21.0,3.0,0.0,0.39473684210526316
"and U prim , and observed Q and U polarization Qobs and       true (κ, τ, E prim ) maps).",0.0,0.7303370786516854,0.2696629213483146,19.0,4.0,0.0,0.531578947368421
U obs . To obtain the observed polarization maps we use,0.0,0.8181818181818182,0.18181818181818177,11.0,1.0,0.0,0.7105263157894737
"Eq. (14), where the primordial maps (Qprim , U prim ) are",0.0,0.8070175438596491,0.19298245614035092,12.0,1.0,0.0,0.7
                                                                                           E.    Training,91.0,0.09523809523809523,0.9047619047619048,2.0,3.0,0.4789473684210526,0.4473684210526315
"first modulated by τ , then lensed with κ, and finally",0.0,0.8148148148148148,0.18518518518518523,11.0,1.0,0.0,0.7157894736842105
summed with a noise map as in Eq. (9).,0.0,0.7894736842105263,0.21052631578947367,9.0,1.0,0.0,0.8
   Each map is 128×128 pixels and covers a 5◦ ×5◦ patch          For each instrument noise level a separate network was,3.0,0.7394957983193278,0.26050420168067223,20.0,6.0,0.015789473684210527,0.37368421052631584
of sky. A cosine taper of 1.5◦ was applied to all maps to     trained. We chose to use a batch size of 32 to train the,0.0,0.7542372881355932,0.2457627118644068,26.0,3.0,0.0,0.3789473684210526
reduce edge effects. Instrument noise was implemented         networks. The initial learning rate was set to 0.25 and,0.0,0.7948717948717948,0.20512820512820518,17.0,5.0,0.0,0.38421052631578945
"at the levels of ∆T = 0.0 µK-arcmin, 0.2 µK-arcmin,           decayed by a factor of 0.5 if after three epochs there was",0.0,0.7416666666666667,0.2583333333333333,22.0,6.0,0.0,0.368421052631579
                                                     √,53.0,0.018518518518518517,0.9814814814814815,1.0,1.0,0.2789473684210526,0.7157894736842105
"1 µK-arcmin, and 2 µK-arcmin assuming ∆P = 2∆T .              no improvement in validation loss. Individual learning",0.0,0.75,0.25,17.0,8.0,0.0,0.3894736842105263
We used θFWHM = 1.40 for the cases of 1 µK-arcmin             rate decay of each trainable parameter was achieved by,0.0,0.7327586206896551,0.26724137931034486,20.0,7.0,0.0,0.3894736842105263
"and 2 µK-arcmin, but θFWHM = 1.00 for the 0.2 µK-             using the Adam optimizer with the TensorFlow default",0.0,0.7368421052631579,0.26315789473684215,19.0,7.0,0.0,0.4
"arcmin case, the latter of which was chosen to make direct    parameters [97]. If there was no improvement in the vali-",0.0,0.8067226890756303,0.19327731092436973,21.0,3.0,0.0,0.37368421052631584
comparison with the results of Ref. [73].                     dation loss after 10 consecutive epochs then training was,0.0,0.7058823529411765,0.2941176470588235,16.0,11.0,0.0,0.37368421052631584
"   For each noise level, 70000 sets of seven maps were pro-   stopped and the best network saved. Training the noise-",3.0,0.7948717948717948,0.20512820512820518,20.0,2.0,0.015789473684210527,0.38421052631578945
duced with the random seed set to 1225 with the python        less network using a training split of 56000 sets of maps,0.0,0.7647058823529411,0.23529411764705888,22.0,5.0,0.0,0.37368421052631584
NumPy package. In approximately 20% of the maps se-           took an average of 10 hours on a single Nvidia Tesla V100,0.0,0.7478991596638656,0.25210084033613445,21.0,6.0,0.0,0.37368421052631584
"lected at random, we set both κ and τ to zero. We found       32GB.",0.0,0.7164179104477612,0.28358208955223885,14.0,4.0,0.0,0.6473684210526316
that including these ‘null maps’ (meaning no lensing or,0.0,0.8545454545454545,0.1454545454545455,9.0,1.0,0.0,0.7105263157894737
"modulation applied to (Qprim , U prim )) in training helps",0.0,0.8275862068965517,0.1724137931034483,11.0,1.0,0.0,0.6947368421052631
the network generalize and prevents it from predicting                                   IV.     RESULTS,0.0,0.5480769230769231,0.45192307692307687,10.0,20.0,0.0,0.4526315789473684
the presence of a signal when none is present in test data.,0.0,0.8135593220338984,0.18644067796610164,12.0,1.0,0.0,0.6894736842105262
"In addition to the set of 70000, we also produce a sep-          In this section we examine the performance of the",0.0,0.7456140350877193,0.2543859649122807,21.0,6.0,0.0,0.4
"arate collection of 7000 sets of maps, which we call the      ResUNet-CMB network.                  We analyze maps, power",0.0,0.6885245901639344,0.3114754098360656,17.0,13.0,0.0,0.35789473684210527
"prediction set, on which most analysis of ResUNet-CMB         spectra, and reconstruction noise curves as evaluation",0.0,0.8103448275862069,0.18965517241379315,15.0,5.0,0.0,0.3894736842105263
"predictions was conducted. No null maps were included         metrics. As described in Section III D, we feed in",0.0,0.7767857142857143,0.2232142857142857,18.0,5.0,0.0,0.41052631578947374
"in the prediction set.                                        the inputs (Qobs , U obs ) from the prediction data set",0.0,0.5384615384615384,0.46153846153846156,16.0,21.0,0.0,0.38421052631578945
   The 70000 maps were split in a 80:10:10 ratio for train-   to the fully trained network which produces output,3.0,0.7946428571428571,0.2053571428571429,19.0,2.0,0.015789473684210527,0.41052631578947374
"ing, validation, and test sets. Similar to what was done in   maps (κ, τ, E prim ). The output maps are biased, and",0.0,0.7913043478260869,0.20869565217391306,23.0,2.0,0.0,0.39473684210526316
"Ref. [96], all maps in the training, validation and test sets so we refer to the direct outputs of the network as",0.0,0.8141592920353983,0.18584070796460173,22.0,1.0,0.0,0.4052631578947369
"are standardized with respect to values from the training     (κbiased , τ biased , E biased ); we address how to treat the bias",0.0,0.7890625,0.2109375,24.0,3.0,0.0,0.3263157894736842
set according to                                              later in this section.,0.0,0.39285714285714285,0.6071428571428572,7.0,24.0,0.0,0.5578947368421052
                                             ,45.0,0.021739130434782608,0.9782608695652174,1.0,1.0,0.23684210526315788,0.7578947368421053
                              X − X Training,30.0,0.25,0.75,4.0,1.0,0.15789473684210525,0.7684210526315789
               XProcessed =                    .        (16),15.0,0.26666666666666666,0.7333333333333334,4.0,15.0,0.07894736842105263,0.6842105263157895
                                 σTraining                                                   A.    Maps,33.0,0.14563106796116504,0.854368932038835,3.0,28.0,0.1736842105263158,0.45789473684210524
Here X represents a single unprocessed map from any,0.0,0.8431372549019608,0.1568627450980392,9.0,1.0,0.0,0.7315789473684211
data set. The mean and standard deviation are calcu-             Figure 2 shows a single prediction for each of,0.0,0.7387387387387387,0.26126126126126126,18.0,7.0,0.0,0.4157894736842105
"lated for each map type over the full training set.           (κbiased , τ biased , E biased ) from the fully trained ResUNet-",0.0,0.746031746031746,0.25396825396825395,23.0,6.0,0.0,0.33684210526315794
                                                              CMB network for the noiseless and 1 µK-arcmin case. We,62.0,0.3879310344827586,0.6120689655172413,10.0,1.0,0.3263157894736842,0.3894736842105263
                                                              highlight these results since they allow for partial com-,62.0,0.4117647058823529,0.5882352941176471,9.0,1.0,0.3263157894736842,0.37368421052631584
                                                              parison to results from Ref. [77]. Our ResUNet-CMB,62.0,0.38392857142857145,0.6160714285714286,8.0,1.0,0.3263157894736842,0.41052631578947374
 3 https://camb.info                                          network was able to reconstruct some of the largest scale,1.0,0.5546218487394958,0.4453781512605042,12.0,22.0,0.005263157894736842,0.37368421052631584
 4 https://github.com/msyriac/orphics                         features of τ (n̂) despite the fact that the impact of patchy,1.0,0.6910569105691057,0.3089430894308943,14.0,13.0,0.005263157894736842,0.3526315789473684
avr_spaces,10.793650793650794,1.0,0.0,1.0,1.0,0.05680868838763576,0.9473684210526316
                                                                                                                                         8,137.0,0.007246376811594203,0.9927536231884058,1.0,1.0,0.7210526315789474,0.27368421052631575
                                                  Noiseless                                        1 µK-arcmin,50.0,0.17272727272727273,0.8272727272727273,3.0,21.0,0.2631578947368421,0.42105263157894735
                                           biased                                              biased,43.0,0.1188118811881188,0.8811881188118812,2.0,24.0,0.22631578947368422,0.46842105263157896
            True τ             Predicted τ                  Residual               Predicted τ                 Residual,12.0,0.3445378151260504,0.6554621848739496,8.0,31.0,0.06315789473684211,0.37368421052631584
                                                                                                                                   0.015,131.0,0.03676470588235294,0.9632352941176471,1.0,1.0,0.6894736842105263,0.28421052631578947
   ◦                                                                                                                               0.010,3.0,0.04411764705882353,0.9558823529411765,2.0,64.0,0.015789473684210527,0.28421052631578947
 4,1.0,0.5,0.5,1.0,1.0,0.005263157894736842,0.9894736842105263
                                                                                                                                   0.005,131.0,0.03676470588235294,0.9632352941176471,1.0,1.0,0.6894736842105263,0.28421052631578947
                                                                                                                                   0.000,131.0,0.03676470588235294,0.9632352941176471,1.0,1.0,0.6894736842105263,0.28421052631578947
 2◦,1.0,0.6666666666666666,0.33333333333333337,1.0,1.0,0.005263157894736842,0.9842105263157894
                                                                                                                                   −0.005,131.0,0.043795620437956206,0.9562043795620438,1.0,1.0,0.6894736842105263,0.2789473684210526
                                                                                                                                   −0.010,131.0,0.043795620437956206,0.9562043795620438,1.0,1.0,0.6894736842105263,0.2789473684210526
   ◦                                                                                                                               −0.015,3.0,0.051094890510948905,0.948905109489051,2.0,64.0,0.015789473684210527,0.2789473684210526
 0,1.0,0.5,0.5,1.0,1.0,0.005263157894736842,0.9894736842105263
            True κ             Predicted κbiased            Residual               Predicted κbiased           Residual,12.0,0.44537815126050423,0.5546218487394958,8.0,25.0,0.06315789473684211,0.37368421052631584
                                                                                                                                   0.3,131.0,0.022388059701492536,0.9776119402985075,1.0,1.0,0.6894736842105263,0.2947368421052632
 4 ◦                                                                                                                               0.2,1.0,0.03731343283582089,0.9626865671641791,3.0,64.0,0.005263157894736842,0.2947368421052632
                                                                                                                                   0.1,131.0,0.022388059701492536,0.9776119402985075,1.0,1.0,0.6894736842105263,0.2947368421052632
                                                                                                                                   0.0,131.0,0.022388059701492536,0.9776119402985075,1.0,1.0,0.6894736842105263,0.2947368421052632
 2◦,1.0,0.6666666666666666,0.33333333333333337,1.0,1.0,0.005263157894736842,0.9842105263157894
                                                                                                                                   −0.1,131.0,0.02962962962962963,0.9703703703703703,1.0,1.0,0.6894736842105263,0.2894736842105263
                                                                                                                                   −0.2,131.0,0.02962962962962963,0.9703703703703703,1.0,1.0,0.6894736842105263,0.2894736842105263
 0 ◦                                                                                                                               −0.3,1.0,0.044444444444444446,0.9555555555555556,3.0,64.0,0.005263157894736842,0.2894736842105263
            True E            Predicted E biased            Residual               Predicted E biased          Residual         µK,12.0,0.4230769230769231,0.5769230769230769,11.0,29.0,0.06315789473684211,0.3157894736842105
                                                                                                                                   15,131.0,0.015037593984962405,0.9849624060150376,1.0,1.0,0.6894736842105263,0.30000000000000004
 4◦,1.0,0.6666666666666666,0.33333333333333337,1.0,1.0,0.005263157894736842,0.9842105263157894
                                                                                                                                   10,131.0,0.015037593984962405,0.9849624060150376,1.0,1.0,0.6894736842105263,0.30000000000000004
                                                                                                                                   5,131.0,0.007575757575757576,0.9924242424242424,1.0,1.0,0.6894736842105263,0.3052631578947368
                                                                                                                                   0,131.0,0.007575757575757576,0.9924242424242424,1.0,1.0,0.6894736842105263,0.3052631578947368
 2◦                                                                                                                                −5,1.0,0.03007518796992481,0.9699248120300752,2.0,65.0,0.005263157894736842,0.30000000000000004
                                                                                                                                   −10,131.0,0.022388059701492536,0.9776119402985075,1.0,1.0,0.6894736842105263,0.2947368421052632
                                                                                                                                   −15,131.0,0.022388059701492536,0.9776119402985075,1.0,1.0,0.6894736842105263,0.2947368421052632
 0◦,1.0,0.6666666666666666,0.33333333333333337,1.0,1.0,0.005263157894736842,0.9842105263157894
     0◦     2◦       4◦    0◦        2◦       4◦     0◦      2◦       4◦      0◦         2◦       4◦   0◦        2◦        4◦,5.0,0.24,0.76,15.0,42.0,0.02631578947368421,0.3421052631578947
FIG. 2. Sample ResUNet-CMB predictions from fully trained networks for two noise levels compared to the true maps. The,0.0,0.847457627118644,0.15254237288135597,19.0,1.0,0.0,0.3789473684210526
predicted maps shown here have not been rescaled as in Eq. (18) and thus have a multiplicative bias. Residual maps are,0.0,0.8305084745762712,0.1694915254237288,21.0,1.0,0.0,0.3789473684210526
calculated as the true map minus the predicted map.,0.0,0.8431372549019608,0.1568627450980392,9.0,1.0,0.0,0.7315789473684211
reionization on the CMB polarization is orders of mag-                                      B.     Power Spectra,0.0,0.5357142857142857,0.4642857142857143,12.0,22.0,0.0,0.41052631578947374
nitude smaller than lensing for the chosen cosmological,0.0,0.8727272727272727,0.12727272727272732,8.0,1.0,0.0,0.7105263157894737
"parameters. The noiseless κbiased and E biased are lack-                 Next, we compare the recovered pseudo-power spectra",0.0,0.75,0.25,16.0,9.0,0.0,0.34736842105263155
ing features on only the smallest scales as can be seen in           from the ResUNet-CMB prediction at each noise level,0.0,0.7583333333333333,0.2416666666666667,20.0,6.0,0.0,0.368421052631579
the residual maps which show the difference between the              to the truth power spectrum for each map. In Fig. 3,0.0,0.7333333333333333,0.2666666666666667,20.0,8.0,0.0,0.368421052631579
predicted and truth maps.                                                                                 biased biased,0.0,0.2857142857142857,0.7142857142857143,6.0,41.0,0.0,0.37368421052631584
                                                                     we show a naively corrected hC`τ           τ,69.0,0.24778761061946902,0.752212389380531,7.0,6.0,0.3631578947368421,0.4052631578947369
                                                                                                                        i pseudo-power,120.0,0.09701492537313433,0.9029850746268657,2.0,1.0,0.631578947368421,0.2947368421052632
                                                                     spectrum for each noise level. To get the spectra we,69.0,0.35537190082644626,0.6446280991735538,10.0,1.0,0.3631578947368421,0.3631578947368421
"      With an increase in noise, all predictions degrade with        calculate the auto-power spectrum of each τ biased map",6.0,0.7560975609756098,0.24390243902439024,18.0,5.0,0.031578947368421054,0.3526315789473684
κbiased and τ biased seeing the largest change. The pri-             from the prediction set and average the results to find,0.0,0.75,0.25,20.0,7.0,0.0,0.34736842105263155
                                                                          biased biased,74.0,0.13793103448275862,0.8620689655172413,2.0,1.0,0.3894736842105263,0.5421052631578948
mary E-mode polarization is still faithfully reconstructed           hC`τ        τ,0.0,0.6951219512195121,0.30487804878048785,9.0,10.0,0.0,0.5684210526315789
                                                                                        i. We then make a simple correction for,88.0,0.25196850393700787,0.7480314960629921,8.0,1.0,0.4631578947368421,0.3315789473684211
on most scales despite increasing instrument noise. The              power loss due to the window applied to each map by,0.0,0.7416666666666667,0.2583333333333333,19.0,8.0,0.0,0.368421052631579
1 µK-arcmin reconstruction of τ biased has residual power            dividing the spectra by the mean of the squared cosine,0.0,0.7642276422764228,0.2357723577235772,19.0,7.0,0.0,0.3526315789473684
that is about 18% higher for ` < 840 than that of the                taper. The true input spectrum is the window-corrected,0.0,0.7154471544715447,0.2845528455284553,21.0,9.0,0.0,0.3526315789473684
"noiseless reconstruction of τ biased , where the residual            average pseudo-power spectra of the noiseless truth maps",0.0,0.784,0.21599999999999997,17.0,7.0,0.0,0.3421052631578947
power is defined as the power spectrum of the true map               τ (n̂) in the prediction set.,0.0,0.6938775510204082,0.30612244897959184,17.0,8.0,0.0,0.4842105263157894
"minus the predicted map. There is a larger fractional                    As expected, reconstruction of τ by the ResUNet-CMB",0.0,0.717741935483871,0.282258064516129,17.0,11.0,0.0,0.34736842105263155
increase in the residual power for κbiased with the addi-            network is best at low ` (large angular scales) and de-,0.0,0.75,0.25,21.0,7.0,0.0,0.34736842105263155
"tion of noise, especially in the range 56 < ` < 1500. The            grades on small scales. As we increase instrumental noise,",0.0,0.7480314960629921,0.25196850393700787,22.0,7.0,0.0,0.3315789473684211
predictions of E biased are most affected by noise on small          the fidelity of the reconstruction worsens on all scales.,0.0,0.7777777777777778,0.2222222222222222,20.0,6.0,0.0,0.33684210526315794
"scales, and the increase in the residual power peaks at              There is a larger decrease in the reconstructed power",0.0,0.7459016393442623,0.25409836065573765,19.0,8.0,0.0,0.35789473684210527
about ` = 2900 when comparing the noiseless and 1 µK-                when going from the noiseless case to 1 µK-arcmin than,0.0,0.7154471544715447,0.2845528455284553,21.0,9.0,0.0,0.3526315789473684
arcmin predictions.                                                  there is between 1 µK-arcmin and 2 µK-arcmin.,0.0,0.49122807017543857,0.5087719298245614,10.0,26.0,0.0,0.4
avr_spaces,43.875,1.0,0.0,1.0,1.0,0.23092105263157894,0.9473684210526316
                                                                                                                                                                                            9,188.0,0.005291005291005291,0.9947089947089947,1.0,1.0,0.9894736842105263,0.0052631578947368585
                      10−5,22.0,0.15384615384615385,0.8461538461538461,1.0,1.0,0.11578947368421053,0.8631578947368421
                      10−6,22.0,0.15384615384615385,0.8461538461538461,1.0,1.0,0.11578947368421053,0.8631578947368421
                                                                                           `(` + 1)C`EE /(2π) [µK2 ],91.0,0.1724137931034483,0.8275862068965517,6.0,1.0,0.4789473684210526,0.3894736842105263
                                                                                                                        101,120.0,0.024390243902439025,0.975609756097561,1.0,1.0,0.631578947368421,0.3526315789473684
`(` + 1)C`τ τ /(2π),0.0,0.7894736842105263,0.21052631578947367,5.0,1.0,0.0,0.9
                      10−7,22.0,0.15384615384615385,0.8461538461538461,1.0,1.0,0.11578947368421053,0.8631578947368421
                      10−8,22.0,0.15384615384615385,0.8461538461538461,1.0,1.0,0.11578947368421053,0.8631578947368421
                                                                                                                        100,120.0,0.024390243902439025,0.975609756097561,1.0,1.0,0.631578947368421,0.3526315789473684
                      10−9,22.0,0.15384615384615385,0.8461538461538461,1.0,1.0,0.11578947368421053,0.8631578947368421
                      10−10          True Spectrum:   Input τ                                                                                True Spectrum:   Input Primordial E,22.0,0.30113636363636365,0.6988636363636364,10.0,48.0,0.11578947368421053,0.0736842105263158
                      10   −11       ResUNet-CMB:     Noiseless                                                        10−1                  ResUNet-CMB:     Noiseless,22.0,0.30538922155688625,0.6946107784431137,7.0,46.0,0.11578947368421053,0.12105263157894741
                                     ResUNet-CMB:     0.2 µK-arcmin                                                                          ResUNet-CMB:     0.2 µK-arcmin,37.0,0.2807017543859649,0.7192982456140351,6.0,42.0,0.19473684210526315,0.09999999999999998
                      10−12          ResUNet-CMB:     1 µK-arcmin                                                                            ResUNet-CMB:     1 µK-arcmin,22.0,0.28994082840236685,0.7100591715976332,7.0,48.0,0.11578947368421053,0.1105263157894737
                                     ResUNet-CMB:     2 µK-arcmin                                                                            ResUNet-CMB:     2 µK-arcmin,37.0,0.2603550295857988,0.7396449704142012,6.0,43.0,0.19473684210526315,0.1105263157894737
                      10−13                                                                                            10−2,22.0,0.07317073170731707,0.926829268292683,2.0,47.0,0.11578947368421053,0.3526315789473684
                                 0   500      1000        1500        2000   2500   3000                                      0   500     1000     1500        2000      2500      3000,33.0,0.26229508196721313,0.7377049180327868,14.0,49.0,0.1736842105263158,0.0368421052631579
                                                                 `                                                                                        `,65.0,0.012903225806451613,0.9870967741935484,2.0,45.0,0.34210526315789475,0.1842105263157895
FIG. 3. Power spectra of the optical depth fluctuation maps                                FIG. 5. Power spectra of the primordial E-mode polarization,0.0,0.6733333333333333,0.32666666666666666,19.0,17.0,0.0,0.21052631578947367
τ biased predicted by ResUNet-CMB for each of four noise lev-                              maps E biased predicted by ResUNet-CMB for each of four,0.0,0.6643835616438356,0.3356164383561644,21.0,16.0,0.0,0.2315789473684211
els averaged over the 7000 realizations included in the pre-                               noise levels averaged over the 7000 realizations included in,0.0,0.6821192052980133,0.3178807947019867,19.0,16.0,0.0,0.20526315789473681
"diction set, compared to the averaged power spectrum of the                                the prediction set, compared to the averaged power spectrum",0.0,0.6733333333333333,0.32666666666666666,19.0,17.0,0.0,0.21052631578947367
true patchy reionization maps (black dashed-dot).                                          of the true primordial E modes (black dashed-dot).,0.0,0.6170212765957447,0.3829787234042553,14.0,22.0,0.0,0.2578947368421053
                      10−7                                                                 noise. We find the noiseless E-mode power spectrum,22.0,0.3333333333333333,0.6666666666666667,9.0,33.0,0.11578947368421053,0.2578947368421053
                                                                                           recovery to be greater than about 98% for the ` range,91.0,0.2986111111111111,0.7013888888888888,11.0,1.0,0.4789473684210526,0.2421052631578947
                                                                                           of 170 < ` < 1400. At about ` = 3000 we find E-,91.0,0.2463768115942029,0.7536231884057971,14.0,1.0,0.4789473684210526,0.27368421052631575
                      10−8,22.0,0.15384615384615385,0.8461538461538461,1.0,1.0,0.11578947368421053,0.8631578947368421
"                                                                                           mode recovery of around 86%. At higher noise levels,",91.0,0.3076923076923077,0.6923076923076923,9.0,1.0,0.4789473684210526,0.24736842105263157
                                                                                           the predicted primordial E-mode spectrum falls signifi-,91.0,0.3356164383561644,0.6643835616438356,7.0,1.0,0.4789473684210526,0.2315789473684211
C`κκ                  10−9                                                                 cantly below the input spectrum on small angular scales.,0.0,0.38095238095238093,0.6190476190476191,11.0,42.0,0.0,0.22631578947368425
                                                                                           The impact of noise on the reconstruction of E modes is,91.0,0.3082191780821918,0.6917808219178082,11.0,1.0,0.4789473684210526,0.2315789473684211
                      10−10          True Spectrum:   Input κ                              smaller than that for κ and τ on all scales.,22.0,0.43703703703703706,0.5629629629629629,15.0,22.0,0.11578947368421053,0.2894736842105263
                                     ResUNet-CMB:     Noiseless                               We note that the results for our ResUNet-CMB lensing,37.0,0.4452054794520548,0.5547945205479452,11.0,18.0,0.19473684210526315,0.2315789473684211
                                     ResUNet-CMB:     0.2 µK-arcmin,37.0,0.3582089552238806,0.6417910447761195,3.0,3.0,0.19473684210526315,0.6473684210526316
                                     ResUNet-CMB:     1 µK-arcmin,37.0,0.3384615384615385,0.6615384615384615,3.0,3.0,0.19473684210526315,0.6578947368421053
                                                                                           reconstruction match well with what is found in Ref. [77].,91.0,0.3288590604026846,0.6711409395973154,10.0,1.0,0.4789473684210526,0.21578947368421053
"                      10−11                                                                However, we find that our reconstructed E-mode power",22.0,0.34965034965034963,0.6503496503496504,9.0,33.0,0.11578947368421053,0.24736842105263157
                                     ResUNet-CMB:     2 µK-arcmin,37.0,0.3384615384615385,0.6615384615384615,3.0,3.0,0.19473684210526315,0.6578947368421053
                                                                                           is closer to the input spectrum on all scales than what,91.0,0.3082191780821918,0.6917808219178082,11.0,1.0,0.4789473684210526,0.2315789473684211
                                 0   500      1000        1500        2000   2500   3000,33.0,0.2727272727272727,0.7272727272727273,7.0,15.0,0.1736842105263158,0.5368421052631579
"                                                                                           was found in Ref. [77], though we have not been able to",91.0,0.3013698630136986,0.6986301369863014,12.0,1.0,0.4789473684210526,0.2315789473684211
                                                                 `,65.0,0.015151515151515152,0.9848484848484849,1.0,1.0,0.34210526315789475,0.6526315789473685
                                                                                           identify the cause of this difference.,91.0,0.2558139534883721,0.7441860465116279,6.0,1.0,0.4789473684210526,0.32105263157894737
FIG. 4. Power spectra of the lensing convergence maps κbiased,0.0,0.8524590163934426,0.14754098360655743,10.0,1.0,0.0,0.6789473684210526
predicted by ResUNet-CMB for each of four noise levels aver-                                                                                  C.    Noise,0.0,0.3790849673202614,0.6209150326797386,12.0,44.0,0.0,0.1947368421052632
"aged over the 7000 realizations included in the prediction set,",0.0,0.8571428571428571,0.1428571428571429,10.0,1.0,0.0,0.668421052631579
compared to the averaged power spectrum of the true lensing,0.0,0.847457627118644,0.15254237288135597,10.0,1.0,0.0,0.6894736842105262
convergence maps (black dashed-dot).                                                          We can also compare the results of the ResUNet-CMB,0.0,0.5208333333333334,0.47916666666666663,13.0,30.0,0.0,0.2421052631578947
                                                                                           network to the standard quadratic estimator. In order,91.0,0.3194444444444444,0.6805555555555556,8.0,1.0,0.4789473684210526,0.2421052631578947
"                                                                                           to do so, we need to define the reconstruction noise of",91.0,0.3082191780821918,0.6917808219178082,11.0,1.0,0.4789473684210526,0.2315789473684211
                                                                                           the deep learning results. The ResUNet-CMB prediction,91.0,0.3263888888888889,0.6736111111111112,7.0,1.0,0.4789473684210526,0.2421052631578947
"   Figure 4 and Fig. 5 show the power spectra for the                                      of the modulation field, after post-processing, is a biased",3.0,0.6066666666666667,0.3933333333333333,20.0,20.0,0.015789473684210527,0.21052631578947367
"ResUNet-CMB reconstructions, κbiased and E biased , re-                                    result τ biased . Before calculating the reconstruction noise",0.0,0.6644736842105263,0.3355263157894737,17.0,19.0,0.0,0.19999999999999996
"spectively. For the κbiased spectra, the reconstruction                                    we first need to address this bias. Following treatment of",0.0,0.6577181208053692,0.3422818791946308,17.0,19.0,0.0,0.21578947368421053
"quickly worsens with increasing instrument noise, espe-                                    the bias to the reconstructed lensing field from Ref. [77],",0.0,0.66,0.33999999999999997,17.0,19.0,0.0,0.21052631578947367
cially on small angular scales. Of the three ResUNet-                                      we define a quantity,0.0,0.5585585585585585,0.4414414414414415,13.0,20.0,0.0,0.4157894736842105
"CMB outputs, κ sees the strongest scale dependence in",0.0,0.8490566037735849,0.15094339622641506,9.0,1.0,0.0,0.7210526315789474
                                                                                                                                       #−1,135.0,0.021739130434782608,0.9782608695652174,1.0,1.0,0.7105263157894737,0.27368421052631575
its deviation from the input spectrum.,0.0,0.868421052631579,0.13157894736842102,6.0,1.0,0.0,0.8
"                                                                                                                     ""        biased",117.0,0.05303030303030303,0.946969696969697,2.0,5.0,0.6157894736842106,0.3052631578947368
                                                                                                                       hC`τ τ        i,119.0,0.04477611940298507,0.9552238805970149,3.0,5.0,0.6263157894736842,0.2947368421052632
"   The reconstructed primordial E-mode map gives re-                                                           A` =                        ,        (17)",3.0,0.3355263157894737,0.6644736842105263,11.0,46.0,0.015789473684210527,0.19999999999999996
                                                                                                                         hC`τ τ i,121.0,0.046511627906976744,0.9534883720930233,3.0,1.0,0.6368421052631579,0.32105263157894737
sults closer to the input than both the τ and κ ResUNet-,0.0,0.8035714285714286,0.1964285714285714,12.0,1.0,0.0,0.7052631578947368
CMB estimates across the entire range of scales we con-                                    where h· · · i represents the average over the entire predic-,0.0,0.631578947368421,0.368421052631579,22.0,19.0,0.0,0.19999999999999996
"sider. This is not surprising, given that on the scales we                                 tion set. The quantity A` is used to rescale the biased",0.0,0.636986301369863,0.363013698630137,22.0,17.0,0.0,0.2315789473684211
consider the primordial E-mode polarization does not dif-                                  output to recover an unbiased estimate of the optical,0.0,0.6597222222222222,0.3402777777777778,17.0,18.0,0.0,0.2421052631578947
fer a great deal from the modulated and lensed E-mode                                      depth fluctuations,0.0,0.5596330275229358,0.44036697247706424,12.0,20.0,0.0,0.4263157894736842
"polarization, the latter of which is just a linear combi-",0.0,0.8421052631578947,0.1578947368421053,10.0,1.0,0.0,0.7
nation of the input Q and U maps in the absence of                                                                                      τ̂ (`) = A` τ biased (`) .                        (18),0.0,0.3263157894736842,0.6736842105263158,21.0,56.0,0.0,0.0
avr_spaces,39.61971830985915,1.0,0.0,1.0,1.0,0.20852483320978502,0.9473684210526316
                                                                                                                                                                            10,172.0,0.011494252873563218,0.9885057471264368,1.0,1.0,0.9052631578947369,0.08421052631578951
                      10−1                                                         Noiseless                          10−1                                  0.2 µK-arcmin,22.0,0.17159763313609466,0.8284023668639053,5.0,59.0,0.11578947368421053,0.1105263157894737
`(` + 1)N`τ τ /(2π)                                                                             `(` + 1)N`τ τ /(2π),0.0,0.2608695652173913,0.7391304347826086,10.0,39.0,0.0,0.39473684210526316
                      10−3                                                                                            10−3,22.0,0.06557377049180328,0.9344262295081968,2.0,47.0,0.11578947368421053,0.35789473684210527
                      10−5                                                                                            10−5,22.0,0.06557377049180328,0.9344262295081968,2.0,47.0,0.11578947368421053,0.35789473684210527
                                   Theory C`τ τ,35.0,0.2127659574468085,0.7872340425531915,3.0,1.0,0.18421052631578946,0.7526315789473684
                      10−7         Lensing bias to QE                                                                 10−7,22.0,0.1885245901639344,0.8114754098360656,6.0,37.0,0.11578947368421053,0.35789473684210527
                                   ResUNet-CMB N`τ τ,35.0,0.28846153846153844,0.7115384615384616,3.0,1.0,0.18421052631578946,0.7263157894736842
                                   QE N`τ τ : Lensed CMB,35.0,0.2857142857142857,0.7142857142857143,6.0,1.0,0.18421052631578946,0.7052631578947368
                      10−9                                                                                            10−9,22.0,0.06557377049180328,0.9344262295081968,2.0,47.0,0.11578947368421053,0.35789473684210527
                                   QE N`τ τ : Iteratively Delensed and Descreened CMB,35.0,0.49411764705882355,0.5058823529411764,9.0,1.0,0.18421052631578946,0.5526315789473684
                             0      500           1000              1500          2000     2500                              0   500      1000       1500      2000      2500,29.0,0.23121387283236994,0.7687861271676301,12.0,51.0,0.15263157894736842,0.08947368421052626
                                                            `                                                                                    `,60.0,0.0136986301369863,0.9863013698630136,2.0,43.0,0.3157894736842105,0.2315789473684211
                       103                                                      1 µK-arcmin                            103                                   2 µK-arcmin,23.0,0.15476190476190477,0.8452380952380952,6.0,59.0,0.12105263157894737,0.11578947368421055
                       101                                                                                             101,23.0,0.04918032786885246,0.9508196721311475,2.0,47.0,0.12105263157894737,0.35789473684210527
`(` + 1)N`τ τ /(2π)                                                                             `(` + 1)N`τ τ /(2π),0.0,0.2608695652173913,0.7391304347826086,10.0,39.0,0.0,0.39473684210526316
                      10−1                                                                                            10−1,22.0,0.06557377049180328,0.9344262295081968,2.0,47.0,0.11578947368421053,0.35789473684210527
                      10−3                                                                                            10−3,22.0,0.06557377049180328,0.9344262295081968,2.0,47.0,0.11578947368421053,0.35789473684210527
                      10−5                                                                                            10−5,22.0,0.06557377049180328,0.9344262295081968,2.0,47.0,0.11578947368421053,0.35789473684210527
                      10−7                                                                                            10−7,22.0,0.06557377049180328,0.9344262295081968,2.0,47.0,0.11578947368421053,0.35789473684210527
                      10−9                                                                                            10−9,22.0,0.06557377049180328,0.9344262295081968,2.0,47.0,0.11578947368421053,0.35789473684210527
                             0      500           1000              1500          2000     2500                              0   500      1000       1500      2000      2500,29.0,0.23121387283236994,0.7687861271676301,12.0,51.0,0.15263157894736842,0.08947368421052626
                                                            `                                                                                    `,60.0,0.0136986301369863,0.9863013698630136,2.0,43.0,0.3157894736842105,0.2315789473684211
"FIG. 6. Reconstruction noise power spectra of ResUNet-CMB normalized prediction τ̂ as defined in Eq. (19) (blue), standard",0.0,0.860655737704918,0.139344262295082,18.0,1.0,0.0,0.35789473684210527
"quadratic estimator using lensed CMB spectra (QE; dashed red), and a quadratic estimator using iteratively delensed and",0.0,0.865546218487395,0.134453781512605,17.0,1.0,0.0,0.37368421052631584
descreened CMB spectra (QE; dotted red). The expected lensing bias to the EB quadratic estimator for τ (Eq. (15)) is plotted,0.0,0.8387096774193549,0.16129032258064513,21.0,1.0,0.0,0.34736842105263155
in cyan where it is positive and coral where negative.,0.0,0.8333333333333334,0.16666666666666663,10.0,1.0,0.0,0.7157894736842105
Estimates on real data using ResUNet-CMB would also                                                                  The iteratively delensed and descreened estimate of,0.0,0.5297619047619048,0.47023809523809523,15.0,34.0,0.0,0.11578947368421055
require rescaling by the same quantity A` . The unbi-                                                             the patchy reionization reconstruction noise was calcu-,0.0,0.5502958579881657,0.4497041420118343,17.0,31.0,0.0,0.1105263157894737
"ased estimate τ̂ can be directly compared to the unbiased                                                         lated as follows. First, we calculate the effects of patchy",0.0,0.5664739884393064,0.4335260115606936,20.0,29.0,0.0,0.08947368421052626
estimate from the quadratic estimator discussed in Sec-                                                           reionization on the CMB polarization spectra. We use,0.0,0.5602409638554217,0.43975903614457834,16.0,30.0,0.0,0.12631578947368416
tion II. The reconstruction noise spectrum can then be                                                            these screened spectra to calculate an estimate of the,0.0,0.5476190476190477,0.45238095238095233,18.0,31.0,0.0,0.11578947368421055
"defined in a way analogous to the definition in Ref. [77],                                                        lensing reconstruction noise using the iterative EB es-",0.0,0.5680473372781065,0.4319526627218935,19.0,29.0,0.0,0.1105263157894737
                                                                                                                  timator [32]. The B-mode polarization from the patchy,114.0,0.2754491017964072,0.7245508982035929,8.0,1.0,0.6,0.12105263157894741
"                                    N`τ τ = hC`τ̂ τ̂ i − hC`τ τ i ,                      (19)                     reionization acts as an effective source of noise for lensing",36.0,0.44,0.56,22.0,22.0,0.18947368421052632,0.07894736842105265
"                                                                                                                  reconstruction, thereby increasing the lensing reconstruc-",114.0,0.3081395348837209,0.6918604651162791,6.0,1.0,0.6,0.09473684210526312
where we have used,0.0,0.8333333333333334,0.16666666666666663,4.0,1.0,0.0,0.9052631578947369
                                                                                                                  tion noise as compared to a case without patchy reion-,114.0,0.26785714285714285,0.7321428571428572,10.0,1.0,0.6,0.11578947368421055
                                                         biased biased,57.0,0.17142857142857143,0.8285714285714285,2.0,1.0,0.3,0.631578947368421
                                 hC`τ̂ τ̂ i = A2` hC`τ          τ,33.0,0.26153846153846155,0.7384615384615385,7.0,6.0,0.1736842105263158,0.6578947368421053
                                                                           i.            (20)                     ization. We use the resulting lensing reconstruction noise,75.0,0.3313953488372093,0.6686046511627908,10.0,17.0,0.39473684210526316,0.09473684210526312
                                                                                                                  to compute delensed CMB spectra according to Ref. [41].,114.0,0.2781065088757396,0.7218934911242604,9.0,1.0,0.6,0.1105263157894737
It is this definition of the reconstruction noise that we                                                         The resulting delensed CMB spectra were used in the es-,0.0,0.5562130177514792,0.44378698224852076,20.0,29.0,0.0,0.1105263157894737
will compare to the quadratic estimator.                                                                          timate of the patchy reionization reconstruction noise us-,0.0,0.5,0.5,14.0,38.0,0.0,0.09473684210526312
"   We calculate the reconstruction noise of the EB                                                                ing the EB estimator, with the residual lensing B-mode",3.0,0.5119047619047619,0.48809523809523814,17.0,33.0,0.015789473684210527,0.11578947368421055
quadratic estimator using Eq. (11) (with `max = 6100).                                                            polarization acting as a source of noise for the patchy,0.0,0.5443786982248521,0.4556213017751479,19.0,31.0,0.0,0.1105263157894737
"As discussed in Section II, the variance of the EB es-                                                            reionization reconstruction. If we had stopped the pro-",0.0,0.5443786982248521,0.4556213017751479,19.0,31.0,0.0,0.1105263157894737
"timator is increased in the presence of lensing, due to                                                           cedure at this point, we would find that ResUNet-CMB",0.0,0.5421686746987951,0.45783132530120485,19.0,30.0,0.0,0.12631578947368416
the B-mode polarization induced by lensing. We there-                                                             outperformed this delensed quadratic estimator in the,0.0,0.5568862275449101,0.44311377245508987,15.0,31.0,0.0,0.12105263157894741
"fore consider two versions of the quadratic estimator: one                                                        low noise cases we considered. However, a lower patchy",0.0,0.5714285714285714,0.4285714285714286,18.0,29.0,0.0,0.11578947368421055
"for which we used lensed CMB spectra, and another for                                                             reionization reconstruction noise can be achieved by it-",0.0,0.5470588235294118,0.4529411764705882,18.0,31.0,0.0,0.10526315789473684
which we employ an iterative delensing and descreening                                                            eratively ‘descreening’ the CMB to remove the best es-,0.0,0.5535714285714286,0.4464285714285714,17.0,31.0,0.0,0.11578947368421055
procedure to the CMB spectra.,0.0,0.8620689655172413,0.13793103448275867,5.0,1.0,0.0,0.8473684210526315
avr_spaces,26.22222222222222,1.0,0.0,1.0,1.0,0.13801169590643275,0.9473684210526316
                                                                                                                                                                  11,162.0,0.012195121951219513,0.9878048780487805,1.0,1.0,0.8526315789473684,0.13684210526315788
                                 True Spectrum: Input τ                     Noiseless                                                               0.2 µK-arcmin,33.0,0.2484472049689441,0.7515527950310559,7.0,42.0,0.1736842105263158,0.15263157894736845
                            0    QE: C`τ̂ τ̂,28.0,0.22727272727272727,0.7727272727272727,4.0,3.0,0.14736842105263157,0.7684210526315789
                       10                                                                                      100,23.0,0.043859649122807015,0.956140350877193,2.0,44.0,0.12105263157894737,0.4
                                 ResUNet-CMB: C`τ̂ τ̂,33.0,0.33962264150943394,0.6603773584905661,3.0,1.0,0.1736842105263158,0.7210526315789474
`(` + 1)C`τ τ /(2π)                                                                     `(` + 1)C`τ τ /(2π),0.0,0.2803738317757009,0.719626168224299,10.0,35.0,0.0,0.4368421052631579
                                 Lensing bias to QE,33.0,0.29411764705882354,0.7058823529411764,4.0,1.0,0.1736842105263158,0.7315789473684211
                      10−2                                                                                    10−2,22.0,0.07017543859649122,0.9298245614035088,2.0,43.0,0.11578947368421053,0.4
                      10−4                                                                                    10−4,22.0,0.07017543859649122,0.9298245614035088,2.0,43.0,0.11578947368421053,0.4
                      10−6                                                                                    10−6,22.0,0.07017543859649122,0.9298245614035088,2.0,43.0,0.11578947368421053,0.4
                      10−8                                                                                    10−8,22.0,0.07017543859649122,0.9298245614035088,2.0,43.0,0.11578947368421053,0.4
                                500     1000      1500        2000   2500    3000                                    500   1000   1500       2000   2500   3000,32.0,0.2893081761006289,0.7106918238993711,12.0,38.0,0.16842105263157894,0.16315789473684206
                                                          `                                                                              `,58.0,0.014492753623188406,0.9855072463768116,2.0,40.0,0.30526315789473685,0.27368421052631575
                                                                     1 µK-arcmin                               101                                   2 µK-arcmin,69.0,0.14375,0.85625,5.0,33.0,0.3631578947368421,0.1578947368421053
                       100,23.0,0.11538461538461539,0.8846153846153846,1.0,1.0,0.12105263157894737,0.8631578947368421
                                                                                                              10−1,110.0,0.03508771929824561,0.9649122807017544,1.0,1.0,0.5789473684210527,0.4
`(` + 1)C`τ τ /(2π)                                                                     `(` + 1)C`τ τ /(2π),0.0,0.2803738317757009,0.719626168224299,10.0,35.0,0.0,0.4368421052631579
                      10−2,22.0,0.15384615384615385,0.8461538461538461,1.0,1.0,0.11578947368421053,0.8631578947368421
                                                                                                              10−3,110.0,0.03508771929824561,0.9649122807017544,1.0,1.0,0.5789473684210527,0.4
                      10−4,22.0,0.15384615384615385,0.8461538461538461,1.0,1.0,0.11578947368421053,0.8631578947368421
                                                                                                              10−5,110.0,0.03508771929824561,0.9649122807017544,1.0,1.0,0.5789473684210527,0.4
                      10−6                                                                                    10−7,22.0,0.07017543859649122,0.9298245614035088,2.0,43.0,0.11578947368421053,0.4
                      10−8                                                                                    10−9,22.0,0.07017543859649122,0.9298245614035088,2.0,43.0,0.11578947368421053,0.4
                                500     1000      1500        2000   2500    3000                                    500   1000   1500       2000   2500   3000,32.0,0.2893081761006289,0.7106918238993711,12.0,38.0,0.16842105263157894,0.16315789473684206
                                                          `                                                                              `,58.0,0.014492753623188406,0.9855072463768116,2.0,40.0,0.30526315789473685,0.27368421052631575
FIG. 7. Power spectra of the patchy τ field reconstructed by ResUNet-CMB (blue) and the quadratic estimator (QE; red),0.0,0.8461538461538461,0.15384615384615385,19.0,1.0,0.0,0.38421052631578945
computed from reconstructed maps that are averaged over a set of 7000 simulations with a fixed lensing convergence and patchy,0.0,0.848,0.15200000000000002,20.0,1.0,0.0,0.3421052631578947
"reionization field, compared with the true input τ signal power spectrum (black dash-dot) and the expected lensing bias to the",0.0,0.8492063492063492,0.1507936507936508,20.0,1.0,0.0,0.33684210526315794
"quadratic estimator (cyan dashed where the bias is positive, coral dashed where the bias is negative). The sharp features in the",0.0,0.84375,0.15625,21.0,1.0,0.0,0.3263157894736842
power spectra are dependent on the random seeds chosen for the simulations. The quadratic estimator spectra were calculated,0.0,0.8617886178861789,0.1382113821138211,18.0,1.0,0.0,0.3526315789473684
"from maps with no cosine taper applied, and we perform a mean-field subtraction on the estimate, τ̂ .",0.0,0.8316831683168316,0.16831683168316836,18.0,1.0,0.0,0.46842105263157896
timate of the effects of patchy reionization on the polar-                                           sulting from the maximum likelihood estimate of simul-,0.0,0.6193548387096774,0.38064516129032255,18.0,22.0,0.0,0.1842105263157895
"ization, in a procedure analogous to delensing [98]. We                                              taneous lensing and patchy reionization reconstruction,",0.0,0.6217948717948718,0.3782051282051282,15.0,24.0,0.0,0.17894736842105263
"performed this iterative EB descreening estimate, then                                               though the latter has not been demonstrated explicitly.",0.0,0.6153846153846154,0.3846153846153846,15.0,24.0,0.0,0.17894736842105263
"used the residual effects of patchy reionization on the                                                 In addition to the extra variance due to lensing, the",0.0,0.5796178343949044,0.42038216560509556,19.0,25.0,0.0,0.17368421052631577
polarization spectra to compute an improved estimate of                                              quadratic estimator also exhibits a bias to the reconstruc-,0.0,0.61875,0.38125,17.0,24.0,0.0,0.1578947368421053
the lensing reconstruction noise using the iterative EB                                              tion of the patchy reionization in the presence of lensing.,0.0,0.6125,0.38749999999999996,18.0,24.0,0.0,0.1578947368421053
estimator. This resulted in a lower lensing reconstruc-                                              We calculate this bias according to Eq. (15). The bias-,0.0,0.6025641025641025,0.39743589743589747,18.0,24.0,0.0,0.17894736842105263
tion noise which was then used to calculate an improved                                              hardened estimator from Ref. [73] has only a percent-level,0.0,0.6037735849056604,0.39622641509433965,19.0,24.0,0.0,0.16315789473684206
estimate of delensed spectra. We iterated this procedure                                             increase in variance compared to the standard estima-,0.0,0.6168831168831169,0.3831168831168831,16.0,23.0,0.0,0.18947368421052635
"of iterative EB lensing reconstruction and delensing fol-                                            tor, and so we present the reconstruction noise computed",0.0,0.6242038216560509,0.37579617834394907,17.0,23.0,0.0,0.17368421052631577
lowed by iterative EB patchy reionization reconstruction                                             from the standard estimator.,0.0,0.5813953488372093,0.41860465116279066,11.0,23.0,0.0,0.32105263157894737
and descreening followed by iterative EB lensing recon-,0.0,0.8727272727272727,0.12727272727272732,8.0,1.0,0.0,0.7105263157894737
"struction and delensing, etc., to convergence. The output                                               Figure 6 shows the patchy reionization reconstruc-",0.0,0.6103896103896104,0.38961038961038963,15.0,24.0,0.0,0.18947368421052635
after convergence of this procedure was used as our es-                                              tion noise power spectra for the quadratic estimator and,0.0,0.5987261146496815,0.4012738853503185,19.0,24.0,0.0,0.17368421052631577
timate of ‘Iteratively Delensed and Descreened’ patchy                                               the normalized ResUNet-CMB predictions for each noise,0.0,0.6168831168831169,0.3831168831168831,14.0,24.0,0.0,0.18947368421052635
reionization reconstruction noise. Since the results of it-                                          level. We also include in each panel the theoretical patchy,0.0,0.6375,0.36250000000000004,18.0,22.0,0.0,0.1578947368421053
erative delensing closely match the performance of the                                               reionization power spectrum and the bias on the standard,0.0,0.6050955414012739,0.39490445859872614,17.0,24.0,0.0,0.17368421052631577
"maximum likelihood lensing estimator [31, 32], it should                                             quadratic estimator due to lensing. For all four noise lev-",0.0,0.61875,0.38125,18.0,23.0,0.0,0.1578947368421053
"be expected that the iterative delensing and descreening                                             els shown, the ResUNet-CMB predictions have a lower",0.0,0.6118421052631579,0.38815789473684215,16.0,23.0,0.0,0.19999999999999996
procedure provides a good approximation of the noise re-                                             reconstruction noise than the quadratic estimator using,0.0,0.6217948717948718,0.3782051282051282,16.0,23.0,0.0,0.17894736842105263
                                                                                                     lensed spectra in the range 200 < ` < 1000. The range,101.0,0.2727272727272727,0.7272727272727273,12.0,1.0,0.531578947368421,0.18947368421052635
avr_spaces,22.471698113207548,1.0,0.0,1.0,1.0,0.1182720953326713,0.9473684210526316
                                                                                                                                           12,139.0,0.014184397163120567,0.9858156028368794,1.0,1.0,0.7315789473684211,0.2578947368421053
         0.6                                                  Noiseless                                                     0.2 µK-arcmin,9.0,0.17518248175182483,0.8248175182481752,4.0,52.0,0.04736842105263158,0.2789473684210526
                                                                                  0.4,82.0,0.03529411764705882,0.9647058823529412,1.0,1.0,0.43157894736842106,0.5526315789473684
         0.4,9.0,0.25,0.75,1.0,1.0,0.04736842105263158,0.9368421052631579
                                                                                  0.2,82.0,0.03529411764705882,0.9647058823529412,1.0,1.0,0.43157894736842106,0.5526315789473684
 r(`)    0.2,1.0,0.5833333333333334,0.41666666666666663,2.0,3.0,0.005263157894736842,0.9368421052631579
                                                                          r(`),74.0,0.05128205128205128,0.9487179487179487,1.0,1.0,0.3894736842105263,0.5894736842105264
         0.0                                                                      0.0,9.0,0.07058823529411765,0.9294117647058824,2.0,36.0,0.04736842105263158,0.5526315789473684
        −0.2             QE: τ τ̂              ResUNet-CMB: τ τ̂,8.0,0.390625,0.609375,7.0,14.0,0.042105263157894736,0.6631578947368422
                         QE: κτ̂               ResUNet-CMB: κτ̂,25.0,0.3333333333333333,0.6666666666666667,4.0,8.0,0.13157894736842105,0.668421052631579
                                                                                 −0.2,81.0,0.047058823529411764,0.9529411764705882,1.0,1.0,0.4263157894736842,0.5526315789473684
               0   500   1000       1500       2000    2500        3000                 0   500   1000    1500       2000    2500   3000,15.0,0.35294117647058826,0.6470588235294117,14.0,33.0,0.07894736842105263,0.28421052631578947
                                           `                                                                     `,43.0,0.017543859649122806,0.9824561403508771,2.0,35.0,0.22631578947368422,0.4
         0.1                                            1 µK-arcmin                                                          2 µK-arcmin,9.0,0.16911764705882354,0.8308823529411764,5.0,52.0,0.04736842105263158,0.28421052631578947
                                                                                  0.0,82.0,0.03529411764705882,0.9647058823529412,1.0,1.0,0.43157894736842106,0.5526315789473684
         0.0,9.0,0.25,0.75,1.0,1.0,0.04736842105263158,0.9368421052631579
                                                                                 −0.1,81.0,0.047058823529411764,0.9529411764705882,1.0,1.0,0.4263157894736842,0.5526315789473684
 r(`)   −0.1                                                              r(`),1.0,0.15384615384615385,0.8461538461538461,3.0,33.0,0.005263157894736842,0.5894736842105264
                                                                                 −0.2,81.0,0.047058823529411764,0.9529411764705882,1.0,1.0,0.4263157894736842,0.5526315789473684
        −0.2,8.0,0.3333333333333333,0.6666666666666667,1.0,1.0,0.042105263157894736,0.9368421052631579
                                                                                 −0.3,81.0,0.047058823529411764,0.9529411764705882,1.0,1.0,0.4263157894736842,0.5526315789473684
        −0.3,8.0,0.3333333333333333,0.6666666666666667,1.0,1.0,0.042105263157894736,0.9368421052631579
               0   500   1000       1500       2000    2500        3000                 0   500   1000    1500       2000    2500   3000,15.0,0.35294117647058826,0.6470588235294117,14.0,33.0,0.07894736842105263,0.28421052631578947
                                           `                                                                     `,43.0,0.017543859649122806,0.9824561403508771,2.0,35.0,0.22631578947368422,0.4
FIG. 8. Correlation coefficients of estimates of the patchy reionization field τ̂ from the standard quadratic estimator (QE),0.0,0.8629032258064516,0.13709677419354838,18.0,1.0,0.0,0.34736842105263155
"with the true patchy reionization field τ (blue) and the lensing convergence field κ (coral), and those from the ResUNet-CMB",0.0,0.8467741935483871,0.15322580645161288,20.0,1.0,0.0,0.34736842105263155
"network with τ (cyan) and κ (red), all averaged over 7000 simulations. The simulations for the quadratic estimator did not use",0.0,0.8412698412698413,0.15873015873015872,21.0,1.0,0.0,0.33684210526315794
a cosine taper nor mean-field subtraction.,0.0,0.8809523809523809,0.11904761904761907,6.0,1.0,0.0,0.7789473684210526
of angular scales where ResUNet-CMB outperforms the                                                      D.   Bias,0.0,0.4473684210526316,0.5526315789473684,9.0,29.0,0.0,0.4
standard quadratic estimator grows as the noise level,0.0,0.8679245283018868,0.13207547169811318,8.0,1.0,0.0,0.7210526315789474
decreases. The ResUNet-CMB N`τ τ matches well with                             In Fig. 7 we show the reconstructed patchy reioniza-,0.0,0.6641221374045801,0.33587786259541985,17.0,15.0,0.0,0.31052631578947365
the reconstruction noise of the quadratic estimator using                   tion power spectrum from ResUNet-CMB and from the,0.0,0.736,0.264,16.0,10.0,0.0,0.3421052631578947
iteratively delensed and descreened CMB spectra for a                       standard quadratic estimator for each noise level. We im-,0.0,0.7142857142857143,0.2857142857142857,17.0,12.0,0.0,0.30000000000000004
"large ` range for all four noise levels. The top two panels                 plement the EB quadratic estimator for τ as in Eq. (10),",0.0,0.7121212121212122,0.28787878787878785,23.0,9.0,0.0,0.3052631578947368
demonstrate that the patchy reconstruction noise from                       by using Symlens5 . The results are computed by aver-,0.0,0.7054263565891473,0.2945736434108527,17.0,12.0,0.0,0.32105263157894737
ResUNet-CMB is also smaller than the bias due to lens-                      aging over a set of 7000 simulated CMB maps with fixed,0.0,0.6846153846153846,0.3153846153846154,21.0,12.0,0.0,0.3157894736842105
ing that is expected in the standard quadratic estimator                    κ and τ maps; the random seed for κ was set to 133,0.0,0.6825396825396826,0.31746031746031744,22.0,11.0,0.0,0.33684210526315794
"over a wide range of scales, and this range is wider at                     and for τ to 180. As expected, the quadratic estimator",0.0,0.6846153846153846,0.3153846153846154,22.0,11.0,0.0,0.3157894736842105
lower noise. This behavior indicates that the ResUNet-                      C`τ̂ τ̂ matches well with the lensing bias computed from,0.0,0.7121212121212122,0.28787878787878785,18.0,12.0,0.0,0.3052631578947368
CMB network learns to reconstruct the patchy τ field in                     Eq. (15). The ResUNet-CMB estimator on the other,0.0,0.7016129032258065,0.2983870967741935,18.0,11.0,0.0,0.34736842105263155
a way that mitigates both the extra variance and the bias                   hand follows more closely the input signal power spec-,0.0,0.7153846153846154,0.2846153846153846,20.0,10.0,0.0,0.3157894736842105
"due to lensing. The ResUNet-CMB network is therefore                        trum, which is most easily seen for the low noise cases. At",0.0,0.6888888888888889,0.3111111111111111,20.0,13.0,0.0,0.2894736842105263
able to successfully reconstruct both the lensing conver-                   low noise the ResUNet-CMB predictions deviate from the,0.0,0.7461538461538462,0.25384615384615383,16.0,10.0,0.0,0.3157894736842105
"gence and patchy reionization fields simultaneously in a                    input spectrum at small angular scales (` & 1500), and",0.0,0.7230769230769231,0.27692307692307694,18.0,11.0,0.0,0.3157894736842105
way that is nearly optimal.                                                 for higher noise deviations appear even at larger scales.,0.0,0.5413533834586466,0.4586466165413534,14.0,25.0,0.0,0.30000000000000004
                                                                               To confirm that the ResUNet-CMB architecture is,79.0,0.3253968253968254,0.6746031746031746,7.0,1.0,0.41578947368421054,0.33684210526315794
                                                                            truly sensitive to the input τ and is not producing a,76.0,0.3333333333333333,0.6666666666666667,11.0,1.0,0.4,0.32105263157894737
                                                                             5   https://github.com/simonsobs/symlens,77.0,0.3162393162393162,0.6837606837606838,2.0,2.0,0.4052631578947368,0.38421052631578945
avr_spaces,25.040816326530614,1.0,0.0,1.0,1.0,0.1317937701396348,0.9473684210526316
                                                                                                                                                                     13,165.0,0.011976047904191617,0.9880239520958084,1.0,1.0,0.868421052631579,0.12105263157894741
spurious signal due to lensing or an artifact of the pro-,0.0,0.8245614035087719,0.17543859649122806,11.0,1.0,0.0,0.7
"cedure, we calculate the correlation coefficients of each                                    10−5                                                     Null Test",0.0,0.389937106918239,0.610062893081761,11.0,45.0,0.0,0.16315789473684206
reconstruction according to,0.0,0.9259259259259259,0.07407407407407407,3.0,1.0,0.0,0.8578947368421053
                                                                                             10−7,93.0,0.041237113402061855,0.9587628865979382,1.0,1.0,0.48947368421052634,0.4894736842105263
                                                                       `(` + 1)C`τ τ /(2π),71.0,0.16666666666666666,0.8333333333333334,5.0,1.0,0.3736842105263158,0.5263157894736843
                                                                                                                                      Theory,134.0,0.04285714285714286,0.9571428571428572,1.0,1.0,0.7052631578947368,0.26315789473684215
                                    hC`Z τ̂ i                                                                                         ResUNet-CMB:   Noiseless,36.0,0.17721518987341772,0.8227848101265822,5.0,46.0,0.18947368421052632,0.16842105263157892
"                  rZ τ̂ (`) = q                       ,        (21)                                                                   ResUNet-CMB:   0.2 µK-arcmin",18.0,0.2345679012345679,0.7654320987654322,10.0,50.0,0.09473684210526316,0.1473684210526316
                                  hC`ZZ ihC`τ̂ τ̂ i                                          10−9                                     ResUNet-CMB:   1 µK-arcmin,34.0,0.25,0.75,8.0,41.0,0.17894736842105263,0.1578947368421053
                                                                                                                                      ResUNet-CMB:   2 µK-arcmin,134.0,0.1375,0.8625,3.0,2.0,0.7052631578947368,0.1578947368421053
"where Z = κ, τ . In Fig. 8 we compare the correlation co-                                    10−11",0.0,0.5,0.5,15.0,19.0,0.0,0.4842105263157894
efficients of the ResUNet-CMB predictions to those of the,0.0,0.8596491228070176,0.14035087719298245,9.0,1.0,0.0,0.7
standard quadratic estimator. Note that our definition of                                    10−13,0.0,0.5612244897959183,0.4387755102040817,9.0,19.0,0.0,0.4842105263157894
the correlation coefficient in Eq. (21) includes in the de-,0.0,0.847457627118644,0.15254237288135597,10.0,1.0,0.0,0.6894736842105262
nominator the reconstruction noise on the patchy reion-                                              0   500        1000   1500       2000   2500        3000,0.0,0.4585987261146497,0.5414012738853503,15.0,38.0,0.0,0.17368421052631577
"ization field, and therefore these coefficients are always                                                                        `",0.0,0.3969465648854962,0.6030534351145038,9.0,37.0,0.0,0.31052631578947365
less than unity. It can clearly be seen that for all noise,0.0,0.8103448275862069,0.18965517241379315,12.0,1.0,0.0,0.6947368421052631
"levels and on almost all scales, the standard quadratic es-            FIG. 9. Null test showing the average power spectra of the",0.0,0.7596899224806202,0.24031007751937983,21.0,7.0,0.0,0.32105263157894737
timator produces an estimate for the optical depth per-                patchy reionization field τ biased predicted from fully trained,0.0,0.7611940298507462,0.23880597014925375,18.0,9.0,0.0,0.2947368421052632
turbation τ̂ which is more strongly correlated with the                ResUNet-CMB networks on a data set of 7000 simulations,0.0,0.744,0.256,18.0,9.0,0.0,0.3421052631578947
lensing convergence κ than it is with the true patchy                  with κ and τ set to zero. The results of this figure should be,0.0,0.6992481203007519,0.3007518796992481,24.0,10.0,0.0,0.30000000000000004
reionization signal τ . The ResUNet-CMB estimate τ̂ has                compared to those in Fig. 3. The theoretical patchy reioniza-,0.0,0.75,0.25,19.0,9.0,0.0,0.3052631578947368
a larger correlation with the true patchy τ signal and                 tion spectrum that is used elsewhere in this work has been,0.0,0.7209302325581395,0.2790697674418605,21.0,9.0,0.0,0.32105263157894737
"smaller correlation with κ than does the quadratic esti-               included in this plot (black dash-dot) to ease comparison, but",0.0,0.7593984962406015,0.24060150375939848,19.0,8.0,0.0,0.30000000000000004
"mator for nearly all scales at each noise level.                       for the null test shown in this figure, the true C`τ τ vanishes.",0.0,0.6814814814814815,0.31851851851851853,22.0,12.0,0.0,0.2894736842105263
"   Furthermore, the ResUNet-CMB patchy reionization",3.0,0.8627450980392157,0.13725490196078427,5.0,1.0,0.015789473684210527,0.7315789473684211
estimate is more strongly correlated with the true signal,0.0,0.8596491228070176,0.14035087719298245,9.0,1.0,0.0,0.7
"than with the lensing convergence on large scales, con-                in the null test is five to seven orders of magnitude smaller",0.0,0.7348484848484849,0.26515151515151514,21.0,9.0,0.0,0.3052631578947368
siderably so at low noise levels. While the quadratic esti-            than the spectrum with patchy reionization included.,0.0,0.7804878048780488,0.2195121951219512,17.0,7.0,0.0,0.3526315789473684
"mator is dominated by the κ signal on almost all scales,                  We found that the ResUNet-CMB network was much",0.0,0.7083333333333334,0.29166666666666663,19.0,10.0,0.0,0.368421052631579
the ResUNet-CMB estimator appears to exhibit a lensing                 less successful on this null test when trained without in-,0.0,0.7441860465116279,0.2558139534883721,18.0,9.0,0.0,0.32105263157894737
"bias only on small scales for the two lowest noise levels,             cluding unlensed and unmodulated maps in the training",0.0,0.7580645161290323,0.24193548387096775,19.0,7.0,0.0,0.34736842105263155
"and a reduced bias for the largest noise cases shown.                  set. In that case, the model tended to predict the pres-",0.0,0.7086614173228346,0.2913385826771654,21.0,10.0,0.0,0.3315789473684211
   For ` > 2000 in the 1 µK-arcmin and 2 µK-arcmin                     ence of a patchy reionization signal with power spectra,3.0,0.6666666666666666,0.33333333333333337,20.0,11.0,0.015789473684210527,0.33684210526315794
"cases, the near zero positive correlation between τ̂ and               not much smaller than those shown in Fig. 3, even when",0.0,0.736,0.264,20.0,8.0,0.0,0.3421052631578947
the true patchy τ signal indicate ResUNet-CMB is unable                no modulation was present in the maps. The inclusion,0.0,0.7398373983739838,0.26016260162601623,18.0,9.0,0.0,0.3526315789473684
to provide an accurate patchy reionization reconstruction              of some unlensed and unmodulated polarization maps in,0.0,0.782258064516129,0.217741935483871,15.0,8.0,0.0,0.34736842105263155
on small scales at these noise levels. This might also ex-             the data set during training prevents a spurious signal,0.0,0.753968253968254,0.24603174603174605,20.0,7.0,0.0,0.33684210526315794
plain similarity of the reconstructed patchy reionization              from being reconstructed when lensing and patchy reion-,0.0,0.7857142857142857,0.2142857142857143,15.0,8.0,0.0,0.33684210526315794
spectra on small scales for these noise levels seen in Fig. 3.         ization are absent.,0.0,0.7555555555555555,0.24444444444444446,15.0,5.0,0.0,0.5263157894736843
                                                                                                               V.     CONCLUSION,111.0,0.09375,0.90625,2.0,3.0,0.5842105263157895,0.3263157894736842
                         E.   Null Test,25.0,0.2564102564102564,0.7435897435897436,3.0,2.0,0.13157894736842105,0.7947368421052632
                                                                          In this paper we described the construction of a deep,74.0,0.3464566929133858,0.6535433070866141,10.0,1.0,0.3894736842105263,0.3315789473684211
   As a final check on the results of the ResUNet-CMB                  learning network designed to reconstruct effects which,3.0,0.712,0.28800000000000003,17.0,10.0,0.015789473684210527,0.3421052631578947
"network, we perform a null test to ensure that no patchy               alter the statistics of CMB fluctuations, the ResUNet-",0.0,0.744,0.256,19.0,8.0,0.0,0.3421052631578947
reionization signal is reconstructed when none is present              CMB. We showed that this network is capable of the,0.0,0.7520661157024794,0.2479338842975206,18.0,8.0,0.0,0.3631578947368421
"in the maps. We implement this test by making pre-                     simultaneous reconstruction of a lensing map, a patchy",0.0,0.704,0.29600000000000004,18.0,11.0,0.0,0.3421052631578947
"dictions of (κ, τ, E prim ) with the fully trained networks            reionization map, and a delensed and descreened po-",0.0,0.7540983606557377,0.24590163934426235,20.0,7.0,0.0,0.35789473684210527
when the unlensed and unmodulated polarization maps                    larization map. The reconstruction of patchy reioniza-,0.0,0.744,0.256,14.0,11.0,0.0,0.3421052631578947
"(Qprim , U prim ) (plus noise) are passed as the input. In             tion provided by ResUNet-CMB drastically reduced the",0.0,0.7479674796747967,0.2520325203252033,20.0,7.0,0.0,0.3526315789473684
                                          biased biased,42.0,0.21818181818181817,0.7818181818181819,2.0,1.0,0.22105263157894736,0.7105263157894737
"Fig. 9, we plot the power spectra hC`τ          τ",0.0,0.6530612244897959,0.34693877551020413,9.0,6.0,0.0,0.7421052631578947
                                                        i for each     lensing-induced bias present in the standard quadratic,56.0,0.448,0.552,10.0,3.0,0.29473684210526313,0.3421052631578947
"noise level that results from this null test. The spectra              estimator, and it nearly matched the variance of an op-",0.0,0.746031746031746,0.25396825396825395,20.0,8.0,0.0,0.33684210526315794
in Fig. 9 should be compared to the analogous spectra                  timal iteratively delensed and descreened reconstruction,0.0,0.7480314960629921,0.25196850393700787,16.0,10.0,0.0,0.3315789473684211
shown in Fig. 3 where the patchy reionization signal was               scheme over a wide range of angular scales.,0.0,0.7280701754385965,0.27192982456140347,18.0,8.0,0.0,0.4
present. We find that ResUNet-CMB reconstructs spec-                      While the results from ResUNet-CMB are quite,0.0,0.711864406779661,0.288135593220339,14.0,12.0,0.0,0.3789473684210526
         biased biased,9.0,0.5454545454545454,0.4545454545454546,2.0,1.0,0.04736842105263158,0.8842105263157894
tra hC`τ       τ,0.0,0.5,0.5,3.0,4.0,0.0,0.9157894736842105
"                       i that are much smaller for the null test       promising, we confirm the conclusion of other studies",23.0,0.6370967741935484,0.3629032258064516,17.0,4.0,0.12105263157894737,0.34736842105263155
"than when a signal is present, especially on large angular             that with CMB polarization data alone, we are likely to",0.0,0.753968253968254,0.24603174603174605,20.0,7.0,0.0,0.33684210526315794
scales where the reconstruction is most successful.          In the,0.0,0.746268656716418,0.25373134328358204,9.0,6.0,0.0,0.6473684210526316
                                                     biased biased,53.0,0.18181818181818182,0.8181818181818181,2.0,1.0,0.2789473684210526,0.6526315789473685
                                                                       be able to achieve only a statistical detection of the ef-,71.0,0.37209302325581395,0.627906976744186,11.0,1.0,0.3736842105263158,0.32105263157894737
"noiseless case, the reconstructed spectrum hC`τ             τ",0.0,0.7049180327868853,0.29508196721311475,7.0,7.0,0.0,0.6789473684210526
                                                                   i   fects of patchy reionization [73]. The success of ResUNet-,67.0,0.3953488372093023,0.6046511627906976,10.0,2.0,0.3526315789473684,0.32105263157894737
avr_spaces,18.014705882352946,1.0,0.0,1.0,1.0,0.09481424148606814,0.9473684210526316
                                                                                                                       14,119.0,0.01652892561983471,0.9834710743801653,1.0,1.0,0.6263157894736842,0.3631578947368421
"CMB on the simultaneous reconstruction of two sources        across all outputs, thereby improving all reconstructions.",0.0,0.8235294117647058,0.17647058823529416,15.0,5.0,0.0,0.37368421052631584
of secondary CMB fluctuations serves as a demonstration      The success of this change in our network prompts fur-,0.0,0.808695652173913,0.19130434782608696,18.0,4.0,0.0,0.39473684210526316
that machine learning tools can be usefully applied to the   ther questions about whether similar changes would be,0.0,0.8333333333333334,0.16666666666666663,18.0,2.0,0.0,0.4
data expected from the next generation of CMB surveys.       beneficial to other machine learning applications. When,0.0,0.8189655172413793,0.18103448275862066,16.0,4.0,0.0,0.3894736842105263
"   The ResUNet-CMB network shows promising results,          training the network, we included in the training set some",3.0,0.773109243697479,0.22689075630252098,16.0,6.0,0.015789473684210527,0.37368421052631584
though improvements can still be made. The results of        maps which had both lensing and patchy reionization set,0.0,0.7931034482758621,0.2068965517241379,18.0,5.0,0.0,0.3894736842105263
the network slightly under-performed idealized predic-       to zero. We found this to be necessary for the trained net-,0.0,0.8083333333333333,0.19166666666666665,18.0,4.0,0.0,0.368421052631579
"tions for (κ, τ, E) at very low noise levels, especially on  work to successfully pass the null test for patchy reioniza-",0.0,0.8181818181818182,0.18181818181818177,22.0,2.0,0.0,0.3631578947368421
small scales. In Ref. [77] it is suggested that the recon-   tion reconstruction. Without the null maps in the train-,0.0,0.8205128205128205,0.17948717948717952,20.0,2.0,0.0,0.38421052631578945
"struction of high-` modes is limited by the signal-to-noise  ing set, we found that the network returned non-zero es-",0.0,0.8376068376068376,0.16239316239316237,19.0,2.0,0.0,0.38421052631578945
"ratio at those small scales. For the case of patchy reion-   timates for the patchy reionization signal, even when no",0.0,0.8205128205128205,0.17948717948717952,20.0,2.0,0.0,0.38421052631578945
ization this issue is of particular importance since its ef- patchy reionization was present in the maps of the test,0.0,0.8362068965517241,0.1637931034482759,20.0,1.0,0.0,0.3894736842105263
fects are much smaller than lensing. This problem can        set. This procedure of including a subset of maps with,0.0,0.782608695652174,0.21739130434782605,19.0,5.0,0.0,0.39473684210526316
potentially be partially mitigated by using higher resolu-   varying conditions into the training set can be explored,0.0,0.8461538461538461,0.15384615384615385,17.0,2.0,0.0,0.38421052631578945
"tion maps to include smaller physical scales, which should   for further possible improvements to the network. The",0.0,0.8421052631578947,0.1578947368421053,17.0,2.0,0.0,0.4
improve the reconstruction on all scales. Accommodat-        potential benefits of this modified subset training method,0.0,0.8235294117647058,0.17647058823529416,15.0,5.0,0.0,0.37368421052631584
ing maps of a different resolution requires extensive re-    should not be understated. Not only were the impacts,0.0,0.8230088495575221,0.17699115044247793,18.0,3.0,0.0,0.4052631578947369
"structuring of the network to ensure that features on all    to the quality of the reconstructions minimal, the change",0.0,0.8220338983050848,0.17796610169491522,19.0,3.0,0.0,0.3789473684210526
scales are being properly analyzed by the network while      to the training also fixed a problem in the predictions of,0.0,0.7983193277310925,0.2016806722689075,20.0,4.0,0.0,0.37368421052631584
ensuring VRAM constraints are not exceeded. Another          the trained network without requiring any modification,0.0,0.808695652173913,0.19130434782608696,14.0,6.0,0.0,0.39473684210526316
avenue to consider would be to first train the network on    to the architecture.,0.0,0.8024691358024691,0.19753086419753085,14.0,3.0,0.0,0.5736842105263158
"patchy reionization maps with a magnified signal, then          We did not explore the generalization of our predic-",0.0,0.7844827586206896,0.2155172413793104,17.0,6.0,0.0,0.3894736842105263
slowly decrease the signal magnitude until the fiducial      tions to maps generated with different cosmological pa-,0.0,0.8275862068965517,0.1724137931034483,16.0,4.0,0.0,0.3894736842105263
"amplitude is reached. This method, used in Ref. [99]         rameters. Further tests are required to determine how",0.0,0.7894736842105263,0.21052631578947367,17.0,5.0,0.0,0.4
"for a different purpose, could help with the reconstruc-     well the network is able to reconstruct patchy reioniza-",0.0,0.8205128205128205,0.17948717948717952,18.0,3.0,0.0,0.38421052631578945
"tion on scales dominated by noise. On the other hand,        tion and lensing in CMB maps generated assuming dif-",0.0,0.7787610619469026,0.22123893805309736,19.0,5.0,0.0,0.4052631578947369
the noise levels where significant gains seem possible are   ferent cosmologies. The success of the modified subset,0.0,0.8434782608695652,0.15652173913043477,17.0,2.0,0.0,0.39473684210526316
much lower than those of currently planned CMB sur-          training provides a positive indication that a similar tech-,0.0,0.7851239669421488,0.2148760330578512,18.0,6.0,0.0,0.3631578947368421
"veys, meaning that optimization in that very low noise       nique could be applied to improve the generalization ca-",0.0,0.8034188034188035,0.19658119658119655,18.0,4.0,0.0,0.38421052631578945
regime may not lead to much practical improvement with       pability of the network without much negative impact to,0.0,0.8017241379310345,0.19827586206896552,18.0,4.0,0.0,0.3894736842105263
forthcoming data.                                            the results.,0.0,0.3698630136986301,0.6301369863013699,4.0,23.0,0.0,0.6157894736842106
   One extension to our work that could improve patchy,3.0,0.7962962962962963,0.20370370370370372,9.0,1.0,0.015789473684210527,0.7157894736842105
                                                                In order to be useful for constraining cosmological pa-,64.0,0.3949579831932773,0.6050420168067228,9.0,1.0,0.3368421052631579,0.37368421052631584
reionization reconstruction is to consider a broader set of,0.0,0.864406779661017,0.13559322033898302,9.0,1.0,0.0,0.6894736842105262
"                                                             rameters, the predictions made by any estimator need to",61.0,0.4051724137931034,0.5948275862068966,9.0,1.0,0.32105263157894737,0.3894736842105263
input maps. One simple addition is to include CMB tem-,0.0,0.8333333333333334,0.16666666666666663,10.0,1.0,0.0,0.7157894736842105
                                                             be incorporated into a framework that is capable of rig-,61.0,0.4017094017094017,0.5982905982905983,10.0,1.0,0.32105263157894737,0.38421052631578945
perature maps in addition to polarization. More realistic,0.0,0.8771929824561403,0.1228070175438597,8.0,1.0,0.0,0.7
"                                                             orously quantifying uncertainties. Once trained, making",61.0,0.43103448275862066,0.5689655172413793,6.0,1.0,0.32105263157894737,0.3894736842105263
simulations would also include correlations between the,0.0,0.8909090909090909,0.10909090909090913,7.0,1.0,0.0,0.7105263157894737
                                                             predictions with ResUNet-CMB is very computationally,61.0,0.415929203539823,0.584070796460177,6.0,1.0,0.32105263157894737,0.4052631578947369
"patchy reionization field and the matter density, leading",0.0,0.8771929824561403,0.1228070175438597,8.0,1.0,0.0,0.7
"                                                             efficient, and so the network provides good candidate to",61.0,0.41025641025641024,0.5897435897435898,9.0,1.0,0.32105263157894737,0.38421052631578945
"to correlations with the lensing field, galaxy counts, or",0.0,0.8596491228070176,0.14035087719298245,9.0,1.0,0.0,0.7
                                                             be included in a Monte Carlo exploration of posteriors.,61.0,0.4051724137931034,0.5948275862068966,9.0,1.0,0.32105263157894737,0.3894736842105263
other tracers of structure. If such correlations were in-,0.0,0.8596491228070176,0.14035087719298245,9.0,1.0,0.0,0.7
                                                             Another possibility would be to incorporate ResUNet-,61.0,0.40707964601769914,0.5929203539823009,7.0,1.0,0.32105263157894737,0.4052631578947369
"cluded, one could also consider adding maps of the cos-",0.0,0.8363636363636363,0.1636363636363637,10.0,1.0,0.0,0.7105263157894737
                                                             CMB into a Bayesian framework like that described in,61.0,0.3893805309734513,0.6106194690265487,9.0,1.0,0.32105263157894737,0.4052631578947369
"mic infrared background, surveys of galaxies, or 21-cm",0.0,0.8703703703703703,0.12962962962962965,8.0,1.0,0.0,0.7157894736842105
                                                             Ref. [47].,61.0,0.1267605633802817,0.8732394366197183,2.0,1.0,0.32105263157894737,0.6263157894736842
"intensity maps, the addition of which has been shown",0.0,0.8461538461538461,0.15384615384615385,9.0,1.0,0.0,0.7263157894736842
to improve patchy reionization reconstruction by other          Our results act as a proof of concept that machine,0.0,0.7807017543859649,0.2192982456140351,17.0,6.0,0.0,0.4
means [100–102].                                             learning is capable of the simultaneous reconstruction of,0.0,0.5508474576271186,0.4491525423728814,10.0,23.0,0.0,0.3789473684210526
   Another extension of our work would be treat more re-     two fields that lead to the distortion of the statistics of,3.0,0.775,0.22499999999999998,21.0,3.0,0.015789473684210527,0.368421052631579
"alistic simulations, for example by adding astrophysical     CMB fluctuations. It is natural to ask whether machine",0.0,0.8347826086956521,0.16521739130434787,16.0,3.0,0.0,0.39473684210526316
foregrounds or anisotropic noise. Applications of ma-        learning can also be usefully applied to the reconstruction,0.0,0.8166666666666667,0.18333333333333335,16.0,5.0,0.0,0.368421052631579
"chine learning to simulated foregrounds on the full sky      of other sources of secondary CMB fluctuations, perhaps",0.0,0.8189655172413793,0.18103448275862066,17.0,4.0,0.0,0.3894736842105263
are already showing promising results [78]. Addressing       by including additional maps as input. The ResUNet-,0.0,0.8214285714285714,0.1785714285714286,15.0,4.0,0.0,0.41052631578947374
the complications presented by more realistic simulations    CMB network described here is a useful model for such,0.0,0.8333333333333334,0.16666666666666663,17.0,3.0,0.0,0.4
"is a necessary step if machine learning is to be usefully    exploration, since new architecture aimed at similar tasks",0.0,0.8235294117647058,0.17647058823529416,19.0,3.0,0.0,0.37368421052631584
applied to the data collected by upcoming CMB surveys.       can easily be constructed by simply modifying the inputs,0.0,0.8034188034188035,0.19658119658119655,18.0,4.0,0.0,0.38421052631578945
   We found a few modifications of standard machine          and outputs of the publicly available network.,3.0,0.7570093457943925,0.2429906542056075,15.0,6.0,0.015789473684210527,0.4368421052631579
learning techniques to be beneficial for our purposes. We       The work presented here adds to the list of examples,0.0,0.7931034482758621,0.2068965517241379,19.0,4.0,0.0,0.3894736842105263
included a batch normalization layer in all of our residual  that show machine learning is likely to play a positive,0.0,0.8275862068965517,0.1724137931034483,20.0,2.0,0.0,0.3894736842105263
"connections, contrary to the standard implementation of      role in the future of cosmology, especially when applied",0.0,0.8290598290598291,0.1709401709401709,16.0,4.0,0.0,0.38421052631578945
"residual connections [86, 88]. We found that the inclusion   to the wealth of new data expected from forthcoming",0.0,0.8303571428571429,0.1696428571428571,18.0,2.0,0.0,0.41052631578947374
of the batch normalization layer lowered validation loss     cosmological surveys.,0.0,0.8414634146341463,0.1585365853658537,10.0,3.0,0.0,0.5684210526315789
avr_spaces,10.628571428571428,1.0,0.0,1.0,1.0,0.05593984962406015,0.9473684210526316
                                                                                                                           15,123.0,0.016,0.984,1.0,1.0,0.6473684210526316,0.3421052631578947
                 ACKNOWLEDGMENTS                               is supported by the US Department of Energy under,17.0,0.5,0.5,10.0,16.0,0.08947368421052632,0.41052631578947374
                                                               grant no. DE-SC0010129. Computations were carried out,63.0,0.4051724137931034,0.5948275862068966,7.0,1.0,0.33157894736842103,0.3894736842105263
"   The authors would like to thank Alex van Engelen            on ManeFrame II, a shared high-performance computing",3.0,0.7478260869565218,0.25217391304347825,16.0,7.0,0.015789473684210527,0.39473684210526316
and Marius Millea for helpful conversations. This work         cluster at Southern Methodist University.,0.0,0.8076923076923077,0.1923076923076923,13.0,5.0,0.0,0.4526315789473684
"  [1] Simons Observatory Collaboration, P. Ade et al.,               CMB S4 Era,” Phys. Rev. D 96 no. 12, (2017) 123509,",2.0,0.7166666666666667,0.2833333333333333,19.0,8.0,0.010526315789473684,0.368421052631579
      “The Simons Observatory: Science goals and                     arXiv:1707.04102 [astro-ph.CO].,6.0,0.67,0.32999999999999996,8.0,11.0,0.031578947368421054,0.4736842105263158
"      forecasts,” JCAP 02 (2019) 056, arXiv:1808.07445          [18] A.-S. Deutsch, M. C. Johnson, M. Münchmeyer, and",6.0,0.7542372881355932,0.2457627118644068,15.0,6.0,0.031578947368421054,0.3789473684210526
"      [astro-ph.CO].                                                 A. Terrana, “Polarized Sunyaev Zel’dovich",6.0,0.4636363636363636,0.5363636363636364,6.0,25.0,0.031578947368421054,0.42105263157894735
"  [2] M. Aravena et al., “The CCAT-Prime Submillimeter               tomography,” JCAP 04 (2018) 034,",2.0,0.7227722772277227,0.27722772277227725,13.0,8.0,0.010526315789473684,0.46842105263157896
"      Observatory,” arXiv:1909.02587 [astro-ph.IM].                  arXiv:1705.08907 [astro-ph.CO].",6.0,0.73,0.27,5.0,10.0,0.031578947368421054,0.4736842105263158
"  [3] CMB-S4 Collaboration, K. N. Abazajian et al.,             [19] A.-S. Deutsch, E. Dimastrogiovanni, M. C. Johnson,",2.0,0.7563025210084033,0.24369747899159666,16.0,7.0,0.010526315789473684,0.37368421052631584
"      “CMB-S4 Science Book, First Edition,”                          M. Münchmeyer, and A. Terrana, “Reconstruction of",6.0,0.6470588235294118,0.3529411764705882,12.0,14.0,0.031578947368421054,0.37368421052631584
      arXiv:1610.02743 [astro-ph.CO].                                the remote dipole and quadrupole fields from the,6.0,0.6068376068376068,0.3931623931623932,10.0,17.0,0.031578947368421054,0.38421052631578945
"  [4] NASA PICO Collaboration, S. Hanany et al.,                     kinetic Sunyaev Zel’dovich and polarized Sunyaev",2.0,0.7008547008547008,0.2991452991452992,14.0,11.0,0.010526315789473684,0.38421052631578945
"      “PICO: Probe of Inflation and Cosmic Origins,”                 Zel’dovich effects,” Phys. Rev. D 98 no. 12, (2018)",6.0,0.6916666666666667,0.30833333333333335,16.0,9.0,0.031578947368421054,0.368421052631579
"      arXiv:1902.10541 [astro-ph.IM].                                123501, arXiv:1707.08129 [astro-ph.CO].",6.0,0.6203703703703703,0.37962962962962965,5.0,17.0,0.031578947368421054,0.43157894736842106
"  [5] N. Sehgal et al., “CMB-HD: An Ultra-Deep,                 [20] J. Meyers, P. D. Meerburg, A. van Engelen, and",2.0,0.6956521739130435,0.30434782608695654,18.0,9.0,0.010526315789473684,0.39473684210526316
"      High-Resolution Millimeter-Wave Survey Over Half               N. Battaglia, “Beyond CMB cosmic variance limits on",6.0,0.7333333333333333,0.2666666666666667,13.0,8.0,0.031578947368421054,0.368421052631579
"      the Sky,” arXiv:1906.10134 [astro-ph.CO].                      reionization with the polarized Sunyaev-Zel’dovich",6.0,0.7058823529411765,0.2941176470588235,9.0,12.0,0.031578947368421054,0.37368421052631584
"  [6] N. Aghanim, S. Majumdar, and J. Silk, “Secondary               effect,” Phys. Rev. D 97 no. 10, (2018) 103505,",2.0,0.7155172413793104,0.2844827586206896,18.0,8.0,0.010526315789473684,0.3894736842105263
"      anisotropies of the CMB,” Rept. Prog. Phys. 71 (2008)          arXiv:1710.01708 [astro-ph.CO].",6.0,0.75,0.25,11.0,6.0,0.031578947368421054,0.4736842105263158
"      066902, arXiv:0711.0518 [astro-ph].                       [21] K. M. Smith, M. S. Madhavacheril, M. Münchmeyer,",6.0,0.6694915254237288,0.3305084745762712,12.0,12.0,0.031578947368421054,0.3789473684210526
"  [7] A. Lewis and A. Challinor, “Weak gravitational                 S. Ferraro, U. Giri, and M. C. Johnson, “KSZ",2.0,0.6991150442477876,0.3008849557522124,17.0,9.0,0.010526315789473684,0.4052631578947369
"      lensing of the CMB,” Phys. Rept. 429 (2006) 1–65,              tomography and the bispectrum,” arXiv:1810.13423",6.0,0.7264957264957265,0.27350427350427353,14.0,8.0,0.031578947368421054,0.38421052631578945
      arXiv:astro-ph/0601594.                                        [astro-ph.CO].,6.0,0.4457831325301205,0.5542168674698795,2.0,21.0,0.031578947368421054,0.5631578947368421
"  [8] Ya. B. Zeldovich and R. A. Sunyaev, “The Interaction      [22] S. C. Hotinli, J. Meyers, N. Dalal, A. H. Jaffe, M. C.",2.0,0.7642276422764228,0.2357723577235772,23.0,4.0,0.010526315789473684,0.3526315789473684
"      of Matter and Radiation in a Hot-Model Universe,”              Johnson, J. B. Mertens, M. Münchmeyer, K. M. Smith,",6.0,0.7107438016528925,0.2892561983471075,17.0,8.0,0.031578947368421054,0.3631578947368421
"      Astrophys. Space Sci. 4 (1969) 301–316.                        and A. van Engelen, “Transverse Velocities with the",6.0,0.65,0.35,14.0,13.0,0.031578947368421054,0.368421052631579
"  [9] R. A. Sunyaev and Ya. B. Zeldovich, “The Interaction           Moving Lens Effect,” Phys. Rev. Lett. 123 no. 6,",2.0,0.7435897435897436,0.2564102564102564,19.0,6.0,0.010526315789473684,0.38421052631578945
"      of matter and radiation in the hot model of the                (2019) 061301, arXiv:1812.03167 [astro-ph.CO].",6.0,0.7043478260869566,0.29565217391304344,14.0,9.0,0.031578947368421054,0.39473684210526316
"      universe,” Astrophys. Space Sci. 7 (1970) 20–30.          [23] S. Yasini, N. Mirzatuny, and E. Pierpaoli, “Pairwise",6.0,0.7520661157024794,0.2479338842975206,16.0,6.0,0.031578947368421054,0.3631578947368421
" [10] R. A. Sunyaev and Ya. B. Zeldovich, “The                       Transverse Velocity Measurement with the",1.0,0.6697247706422018,0.3302752293577982,14.0,12.0,0.005263157894736842,0.4263157894736842
"      Observations of relic radiation as a test of the nature        Rees–Sciama Effect,” Astrophys. J. Lett. 873 no. 2,",6.0,0.75,0.25,18.0,5.0,0.031578947368421054,0.368421052631579
"      of X-Ray radiation from the clusters of galaxies,”             (2019) L23, arXiv:1812.04241 [astro-ph.CO].",6.0,0.7410714285714286,0.2589285714285714,12.0,7.0,0.031578947368421054,0.41052631578947374
"      Comments Astrophys. Space Phys. 4 (1972) 173–178.         [24] S. C. Hotinli, M. C. Johnson, and J. Meyers, “Optimal",6.0,0.7459016393442623,0.25409836065573765,18.0,5.0,0.031578947368421054,0.35789473684210527
" [11] R. A. Sunyaev and Ya. B. Zeldovich, “Microwave                 filters for the moving lens effect,” arXiv:2006.03060",1.0,0.7377049180327869,0.2622950819672131,16.0,9.0,0.005263157894736842,0.35789473684210527
      background radiation as a probe of the contemporary            [astro-ph.CO].,6.0,0.6987951807228916,0.3012048192771084,9.0,7.0,0.031578947368421054,0.5631578947368421
"      structure and history of the universe,” Ann. Rev.         [25] W. Hu and T. Okamoto, “Mass reconstruction with",6.0,0.7413793103448276,0.2586206896551724,17.0,5.0,0.031578947368421054,0.3894736842105263
"      Astron. Astrophys. 18 (1980) 537–560.                          cmb polarization,” Astrophys. J. 574 (2002) 566–574,",6.0,0.6528925619834711,0.3471074380165289,12.0,14.0,0.031578947368421054,0.3631578947368421
" [12] S. Y. Sazonov and R. A. Sunyaev, “Microwave                    arXiv:astro-ph/0111606.",1.0,0.6847826086956522,0.3152173913043478,10.0,11.0,0.005263157894736842,0.5157894736842106
"      polarization in the direction of galaxy clusters induced  [26] T. Okamoto and W. Hu, “CMB lensing reconstruction",6.0,0.8050847457627118,0.19491525423728817,17.0,2.0,0.031578947368421054,0.3789473684210526
"      by the CMB quadrupole anisotropy,” Mon. Not. Roy.              on the full sky,” Phys. Rev. D67 (2003) 083002,",6.0,0.6982758620689655,0.3017241379310345,17.0,8.0,0.031578947368421054,0.3894736842105263
"      Astron. Soc. 310 (1999) 765–772,                               arXiv:astro-ph/0301031 [astro-ph].",6.0,0.5922330097087378,0.4077669902912622,7.0,16.0,0.031578947368421054,0.45789473684210524
"      arXiv:astro-ph/9903287 [astro-ph].                        [27] Planck Collaboration, N. Aghanim et al., “Planck",6.0,0.6752136752136753,0.32478632478632474,10.0,13.0,0.031578947368421054,0.38421052631578945
" [13] R. K. Sachs and A. M. Wolfe, “Perturbations of a               2018 results. VIII. Gravitational lensing,” Astron.",1.0,0.7416666666666667,0.2583333333333333,17.0,8.0,0.005263157894736842,0.368421052631579
"      Cosmological Model and Angular Variations of the               Astrophys. 641 (2020) A8, arXiv:1807.06210",6.0,0.7207207207207207,0.2792792792792793,12.0,8.0,0.031578947368421054,0.4157894736842105
"      Microwave Background,” ApJ 147 (Jan., 1967) 73.                [astro-ph.CO].",6.0,0.6626506024096386,0.3373493975903614,8.0,9.0,0.031578947368421054,0.5631578947368421
" [14] M. J. Rees and D. W. Sciama, “Large-scale Density         [28] W. Wu et al., “A Measurement of the Cosmic",1.0,0.7477477477477478,0.25225225225225223,20.0,5.0,0.005263157894736842,0.4157894736842105
"      Inhomogeneities in the Universe,” Nature 217 (Feb.,            Microwave Background Lensing Potential and Power",6.0,0.7521367521367521,0.24786324786324787,13.0,7.0,0.031578947368421054,0.38421052631578945
      1968) 511–516.                                                 Spectrum from 500 deg2 of SPTpol Temperature and,6.0,0.46153846153846156,0.5384615384615384,10.0,25.0,0.031578947368421054,0.38421052631578945
" [15] M. Birkinshaw and S. F. Gull, “A test for transverse           Polarization Data,” Astrophys. J. 884 (2019) 70,",1.0,0.7606837606837606,0.23931623931623935,18.0,6.0,0.005263157894736842,0.38421052631578945
"      motions of clusters of galaxies,” Nature 302 (Mar.,            arXiv:1905.05777 [astro-ph.CO].",6.0,0.74,0.26,10.0,7.0,0.031578947368421054,0.4736842105263158
"      1983) 315–317.                                            [29] O. Darwish et al., “The Atacama Cosmology",6.0,0.4727272727272727,0.5272727272727273,10.0,23.0,0.031578947368421054,0.42105263157894735
" [16] K. M. Smith and S. Ferraro, “Detecting Patchy                  Telescope: A CMB lensing mass map over 2100 square",1.0,0.7058823529411765,0.2941176470588235,18.0,10.0,0.005263157894736842,0.37368421052631584
"      Reionization in the Cosmic Microwave Background,”              degrees of sky and its cross-correlation with",6.0,0.7280701754385965,0.27192982456140347,13.0,8.0,0.031578947368421054,0.4
"      Phys. Rev. Lett. 119 no. 2, (2017) 021301,                     BOSS-CMASS galaxies,” arXiv:2004.01139",6.0,0.6635514018691588,0.33644859813084116,11.0,11.0,0.031578947368421054,0.4368421052631579
      arXiv:1607.01769 [astro-ph.CO].                                [astro-ph.CO].,6.0,0.5301204819277109,0.4698795180722891,3.0,17.0,0.031578947368421054,0.5631578947368421
" [17] T. Louis, E. F. Bunn, B. Wandelt, and J. Silk,            [30] C. M. Hirata and U. Seljak, “Analyzing weak lensing",1.0,0.7333333333333333,0.2666666666666667,21.0,7.0,0.005263157894736842,0.368421052631579
      “Measuring Polarized Emission in Clusters in the               of the cosmic microwave background using the,6.0,0.7079646017699115,0.2920353982300885,14.0,8.0,0.031578947368421054,0.4052631578947369
avr_spaces,7.540983606557377,1.0,0.0,1.0,1.0,0.03968938740293357,0.9473684210526316
                                                                                                                         16,121.0,0.016260162601626018,0.983739837398374,1.0,1.0,0.6368421052631579,0.3526315789473684
"     likelihood function,” Phys. Rev. D67 (2003) 043001,     [47] M. Millea, E. Anderes, and B. D. Wandelt, “Bayesian",5.0,0.7863247863247863,0.2136752136752137,17.0,3.0,0.02631578947368421,0.38421052631578945
     arXiv:astro-ph/0209489 [astro-ph].                           delensing delight: sampling-based inference of the,5.0,0.6724137931034483,0.3275862068965517,8.0,14.0,0.02631578947368421,0.3894736842105263
"[31] C. M. Hirata and U. Seljak, “Reconstruction of lensing       primordial CMB and gravitational lensing,”",0.0,0.8148148148148148,0.18518518518518523,15.0,4.0,0.0,0.43157894736842106
"     from the cosmic microwave background polarization,”          arXiv:2002.00965 [astro-ph.CO].",5.0,0.7835051546391752,0.21649484536082475,8.0,6.0,0.02631578947368421,0.4894736842105263
"     Phys. Rev. D 68 (2003) 083002,                          [48] P. Diego-Palazuelos, P. Vielva, E. Martı́nez-González,",5.0,0.6528925619834711,0.3471074380165289,13.0,14.0,0.02631578947368421,0.3631578947368421
"     arXiv:astro-ph/0306354.                                      and R. Barreiro, “Comparison of delensing",5.0,0.5514018691588785,0.44859813084112155,7.0,20.0,0.02631578947368421,0.4368421052631579
"[32] K. M. Smith, D. Hanson, M. LoVerde, C. M. Hirata,            methodologies and assessment of the delensing",0.0,0.7567567567567568,0.2432432432432432,17.0,7.0,0.0,0.4157894736842105
"     and O. Zahn, “Delensing CMB Polarization with                capabilities of future experiments,” arXiv:2006.12935",5.0,0.7394957983193278,0.26050420168067223,12.0,9.0,0.02631578947368421,0.37368421052631584
"     External Datasets,” JCAP 06 (2012) 014,                      [astro-ph.CO].",5.0,0.6,0.4,7.0,12.0,0.02631578947368421,0.5789473684210527
"     arXiv:1010.0048 [astro-ph.CO].                          [49] B. D. Sherwin and M. Schmittfull, “Delensing the",5.0,0.6491228070175439,0.3508771929824561,11.0,14.0,0.02631578947368421,0.4
"[33] T. Namikawa, D. Hanson, and R. Takahashi,                    CMB with the Cosmic Infrared Background,” Phys.",0.0,0.7079646017699115,0.2920353982300885,15.0,11.0,0.0,0.4052631578947369
"     “Bias-Hardened CMB Lensing,” Mon. Not. Roy.                  Rev. D 92 no. 4, (2015) 043005, arXiv:1502.05356",5.0,0.6929824561403509,0.3070175438596491,14.0,10.0,0.02631578947368421,0.4
"     Astron. Soc. 431 (2013) 609–620, arXiv:1209.0091             [astro-ph.CO].",5.0,0.7125,0.2875,7.0,7.0,0.02631578947368421,0.5789473684210527
"     [astro-ph.CO].                                          [50] N. Sehgal, M. S. Madhavacheril, B. Sherwin, and",5.0,0.5132743362831859,0.48672566371681414,10.0,22.0,0.02631578947368421,0.4052631578947369
"[34] M. Kamionkowski, A. Kosowsky, and A. Stebbins,               A. van Engelen, “Internal Delensing of Cosmic",0.0,0.7477477477477478,0.25225225225225223,15.0,8.0,0.0,0.4157894736842105
"     “Statistics of cosmic microwave background                   Microwave Background Acoustic Peaks,” Phys. Rev. D",5.0,0.7068965517241379,0.2931034482758621,12.0,10.0,0.02631578947368421,0.3894736842105263
"     polarization,” Phys. Rev. D 55 (1997) 7368–7388,             95 no. 10, (2017) 103512, arXiv:1612.03898",5.0,0.7314814814814815,0.2685185185185185,13.0,7.0,0.02631578947368421,0.43157894736842106
     arXiv:astro-ph/9611125.                                      [astro-ph.CO].,5.0,0.4625,0.5375,2.0,20.0,0.02631578947368421,0.5789473684210527
"[35] U. Seljak and M. Zaldarriaga, “Signature of gravity     [51] R. Barkana and A. Loeb, “In the beginning: The First",0.0,0.8050847457627118,0.19491525423728817,20.0,3.0,0.0,0.3789473684210526
"     waves in polarization of the microwave background,”          sources of light and the reionization of the Universe,”",5.0,0.7603305785123967,0.23966942148760328,16.0,6.0,0.02631578947368421,0.3631578947368421
"     Phys. Rev. Lett. 78 (1997) 2054–2057,                        Phys. Rept. 349 (2001) 125–238,",5.0,0.6082474226804123,0.3917525773195877,11.0,13.0,0.02631578947368421,0.4894736842105263
     arXiv:astro-ph/9609169.                                      arXiv:astro-ph/0010468.,5.0,0.5168539325842697,0.4831460674157303,2.0,20.0,0.02631578947368421,0.531578947368421
"[36] M. Zaldarriaga and U. Seljak, “Gravitational lensing    [52] J. B. Wyithe and A. Loeb, “Reionization of hydrogen",0.0,0.8290598290598291,0.1709401709401709,18.0,3.0,0.0,0.38421052631578945
"     effect on cosmic microwave background polarization,”         and helium by early stars and quasars,” Astrophys. J.",5.0,0.773109243697479,0.22689075630252098,15.0,5.0,0.02631578947368421,0.37368421052631584
"     Phys. Rev. D 58 (1998) 023003,                               586 (2003) 693–708, arXiv:astro-ph/0209056.",5.0,0.5963302752293578,0.4036697247706422,10.0,16.0,0.02631578947368421,0.4263157894736842
"     arXiv:astro-ph/9803150.                                 [53] R. Barkana and A. Loeb, “Unusually large fluctuations",5.0,0.6134453781512605,0.38655462184873945,10.0,17.0,0.02631578947368421,0.37368421052631584
"[37] A. Lewis, A. Challinor, and N. Turok, “Analysis of           in the statistics of galaxy formation at high redshift,”",0.0,0.7704918032786885,0.2295081967213115,19.0,6.0,0.0,0.35789473684210527
"     CMB polarization on an incomplete sky,” Phys. Rev.           Astrophys. J. 609 (2004) 474–481,",5.0,0.7272727272727273,0.2727272727272727,13.0,6.0,0.02631578947368421,0.4789473684210527
"     D 65 (2002) 023505, arXiv:astro-ph/0106536.                  arXiv:astro-ph/0310338.",5.0,0.6966292134831461,0.3033707865168539,6.0,10.0,0.02631578947368421,0.531578947368421
"[38] L. Knox and Y.-S. Song, “A Limit on the detectability   [54] S. Furlanetto, M. Zaldarriaga, and L. Hernquist, “The",0.0,0.8235294117647058,0.17647058823529416,20.0,2.0,0.0,0.37368421052631584
"     of the energy scale of inflation,” Phys. Rev. Lett. 89       Growth of HII regions during reionization,” Astrophys.",5.0,0.775,0.22499999999999998,17.0,4.0,0.02631578947368421,0.368421052631579
"     (2002) 011303, arXiv:astro-ph/0202286.                       J. 613 (2004) 1–15, arXiv:astro-ph/0403697.",5.0,0.6880733944954128,0.3119266055045872,8.0,12.0,0.02631578947368421,0.4263157894736842
"[39] M. Kesden, A. Cooray, and M. Kamionkowski,              [55] M. McQuinn, A. Lidz, O. Zahn, S. Dutta,",0.0,0.7238095238095238,0.2761904761904762,17.0,8.0,0.0,0.4473684210526315
"     “Separation of gravitational wave and cosmic shear           L. Hernquist, and M. Zaldarriaga, “The Morphology of",5.0,0.7542372881355932,0.2457627118644068,15.0,6.0,0.02631578947368421,0.3789473684210526
"     contributions to cosmic microwave background                 HII Regions during Reionization,” Mon. Not. Roy.",5.0,0.7192982456140351,0.2807017543859649,12.0,9.0,0.02631578947368421,0.4
"     polarization,” Phys. Rev. Lett. 89 (2002) 011304,            Astron. Soc. 377 (2007) 1043–1063,",5.0,0.73,0.27,12.0,7.0,0.02631578947368421,0.4736842105263158
     arXiv:astro-ph/0202434.                                      arXiv:astro-ph/0610094.,5.0,0.5168539325842697,0.4831460674157303,2.0,20.0,0.02631578947368421,0.531578947368421
"[40] U. Seljak and C. M. Hirata, “Gravitational lensing as a [56] A. Mesinger and S. Furlanetto, “Efficient Simulations",0.0,0.8487394957983193,0.1512605042016807,19.0,1.0,0.0,0.37368421052631584
"     contaminant of the gravity wave signal in CMB,” Phys.        of Early Structure Formation and Reionization,”",5.0,0.7699115044247787,0.23008849557522126,15.0,5.0,0.02631578947368421,0.4052631578947369
"     Rev. D 69 (2004) 043005, arXiv:astro-ph/0310163.             Astrophys. J. 669 (2007) 663, arXiv:0704.0946",5.0,0.7477477477477478,0.25225225225225223,12.0,7.0,0.02631578947368421,0.4157894736842105
"[41] D. Green, J. Meyers, and A. van Engelen, “CMB                [astro-ph].",0.0,0.6753246753246753,0.3246753246753247,11.0,9.0,0.0,0.5947368421052632
"     Delensing Beyond the B Modes,” JCAP 1712 no. 12,        [57] N. Battaglia, H. Trac, R. Cen, and A. Loeb,",5.0,0.7247706422018348,0.27522935779816515,19.0,5.0,0.02631578947368421,0.4263157894736842
"     (2017) 005, arXiv:1609.08143 [astro-ph.CO].                  “Reionization on Large Scales I: A Parametric Model",5.0,0.717948717948718,0.28205128205128205,12.0,10.0,0.02631578947368421,0.38421052631578945
"[42] D. Baumann, D. Green, J. Meyers, and B. Wallisch,            Constructed from Radiation-Hydrodynamic",0.0,0.780952380952381,0.21904761904761905,13.0,7.0,0.0,0.4473684210526315
"     “Phases of New Physics in the CMB,” JCAP 01                  Simulations,” Astrophys. J. 776 (2013) 81,",5.0,0.6666666666666666,0.33333333333333337,15.0,10.0,0.02631578947368421,0.43157894736842106
"     (2016) 007, arXiv:1508.06342 [astro-ph.CO].                  arXiv:1211.2821 [astro-ph.CO].",5.0,0.71875,0.28125,6.0,10.0,0.02631578947368421,0.49473684210526314
"[43] W. R. Coulton, P. D. Meerburg, D. G. Baker,             [58] S. Mitra, T. R. Choudhury, and A. Ferrara, “Cosmic",0.0,0.7327586206896551,0.26724137931034486,20.0,7.0,0.0,0.3894736842105263
"     S. Hotinli, A. J. Duivenvoorden, and A. van Engelen,         reionization after Planck II: contribution from",5.0,0.7610619469026548,0.23893805309734517,15.0,5.0,0.02631578947368421,0.4052631578947369
"     “Minimizing gravitational lensing contributions to the       quasars,” Mon. Not. Roy. Astron. Soc. 473 no. 1,",5.0,0.7807017543859649,0.2192982456140351,15.0,4.0,0.02631578947368421,0.4
"     primordial bispectrum covariance,” Phys. Rev. D 101          (2018) 1416–1425, arXiv:1606.02719 [astro-ph.CO].",5.0,0.7913043478260869,0.20869565217391306,11.0,6.0,0.02631578947368421,0.39473684210526316
"     no. 12, (2020) 123504, arXiv:1912.07619                 [59] P. Dayal and A. Ferrara, “Early galaxy formation and",5.0,0.7033898305084746,0.2966101694915254,15.0,9.0,0.02631578947368421,0.3789473684210526
"     [astro-ph.CO].                                               its large-scale effects,” Phys. Rept. 780-782 (2018)",5.0,0.5084745762711864,0.4915254237288136,8.0,24.0,0.02631578947368421,0.3789473684210526
"[44] K. Abazajian et al., “CMB-S4 Science Case, Reference         1–64, arXiv:1809.09136 [astro-ph.GA].",0.0,0.8155339805825242,0.18446601941747576,12.0,5.0,0.0,0.45789473684210524
"     Design, and Project Plan,” arXiv:1907.04473             [60] W. Hu, “Reionization revisited: secondary cmb",5.0,0.7477477477477478,0.25225225225225223,12.0,7.0,0.02631578947368421,0.4157894736842105
"     [astro-ph.IM].                                               anisotropies and polarization,” Astrophys. J. 529",5.0,0.5043478260869565,0.4956521739130435,7.0,24.0,0.02631578947368421,0.39473684210526316
"[45] CMB-S4 Collaboration, K. Abazajian et al.,                   (2000) 12, arXiv:astro-ph/9907103.",0.0,0.73,0.27,10.0,10.0,0.0,0.4736842105263158
"     “CMB-S4: Forecasting Constraints on Primordial          [61] M. G. Santos, A. Cooray, Z. Haiman, L. Knox, and",5.0,0.7456140350877193,0.2543859649122807,16.0,6.0,0.02631578947368421,0.4
"     Gravitational Waves,” arXiv:2008.12619                       C.-P. Ma, “Small - scale CMB temperature and",5.0,0.6636363636363637,0.3363636363636363,11.0,12.0,0.02631578947368421,0.42105263157894735
"     [astro-ph.CO].                                               polarization anisotropies due to patchy reionization,”",5.0,0.525,0.475,7.0,24.0,0.02631578947368421,0.368421052631579
"[46] M. Millea, E. Anderes, and B. D. Wandelt, “Bayesian          Astrophys. J. 598 (2003) 756–766,",0.0,0.7676767676767676,0.23232323232323238,15.0,6.0,0.0,0.4789473684210527
"     delensing of CMB temperature and polarization,”              arXiv:astro-ph/0305471.",5.0,0.7303370786516854,0.2696629213483146,7.0,8.0,0.02631578947368421,0.531578947368421
"     Phys. Rev. D 100 no. 2, (2019) 023509,                  [62] O. Zahn, M. Zaldarriaga, L. Hernquist, and",5.0,0.6574074074074074,0.34259259259259256,16.0,10.0,0.02631578947368421,0.43157894736842106
"     arXiv:1708.06753 [astro-ph.CO].                              M. McQuinn, “The Influence of non-uniform",5.0,0.616822429906542,0.383177570093458,8.0,16.0,0.02631578947368421,0.4368421052631579
"                                                                  reionization on the CMB,” Astrophys. J. 630 (2005)",66.0,0.3706896551724138,0.6293103448275862,8.0,1.0,0.3473684210526316,0.3894736842105263
avr_spaces,6.393939393939394,1.0,0.0,1.0,1.0,0.03365231259968102,0.9473684210526316
                                                                                                                       17,119.0,0.01652892561983471,0.9834710743801653,1.0,1.0,0.6263157894736842,0.3631578947368421
"     657–666, arXiv:astro-ph/0503166.                        [77] J. Caldeira, W. Wu, B. Nord, C. Avestruz, S. Trivedi,",5.0,0.6638655462184874,0.33613445378151263,13.0,13.0,0.02631578947368421,0.37368421052631584
"[63] M. McQuinn, S. R. Furlanetto, L. Hernquist, O. Zahn,         and K. Story, “DeepCMB: Lensing Reconstruction of",0.0,0.7913043478260869,0.20869565217391306,17.0,5.0,0.0,0.39473684210526316
"     and M. Zaldarriaga, “The Kinetic Sunyaev-Zel’dovich          the Cosmic Microwave Background with Deep Neural",5.0,0.7719298245614035,0.22807017543859653,13.0,6.0,0.02631578947368421,0.4
"     effect from reionization,” Astrophys. J. 630 (2005)          Networks,” Astron. Comput. 28 (2019) 100307,",5.0,0.7636363636363637,0.23636363636363633,13.0,6.0,0.02631578947368421,0.42105263157894735
"     643–656, arXiv:astro-ph/0504189.                             arXiv:1810.01483 [astro-ph.CO].",5.0,0.6288659793814433,0.3711340206185567,4.0,15.0,0.02631578947368421,0.4894736842105263
"[64] O. Dore, G. Holder, M. Alvarez, I. T. Iliev,            [78] M. A. Petroff, G. E. Addison, C. L. Bennett, and J. L.",0.0,0.725,0.275,23.0,7.0,0.0,0.368421052631579
"     G. Mellema, U.-L. Pen, and P. R. Shapiro, “The               Weiland, “Full-sky Cosmic Microwave Background",5.0,0.7142857142857143,0.2857142857142857,14.0,8.0,0.02631578947368421,0.41052631578947374
"     Signature of Patchy Reionization in the Polarization         Foreground Cleaning Using Machine Learning,”",5.0,0.7818181818181819,0.21818181818181814,12.0,5.0,0.02631578947368421,0.42105263157894735
"     Anisotropy of the CMB,” Phys. Rev. D 76 (2007)               arXiv:2004.11507 [astro-ph.CO].",5.0,0.7010309278350515,0.2989690721649485,11.0,8.0,0.02631578947368421,0.4894736842105263
"     043002, arXiv:astro-ph/0701784.                         [79] M. Münchmeyer and K. M. Smith, “Fast Wiener",5.0,0.6454545454545455,0.3545454545454545,11.0,13.0,0.02631578947368421,0.42105263157894735
"[65] C. Dvorkin and K. M. Smith, “Reconstructing Patchy           filtering of CMB maps with Neural Networks,”",0.0,0.7727272727272727,0.2272727272727273,16.0,6.0,0.0,0.42105263157894735
     Reionization from the Cosmic Microwave                       arXiv:1905.05846 [astro-ph.CO].,5.0,0.6597938144329897,0.3402061855670103,7.0,12.0,0.02631578947368421,0.4894736842105263
"     Background,” Phys. Rev. D 79 (2009) 043003,             [80] N. Gupta and C. Reichardt, “Mass Estimation of",5.0,0.7142857142857143,0.2857142857142857,16.0,7.0,0.02631578947368421,0.41052631578947374
     arXiv:0812.1566 [astro-ph].                                  Galaxy Clusters with Deep Learning II: CMB Cluster,5.0,0.5948275862068966,0.4051724137931034,10.0,18.0,0.02631578947368421,0.3894736842105263
"[66] C. Dvorkin, W. Hu, and K. M. Smith, “B-mode CMB              Lensing,” arXiv:2005.13985 [astro-ph.CO].",0.0,0.7570093457943925,0.2429906542056075,14.0,8.0,0.0,0.4368421052631579
"     Polarization from Patchy Screening during               [81] N. Gupta and C. L. Reichardt, “Mass Estimation of",5.0,0.7130434782608696,0.28695652173913044,15.0,8.0,0.02631578947368421,0.39473684210526316
"     Reionization,” Phys. Rev. D 79 (2009) 107302,                Galaxy Clusters with Deep Learning I:",5.0,0.6893203883495146,0.3106796116504854,13.0,9.0,0.02631578947368421,0.45789473684210524
"     arXiv:0902.4413 [astro-ph.CO].                               Sunyaev-Zel’dovich Effect,” Astrophys. J. 900 no. 2,",5.0,0.635593220338983,0.364406779661017,9.0,16.0,0.02631578947368421,0.3789473684210526
"[67] N. Battaglia, A. Natarajan, H. Trac, R. Cen, and             (2020) 110, arXiv:2003.06135 [astro-ph.CO].",0.0,0.7706422018348624,0.22935779816513757,14.0,7.0,0.0,0.4263157894736842
"     A. Loeb, “Reionization on Large Scales III: Predictions [82] R. Ciuca, O. F. Hernández, and M. Wolman, “A",5.0,0.8018018018018018,0.19819819819819817,18.0,1.0,0.02631578947368421,0.4157894736842105
     for Low-` Cosmic Microwave Background Polarization           Convolutional Neural Network For Cosmic String,5.0,0.7678571428571429,0.2321428571428571,12.0,6.0,0.02631578947368421,0.41052631578947374
"     and High-` Kinetic Sunyaev-Zel’dovich Observables,”          Detection in CMB Temperature Maps,” Mon. Not.",5.0,0.7747747747747747,0.22522522522522526,12.0,6.0,0.02631578947368421,0.4157894736842105
"     Astrophys. J. 776 (2013) 83, arXiv:1211.2832                 Roy. Astron. Soc. 485 (2019) 1377, arXiv:1708.08878",5.0,0.717948717948718,0.28205128205128205,13.0,9.0,0.02631578947368421,0.38421052631578945
     [astro-ph.CO].                                               [astro-ph.CO].,5.0,0.35,0.65,2.0,24.0,0.02631578947368421,0.5789473684210527
"[68] H. Park, P. R. Shapiro, E. Komatsu, I. T. Iliev,        [83] V. Dumoulin and F. Visin, “A guide to convolution",0.0,0.7652173913043478,0.23478260869565215,21.0,5.0,0.0,0.39473684210526316
"     K. Ahn, and G. Mellema, “The Kinetic                         arithmetic for deep learning,” arXiv:1603.07285",5.0,0.6460176991150443,0.35398230088495575,12.0,13.0,0.02631578947368421,0.4052631578947369
     Sunyaev-Zel’dovich effect as a probe of the physics of       [stat.ML].,5.0,0.7368421052631579,0.26315789473684215,10.0,4.0,0.02631578947368421,0.6
"     cosmic reionization: the effect of self-regulated       [84] O. Ronneberger, P. Fischer, and T. Brox, “U-net:",5.0,0.7807017543859649,0.2192982456140351,15.0,4.0,0.02631578947368421,0.4
"     reionization,” Astrophys. J. 769 (2013) 93,                  Convolutional networks for biomedical image",5.0,0.7064220183486238,0.29357798165137616,11.0,10.0,0.02631578947368421,0.4263157894736842
"     arXiv:1301.3607 [astro-ph.CO].                               segmentation,” arXiv:1505.04597 [cs.CV].",5.0,0.6320754716981132,0.3679245283018868,5.0,16.0,0.02631578947368421,0.4421052631578948
"[69] M. A. Alvarez, “The Kinetic Sunyaev–Zel’dovich          [85] K. He and J. Sun, “Convolutional neural networks at",0.0,0.7863247863247863,0.2136752136752137,17.0,6.0,0.0,0.38421052631578945
"     Effect From Reionization: Simulated Full-sky Maps at         constrained time cost,” arXiv:1412.1710 [cs.CV].",5.0,0.7894736842105263,0.21052631578947367,12.0,5.0,0.02631578947368421,0.4
"     Arcminute Resolution,” Astrophys. J. 824 no. 2,         [86] K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual",5.0,0.7350427350427351,0.2649572649572649,19.0,5.0,0.02631578947368421,0.38421052631578945
"     (2016) 118, arXiv:1511.02846 [astro-ph.CO].                  learning for image recognition,” arXiv:1512.03385",5.0,0.7391304347826086,0.26086956521739135,9.0,10.0,0.02631578947368421,0.39473684210526316
"[70] S. Paul, S. Mukherjee, and T. R. Choudhury,                  [cs.CV].",0.0,0.6486486486486487,0.3513513513513513,10.0,10.0,0.0,0.6105263157894737
"     “Inevitable imprints of patchy reionization on the      [87] R. K. Srivastava, K. Greff, and J. Schmidhuber,",5.0,0.7787610619469026,0.22123893805309736,16.0,4.0,0.02631578947368421,0.4052631578947369
"     cosmic microwave background anisotropy,” Mon. Not.           “Highway networks,” arXiv:1505.00387 [cs.LG].",5.0,0.7837837837837838,0.21621621621621623,10.0,6.0,0.02631578947368421,0.4157894736842105
"     Roy. Astron. Soc. 500 no. 1, (2020) 232–246,            [88] K. He, X. Zhang, S. Ren, and J. Sun, “Identity",5.0,0.6964285714285714,0.3035714285714286,19.0,7.0,0.02631578947368421,0.41052631578947374
"     arXiv:2005.05327 [astro-ph.CO].                              mappings in deep residual networks,”",5.0,0.6078431372549019,0.3921568627450981,7.0,16.0,0.02631578947368421,0.4631578947368421
"[71] T. R. Choudhury, S. Mukherjee, and S. Paul, “CMB             arXiv:1603.05027 [cs.CV].",0.0,0.7472527472527473,0.25274725274725274,12.0,7.0,0.0,0.5210526315789474
"     constraints on a physical model of reionization,”       [89] D. Balduzzi, M. Frean, L. Leary, J. Lewis, K. W.-D.",5.0,0.7606837606837606,0.23931623931623935,18.0,4.0,0.02631578947368421,0.38421052631578945
"     arXiv:2007.03705 [astro-ph.CO].                              Ma, and B. McWilliams, “The shattered gradients",5.0,0.6283185840707964,0.37168141592920356,9.0,16.0,0.02631578947368421,0.4052631578947369
"[72] S. Mukherjee, S. Paul, and T. R. Choudhury, “Is              problem: If resnets are the answer, then what is the",0.0,0.7288135593220338,0.27118644067796616,20.0,8.0,0.0,0.3789473684210526
"     patchy reionization an obstacle in detecting the             question?,” arXiv:1702.08591 [cs.NE].",5.0,0.7475728155339806,0.2524271844660194,10.0,7.0,0.02631578947368421,0.45789473684210524
"     primordial gravitational wave signal?,” Mon. Not. Roy.  [90] B. Kayalibay, G. Jensen, and P. van der Smagt,",5.0,0.8035714285714286,0.1964285714285714,17.0,2.0,0.02631578947368421,0.41052631578947374
"     Astron. Soc. 486 no. 2, (2019) 2042–2049,                    “Cnn-based segmentation of medical imaging data,”",5.0,0.6869565217391305,0.31304347826086953,13.0,11.0,0.02631578947368421,0.39473684210526316
"     arXiv:1903.01994 [astro-ph.CO].                              CoRR abs/1701.03056 (2017) , arXiv:1701.03056.",5.0,0.6428571428571429,0.3571428571428571,7.0,16.0,0.02631578947368421,0.41052631578947374
"[73] M. Su, A. P. Yadav, M. McQuinn, J. Yoo, and                  http://arxiv.org/abs/1701.03056.",0.0,0.7142857142857143,0.2857142857142857,12.0,10.0,0.0,0.4842105263157894
"     M. Zaldarriaga, “An Improved Forecast of Patchy         [91] F. Milletari, N. Navab, and S. Ahmadi, “V-net: Fully",5.0,0.7542372881355932,0.2457627118644068,17.0,5.0,0.02631578947368421,0.3789473684210526
"     Reionization Reconstruction with CMB,”                       convolutional neural networks for volumetric medical",5.0,0.6949152542372882,0.30508474576271183,10.0,12.0,0.02631578947368421,0.3789473684210526
"     arXiv:1106.4313 [astro-ph.CO].                               image segmentation,” CoRR abs/1606.04797 (2016)",5.0,0.6371681415929203,0.36283185840707965,7.0,16.0,0.02631578947368421,0.4052631578947369
"[74] V. Gluscevic, M. Kamionkowski, and D. Hanson,                , arXiv:1606.04797.",0.0,0.7176470588235294,0.2823529411764706,10.0,9.0,0.0,0.5526315789473684
     “Patchy Screening of the Cosmic Microwave                    http://arxiv.org/abs/1606.04797.,5.0,0.6938775510204082,0.30612244897959184,7.0,11.0,0.02631578947368421,0.4842105263157894
"     Background by Inhomogeneous Reionization,” Phys.        [92] Z. Zhang, Q. Liu, and Y. Wang, “Road extraction by",5.0,0.7672413793103449,0.23275862068965514,16.0,5.0,0.02631578947368421,0.3894736842105263
"     Rev. D 87 no. 4, (2013) 047303, arXiv:1210.5507              deep residual u-net,” IEEE Geoscience and Remote",5.0,0.7192982456140351,0.2807017543859649,15.0,8.0,0.02631578947368421,0.4
"     [astro-ph.CO].                                               Sensing Letters 15 no. 5, (May, 2018) 749–753.",5.0,0.4732142857142857,0.5267857142857143,9.0,24.0,0.02631578947368421,0.41052631578947374
"[75] T. Namikawa, “Constraints on Patchy Reionization             http://dx.doi.org/10.1109/LGRS.2018.2802944.",0.0,0.8272727272727273,0.17272727272727273,8.0,7.0,0.0,0.42105263157894735
"     from Planck CMB Temperature Trispectrum,” Phys.         [93] G. Klambauer, T. Unterthiner, A. Mayr, and",5.0,0.7592592592592593,0.2407407407407407,14.0,5.0,0.02631578947368421,0.43157894736842106
"     Rev. D 97 no. 6, (2018) 063505, arXiv:1711.00058             S. Hochreiter, “Self-normalizing neural networks,”",5.0,0.75,0.25,13.0,7.0,0.02631578947368421,0.3894736842105263
     [astro-ph.CO].                                               arXiv:1706.02515 [cs.LG].,5.0,0.4175824175824176,0.5824175824175823,3.0,24.0,0.02631578947368421,0.5210526315789474
"[76] A. Roy, A. Lapi, D. Spergel, and C. Baccigalupi,        [94] A. Odena, V. Dumoulin, and C. Olah, “Deconvolution",0.0,0.7844827586206896,0.2155172413793104,19.0,5.0,0.0,0.3894736842105263
"     “Observing patchy reionization with future CMB               and checkerboard artifacts,” Distill (2016) .",5.0,0.7297297297297297,0.2702702702702703,12.0,8.0,0.02631578947368421,0.4157894736842105
"     polarization experiments,” JCAP 05 (2018) 014,               http://distill.pub/2016/deconv-checkerboard.",5.0,0.7727272727272727,0.2272727272727273,7.0,8.0,0.02631578947368421,0.42105263157894735
     arXiv:1801.02393 [astro-ph.CO].,5.0,0.8333333333333334,0.16666666666666663,2.0,1.0,0.02631578947368421,0.8105263157894737
avr_spaces,5.590909090909091,1.0,0.0,1.0,1.0,0.02942583732057416,0.9473684210526316
                                                                                                                    18,116.0,0.01694915254237288,0.9830508474576272,1.0,1.0,0.6105263157894737,0.3789473684210526
"[95] A. Lewis, A. Challinor, and A. Lasenby, “Efficient     [99] R. Ciuca and O. F. Hernández, “Information Theoretic",0.0,0.8220338983050848,0.17796610169491522,18.0,3.0,0.0,0.3789473684210526
     computation of CMB anisotropies in closed FRW               Bounds on Cosmic String Detection in CMB Maps,5.0,0.7,0.30000000000000004,15.0,8.0,0.02631578947368421,0.42105263157894735
"     models,” Astrophys. J. 538 (2000) 473–476,                  with Noise,” Mon. Not. Roy. Astron. Soc. 492 no. 1,",5.0,0.6810344827586207,0.31896551724137934,16.0,10.0,0.02631578947368421,0.3894736842105263
"     arXiv:astro-ph/9911177.                                     (2020) 1329–1334, arXiv:1911.06378 [astro-ph.CO].",5.0,0.6052631578947368,0.39473684210526316,5.0,19.0,0.02631578947368421,0.4
"[96] J. Chardin, G. Uhlrich, D. Aubert, N. Deparis,        [100] C. Feng and G. Holder, “Detecting Electron Density",0.0,0.7913043478260869,0.20869565217391306,18.0,5.0,0.0,0.39473684210526316
"     N. Gillet, P. Ocvirk, and J. Lewis, “A deep learning        Fluctuations from Cosmic Microwave Background",5.0,0.7636363636363637,0.23636363636363633,15.0,5.0,0.02631578947368421,0.42105263157894735
"     model to emulate simulations of cosmic reionization,”       Polarization using a Bispectrum Approach,” Phys.",5.0,0.7964601769911505,0.20353982300884954,13.0,4.0,0.02631578947368421,0.4052631578947369
"     Mon. Not. Roy. Astron. Soc. 490 no. 1, (2019)               Rev. D 97 no. 12, (2018) 123523, arXiv:1801.05396",5.0,0.6929824561403509,0.3070175438596491,17.0,8.0,0.02631578947368421,0.4
"     1055–1065, arXiv:1905.06958 [astro-ph.CO].                  [astro-ph.CO].",5.0,0.6835443037974683,0.31645569620253167,4.0,10.0,0.02631578947368421,0.5842105263157895
"[97] D. P. Kingma and J. Ba, “Adam: A method for           [101] C. Feng and G. Holder, “Searching for patchy",0.0,0.7339449541284404,0.2660550458715596,20.0,6.0,0.0,0.4263157894736842
"     stochastic optimization,” arXiv:1412.6980 [cs.LG].          reionization from cosmic microwave background with",5.0,0.8,0.19999999999999996,10.0,6.0,0.02631578947368421,0.39473684210526316
"[98] P. D. Meerburg, J. Meyers, K. M. Smith, and A. van          hybrid quadratic estimators,” Phys. Rev. D 99 no. 12,",0.0,0.7542372881355932,0.2457627118644068,21.0,6.0,0.0,0.3789473684210526
"     Engelen, “Reconstructing CMB fluctuations and the           (2019) 123502, arXiv:1808.01592 [astro-ph.CO].",5.0,0.7837837837837838,0.21621621621621623,10.0,6.0,0.02631578947368421,0.4157894736842105
"     mean reionization optical depth,” Phys. Rev. D 95     [102] S. C. Hotinli and M. C. Johnson, “Reconstructing",5.0,0.7787610619469026,0.22123893805309736,17.0,3.0,0.02631578947368421,0.4052631578947369
"     no. 12, (2017) 123538, arXiv:1701.06992                     large scales at cosmic dawn,” arXiv:2012.09851",5.0,0.6846846846846847,0.3153153153153153,11.0,11.0,0.02631578947368421,0.4157894736842105
     [astro-ph.CO].                                              [astro-ph.CO].,5.0,0.35443037974683544,0.6455696202531646,2.0,24.0,0.02631578947368421,0.5842105263157895
avr_spaces,9.77777777777778,1.0,0.0,1.0,1.0,0.051461988304093584,0.9473684210526316
